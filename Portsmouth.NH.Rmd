---
title: "Municipal Indicators For Portsmouth, NH"
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
  html_notebook:
    toc: yes
    toc_depth: 3
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '3'
---

In this report, 40 demographic, educational institutions, employment, healthcare, municipal finance, infrastructure, food insecurity and housing variables are presented using federally-published data sources for the city of Portsmouth, New Hampshire. To better demonstrate their ties to geography of the city, the variables have been mapped on the block group level. \


## Demographic
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
                                 #######################################################
                                 #       Municipal Indicators For Municipalities        #               
                                 #######################################################
library(stringr)
library(tidycensus)
library(tidyverse)
library(tigris)
library(totalcensus)

options(tigris_class = "sf",tigris_use_cache = T)
# Get API key 
# census_api_key("045944708d514a404443c9f2d227ac8bf6a8f8bd", install = TRUE, overwrite=TRUE)
# Specify the end year 
# This is for 5-year estimates
endyr <- 2018
# List of ACS variables
Var_List <- tidycensus::load_variables(year = endyr, dataset = "acs5", cache = T)
#View(Var_List)
```


\


### Population  Size
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

                                             #--------------------#
                                             #    DEMOGRAPHIC     #
                                             #--------------------#

##############################################    Population  Size    ###########################################################
library(tidyverse)
# search_cbsa()
# search_fips()
# set_path_to_census("C:\\Users\\ux305\\Desktop\\census")
j <- "NH"
area <- "Portsmouth city, NH"
c <- "Rockingham"
ch.pop <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B01003_001",
                     areas = area,
                     summary_level = "place") %>%
				 rename(TotalPop = population,
				        City = NAME) %>% select(City, TotalPop)
Chelsea.MA <- cbind(ch.pop)

ch.MA.Pop <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B01003_001",
                     areas = area,
                     summary_level = "block group")

ch.Pop.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county=c,
													 year = endyr,
													 output = "wide",
													 variables = "B01003_001", # Total Population
													 keep_geo_vars = T, geometry = TRUE)

Chelsea <- merge(ch.Pop.get, ch.MA.Pop, by.x = 'NAME.y', by.y='NAME')
```


The total population of `r Chelsea.MA$City` is `r Chelsea.MA$TotalPop`. Followed is the population size map of the city.\
\

```{r , echo=FALSE, warning=FALSE, message=FALSE, comment=""}

## MAP
library(tmap)
tm_shape(Chelsea) + tm_polygons('B01003_001E' , palette="seq", style = "jenks", title = "Total Population")  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")
```
\


### Population Age
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##############################################    Population  Age   #############################################################
MA.Age.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
				 mutate(AgeU18 = B01001_003+B01001_004+B01001_005+B01001_006+B01001_027+B01001_028+B01001_029+B01001_030, 
				 Age1834 = B01001_007+B01001_008+B01001_009+B01001_010+B01001_011+B01001_012+B01001_036+B01001_035+B01001_034+B01001_033+B01001_032+B01001_031,
				 Age3564 = B01001_013+B01001_014+B01001_015+B01001_016+B01001_017+B01001_018+B01001_019+B01001_043+B01001_042+B01001_041+B01001_040+B01001_039+B01001_038+B01001_037,
				 AgeO65 = B01001_020+B01001_021+B01001_022+B01001_023+B01001_024+B01001_025+B01001_044+B01001_045+B01001_046+B01001_047+B01001_048+B01001_049) %>%
  	mutate(AgeU18Per = AgeU18/population,
				 Age1834Per = Age1834/population,
				 Age3564Per = Age3564/population,
				 AgeO65Per = AgeO65/population) %>%
select(AgeU18,Age1834,Age3564,AgeO65,AgeU18Per,Age1834Per,Age3564Per,AgeO65Per, City) %>%
  left_join(Chelsea.MA, MA.Age.ch, by="City")

Chelsea.MA <- cbind(MA.Age.ch)
```
* The number of people, who are younger than 18 Years old is `r Chelsea.MA$AgeU18` in `r Chelsea.MA$City` 
, which is `r (round(Chelsea.MA$AgeU18Per,4))*100`% of total population in `r Chelsea.MA$City`. \
* The number of people, who are between 18 and 34 years old is `r Chelsea.MA$Age1834` in `r Chelsea.MA$City`, which is `r (round(Chelsea.MA$Age1834Per,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people, who are between 35 and 64 years old is `r Chelsea.MA$Age3564` in `r Chelsea.MA$City`, which is `r (round(Chelsea.MA$Age3564Per,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people, who are older than 65 years old is `r Chelsea.MA$AgeO65` in `r Chelsea.MA$City`, which is `r (round(Chelsea.MA$AgeO65Per,4))*100`% of total population in `r Chelsea.MA$City`.\

Followed is the population age map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## Map

ch.MA.Age <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"),
                     areas = area,
                     summary_level = "block group")

ch.age.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"), # Total Population
													 keep_geo_vars = T, geometry = TRUE) %>%
mutate(AgeU18 = B01001_003E+B01001_004E+B01001_005E+B01001_006E+B01001_027E+B01001_028E+B01001_029E+B01001_030E, 
				 Age1834 = B01001_007E+B01001_008E+B01001_009E+B01001_010E+B01001_011E+B01001_012E+B01001_036E+B01001_035E+B01001_034E+B01001_033E+B01001_032E+B01001_031E,
				 Age3564 = B01001_013E+B01001_014E+B01001_015E+B01001_016E+B01001_017E+B01001_018E+B01001_019E+B01001_043E+B01001_042E+B01001_041E+B01001_040E+B01001_039E+B01001_038E+B01001_037E,
				 AgeO65 = B01001_020E+B01001_021E+B01001_022E+B01001_023E+B01001_024E+B01001_025E+B01001_044E+B01001_045E+B01001_046E+B01001_047E+B01001_048E+B01001_049E)  %>%
  rename(AgeU18_BG = AgeU18,
				 Age1834_BG = Age1834,
				 Age3564_BG = Age3564,
				 AgeO65_BG = AgeO65) %>%
	mutate(AgeU18Per_BG = ((AgeU18_BG/B01003_001E)*100),
				 Age1834Per_BG = ((Age1834_BG/B01003_001E)*100),
				 Age3564Per_BG = ((Age3564_BG/B01003_001E)*100),
				 AgeO65Per_BG = ((AgeO65_BG/B01003_001E)*100))  

Chelsea.age <- merge(ch.age.get, ch.MA.Age, by.x = 'NAME.y', by.y='NAME')

make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}
 

tm_shape(Chelsea.age) + tm_polygons(c('AgeU18Per_BG','Age1834Per_BG',"Age3564Per_BG","AgeO65Per_BG") , palette=list("Oranges", "Greens", "Blues", "Purples") ,style = "quantile", title = c('AgeU18','Age1834',"Age3564","AgeO65"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))  + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) +tm_layout(legend.position = c("right","bottom"))

```
\

### Median Household Income
\

```{r  echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#################################################    Median Household Income    ##############################################################

MA.MHI.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B19013_001",
                     areas = area,
                     summary_level = "place") %>%
				 rename(MedHouseIncome = B19013_001,
				        City = NAME) %>% 
	select(City, MedHouseIncome) %>%
  left_join(Chelsea.MA, MA.MHI.ch, by="City")
Chelsea.MA <- cbind(MA.MHI.ch)
```
* The median household income in the past 12 months is 78027 Dollar in `r Chelsea.MA$City`.\

Followed is the Median Household Income map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## MAP
ch.MA.income <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B19013_001",
                     areas = area,
                     summary_level = "block group")

ch.income.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = "B19013_001", 
													 keep_geo_vars = T, geometry = TRUE) 

chelsea.income <- merge(ch.income.get, ch.MA.income, by.x = 'NAME.y', by.y='NAME')

make_dollar <- function(x, digits = 0) {
  paste0("$", formatC(x, digits = digits, format = "f", big.mark = ","))
}

library(tmap)
tm_shape(chelsea.income) + tm_polygons('B19013_001E' , palette="Blues", style="jenks", title = "Median Household Income", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar))  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) 
```

\

### Racial Breakdown 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##############################################      Racial Breakdown     ###################################################################
MA.Race.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009"),
                     areas = area,
                     summary_level = "place") %>%
				 rename(White = B03002_003,
				 Black = B03002_004,
				 Asian = B03002_006,
				 Hispanic = B03002_012,
				 TwoOrMore = B03002_009,
				 City = NAME) %>% 
  mutate(WhitePer = (White/population),
         BlackPer = (Black/population),
         AsianPer = (Asian/population),
         HispanicPer = (Hispanic/population),
         TwoOrMorePer = (TwoOrMore/population)) %>%
	select(City, White, Black, Asian, Hispanic, TwoOrMore,
	       WhitePer, BlackPer, AsianPer, HispanicPer, TwoOrMorePer) %>%
  left_join(Chelsea.MA, MA.Race.ch, by="City")
Chelsea.MA <- cbind(MA.Race.ch)

```
* The number of people who are white in `r Chelsea.MA$City` is `r Chelsea.MA$White` which is `r (round(Chelsea.MA$WhitePer,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people who are black in `r Chelsea.MA$City` is `r Chelsea.MA$Black` which is `r (round(Chelsea.MA$BlackPer,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people who are asian in `r Chelsea.MA$City` is `r Chelsea.MA$Asian` which is `r (round(Chelsea.MA$AsianPer,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people who are hispanic in `r Chelsea.MA$City` is `r Chelsea.MA$Hispanic` which is `r (round(Chelsea.MA$HispanicPer,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people who are have two or more races in `r Chelsea.MA$City` is `r Chelsea.MA$TwoOrMore` which is `r (round(Chelsea.MA$TwoOrMorePer,4))*100`% of total population in `r Chelsea.MA$City`. \

Followed is the Racial Breakdown map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## Map
ch.MA.race <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009",
																					"B01003_001"),
                     areas = area,
                     summary_level = "block group")

ch.race.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009",
																					"B01003_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(White_BG = B03002_003E,
				 Black_BG = B03002_004E,
				 Asian_BG = B03002_006E,
				 Hispanic_BG = B03002_012E,
				 TwoOrMore_BG = B03002_009E) %>%
  mutate(WhitePer_BG = (White_BG/B01003_001E)*100,
         BlackPer_BG = (Black_BG/B01003_001E)*100,
         AsianPer_BG = (Asian_BG/B01003_001E)*100,
         HispanicPer_BG = (Hispanic_BG/B01003_001E)*100,
         TwoOrMorePer_BG = (TwoOrMore_BG/B01003_001E)*100) 

chelsea.race <- merge(ch.race.get, ch.MA.race, by.x = 'NAME.y', by.y='NAME')


make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}
 
library(tmap)
tm_shape(chelsea.race) + tm_polygons(c("WhitePer_BG", "BlackPer_BG", "AsianPer_BG", "HispanicPer_BG", "TwoOrMorePer_BG") , palette=list("Oranges", "Greens", "Blues", "Purples", "Reds"), style = "quantile", title = c("White", "Black", "Asian","Hispanic", "TwoOrMore"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))  + tm_view(alpha = 0.85,view,basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("right","bottom"))
```

\


### Gender Breakdown
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#####################################################    Gender Breakdown    #############################################################

MA.Sex.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B01001_026",
													               "B01001_002"),
                     areas = area,
                     summary_level = "place") %>%
  mutate(SexRatio = B01001_026/B01001_002) %>%
  rename(Female = B01001_026,
				 Male = B01001_002,
				 City = NAME) %>%
  mutate(FemalePer = Female/population,
				 MalePer = Male/population) %>% 
	select(City, SexRatio, Female, Male, FemalePer, MalePer) %>%
  left_join(Chelsea.MA, MA.Sex.ch, by="City")

Chelsea.MA <- cbind(MA.Sex.ch)

```
* The number of females in `r Chelsea.MA$City` is `r Chelsea.MA$Female` which is `r 100*(round(Chelsea.MA$FemalePer,2))`% of total population in `r Chelsea.MA$City`.\
* The number of males in `r Chelsea.MA$City` is `r Chelsea.MA$Male` which is `r 100*(round(Chelsea.MA$MalePer,2))`% of total population in `r Chelsea.MA$City`.\
* The ratio of number of females to males in `r Chelsea.MA$City` is `r round(Chelsea.MA$SexRatio,2)`.\

Followed is the Gender Breakdown map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.sex <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B01001_026",
													               "B01001_002",
													               "B01003_001"),
                     areas = area,
                     summary_level = "block group")

ch.sex.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B01001_026",
													               "B01001_002",
													               "B01003_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
mutate(SexRatio = B01001_026E/B01001_002E) %>%
  rename(Female = B01001_026E,
				 Male = B01001_002E) %>%
  mutate(FemalePer = (Female/B01003_001E)*100,
         MalePer = (Male/B01003_001E)*100)

chelsea.sex <- merge(ch.sex.get, ch.MA.sex, by.x = 'NAME.y', by.y='NAME')

library(tmap)
tm_shape(chelsea.sex) + tm_polygons(c('Female', 'Male'), palette=list("Purples", "Reds"), title = c("Female","Male"))  + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")+ tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("right","bottom"))

```

\



```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

tm_shape(chelsea.sex) + tm_polygons(c('FemalePer', 'MalePer'), palette=list("Blues", "Oranges"), title = c("Female Percentage","Male Percentage"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent)) + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")+ tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("right","bottom"))

```




\

### Average Household Size
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#################################################    Average Household Size    ############################################################

MA.AveHH.Size.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11002_001", 
															         "B19001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(AveHouseH = B11002_001/B19001_001) %>%
	select(City, AveHouseH) %>%
  left_join(Chelsea.MA, MA.AveHH.Size.ch, by="City")

Chelsea.MA <- cbind(MA.AveHH.Size.ch)
```
* The average household size is `r round(Chelsea.MA$AveHouseH, 2)` in `r Chelsea.MA$City`.\

Followed is the Average Household Size map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

ch.MA.HH.Size <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11002_001", # Household type by relatives and nonrelatives for population in households
															              "B19001_001"),
                     areas = area,
                     summary_level = "block group")

ch.HH.Size.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B11002_001", # Household type by relatives and nonrelatives for population in households
															              "B19001_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
  mutate(AveHouseH = B11002_001E/B19001_001E) 

chelsea.HH.Size <- merge(ch.HH.Size.get, ch.MA.HH.Size, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.HH.Size) + tm_polygons("AveHouseH", style = "quantile", palette="Purples", border.col = "darkgray", title="Ave Household Size") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite") + tmap_options(show.messages = FALSE)

```

\

### Educational Attainment
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################   Educational Attainment    ##################################################################
MA.Educ.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(LessThanHS = (B15002_003+B15002_004+B15002_005+B15002_006+B15002_007+B15002_008+B15002_009+B15002_010+B15002_020+B15002_021+B15002_022+B15002_023+B15002_024+B15002_025+B15002_026+B15002_027),
				 HSGrad = (B15002_011 + B15002_028),
				 SomeColl = (B15002_012+ B15002_013 + B15002_014 + B15002_029 + B15002_030 + B15002_031),
				 Bach = (B15002_015 + B15002_032),
				 Master = (B15002_016 + B15002_033),
				 Prof = (B15002_017 + B15002_034),
				 Doc = (B15002_018 + B15002_035),
				 LessThanHSPer = (LessThanHS/population),
         HSGradPer = (HSGrad/population),
         SomeCollPer = (SomeColl/population),
         BachPer = (Bach/population),
         MasterPer = (Master/population),
         ProfPer = (Prof/population),            
         DocPer = (Doc/population)) %>%
	select(City, LessThanHS, HSGrad, SomeColl, Bach, Master, Prof, Doc,
	       LessThanHSPer, HSGradPer, SomeCollPer, BachPer, MasterPer, ProfPer, DocPer) %>% 
  left_join(Chelsea.MA, MA.Educ.ch, by="City") 

Chelsea.MA <- cbind(MA.Educ.ch)
```
* The number of people, who have less than high school degree is `r  Chelsea.MA$LessThanHS` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$LessThanHSPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have high school degree is `r  Chelsea.MA$HSGrad` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$HSGradPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have some college degree is `r  Chelsea.MA$SomeColl` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$SomeCollPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have bachelor degree is `r Chelsea.MA$Bach` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$BachPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have master's degree is `r Chelsea.MA$Master` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$MasterPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have professional school degree is `r  Chelsea.MA$Prof` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$ProfPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have doctorate degree is `r  Chelsea.MA$Doc` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$DocPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\

Followed is the Educational Attainment map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.Educ <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"),
                     areas = area,
                     summary_level = "block group")

ch.Educ.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(LessThanHS_BG = (B15002_003E+B15002_004E+B15002_005E+B15002_006E+B15002_007E+B15002_008E+B15002_009E+B15002_010E+B15002_020E+B15002_021E+B15002_022E+B15002_023E+B15002_024E+B15002_025E+B15002_026E+B15002_027E),
				 HSGrad_BG = (B15002_011E + B15002_028E),
				 SomeColl_BG = (B15002_012E + B15002_013E + B15002_014E + B15002_029E + B15002_030E + B15002_031E),
				 Bach_BG = (B15002_015E + B15002_032E),
				 Master_BG = (B15002_016E + B15002_033E),
				 Prof_BG = (B15002_017E + B15002_034E),
				 Doc_BG = (B15002_018E + B15002_035E),
		    LessThanHSPer_BG = ((B15002_003E+B15002_004E+B15002_005E+B15002_006E+B15002_007E+B15002_008E+B15002_009E+B15002_010E+B15002_020E+B15002_021E+B15002_022E+B15002_023E+B15002_024E+B15002_025E+B15002_026E+B15002_027E)/B15002_001E)*100,
				 HSGradPer_BG = ((B15002_011E + B15002_028E)/B15002_001E)*100,
				 SomeCollPer_BG = ((B15002_012E + B15002_013E + B15002_014E + B15002_029E + B15002_030E + B15002_031E)/B15002_001E)*100,
				 BachPer_BG = ((B15002_015E + B15002_032E)/B15002_001E)*100,
				 MasterPer_BG = ((B15002_016E + B15002_033E)/B15002_001E)*100,
				 ProfPer_BG = ((B15002_017E + B15002_034E)/B15002_001E)*100,
				 DocPer_BG = ((B15002_018E + B15002_035E)/B15002_001E)*100)

chelsea.Educ <- merge(ch.Educ.get, ch.MA.Educ, by.x = 'NAME.y', by.y='NAME')

make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}

tm_shape(chelsea.Educ) +
    tm_fill(c('LessThanHSPer_BG', 'HSGradPer_BG', 'SomeCollPer_BG', 'BachPer_BG', 'MasterPer_BG', 'ProfPer_BG', 'DocPer_BG'),
        style="quantile", 
        palette=list("Oranges", "Greens", "Blues", "Purples", "Reds","Dark2", "seq"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent), title=c('LessThanHS', 'HSGrad', 'SomeColl', 'Bach', 'Master', 'Prof', 'Doc')) + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") +tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("right","bottom"))

```

\

### Single Parent Households
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

##########################################      Single Parent Households     ##################################################################
MA.Single.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(FemHeadPer = B11001_006/B11001_001,
	       MaleHeadPer = B11001_005/B11001_001) %>%
	select(City, FemHeadPer, MaleHeadPer) %>%
  left_join(Chelsea.MA, MA.Single.ch, by="City")

Chelsea.MA <- cbind(MA.Single.ch)

```
* The percentage of single-female-headed is `r (round(Chelsea.MA$FemHeadPer,4))*100`% of total number of family households in `r Chelsea.MA$City`.\
* The percentage of single-male-headed is `r (round(Chelsea.MA$MaleHeadPer,4))*100`% of total number of family households in `r Chelsea.MA$City`.\

Followed is the Single Parent Households map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.single <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"),
                     areas = area,
                     summary_level = "block group")

ch.single.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
mutate(FemHeadPer = (B11001_006E/B11001_001E)*100,
	       MaleHeadPer = (B11001_005E/B11001_001E)*100)

chelsea.single <- merge(ch.single.get, ch.MA.single, by.x = 'NAME.y', by.y='NAME')


make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}


tm_shape(chelsea.single) + tm_polygons(c("FemHeadPer", "MaleHeadPer"), style="quantile", palette=list("Oranges", "Purples"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent), border.col = "darkgray", title=c("Female Householder", "Male Householder")) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("right","bottom"))

```


\


### Population in Poverty
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
###########################################      Population in Poverty    ######################################################################

MA.PopPov.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  	mutate(FamPovPer = B17010_002/B17010_001,
	       PopPovPer = B17001_002/B17001_001,
	       TotalPopPov = B17001_002) %>%
	select(City, FamPovPer, PopPovPer, TotalPopPov) %>%
  left_join(Chelsea.MA,MA.PopPov.ch, by="City")

Chelsea.MA <- cbind(MA.PopPov.ch)
```
* The percentage of family, who are in poverty is `r (round(Chelsea.MA$FamPovPer,4))*100` % in `r Chelsea.MA$City`.\
* The percentage of population, who are in poverty is `r (round(Chelsea.MA$PopPovPer,4))*100` % in `r Chelsea.MA$City`.\
* The total number of people, who are in poverty is `r Chelsea.MA$TotalPopPov` in `r Chelsea.MA$City`.\

Followed is the Population in Poverty map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

ch.MA.pov <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"),
                     areas = area,
                     summary_level = "block group")

ch.pov.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(FamPovPer_BG = (B17010_002E/B17010_001E)*100,
	       PopPovPer_BG = (B17001_002E/B17001_001E)*100,
	       TotalPopPov_BG = B17001_002E) 

chelsea.pov <- merge(ch.pov.get, ch.MA.pov, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.pov) + tm_polygons("FamPovPer_BG", style="quantile", palette="Purples", border.col = "darkgray", title="Family in Poverty", popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")


```

\


### Elderly People Living Alone
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

########################################     Elderly People Living Alone    ##############################################################
MA.old.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11010_005", # Male householder, Living alone, 65 years and over
																					"B11010_012", # Female householder, Living alone, 65 years and over
																					"B11010_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(OldAlonePer = (B11010_012 + B11010_005)/B11010_001) %>%
	select(City, OldAlonePer) %>%
  left_join(Chelsea.MA,MA.old.ch, by="City")

Chelsea.MA <- cbind(MA.old.ch) 

## GIVE US NA
```
* The percentage of householders, who are living alone and are older than 65 years old is `r (round(Chelsea.MA$OldAlonePer,4))*100` % in `r Chelsea.MA$City`.\

\

## Educational Institutions
\


\

### Number/Type of Schools
\

* `r Chelsea.MA$City` has 2 public school district, which contains 2676 students and 6 public schools. Also, `r  Chelsea.MA$City` has 1 private schools with 102 students.(https://nces.ed.gov/) 

\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$SchoolsDistrict <- 2
Chelsea.MA$SchoolsDistStudents <- 2676
Chelsea.MA$PubSchools <- 6
Chelsea.MA$PvSchools <- 1
```


\


### Number/Type of Universities
\

* `r Chelsea.MA$City` has 2 university in 03801 ZIP Code.(https://nces.ed.gov/) 

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$NumUni <- 2
```


\

###	Employment Numbers per Institution
\


* The largest School District in `r Chelsea.MA$City` contains 228 teachers and 204 other staffs. The total number of teachers in all private schools in `r Chelsea.MA$City` is 36.(http://www.usa.com/)


\

### Number of PK-12 Enrollment in Schools
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
############################################################################################################################

                                             # ----------------------------- #
                                             #    Educational Institutions   #
                                             #-------------------------------#

# Number of PK-12 Enrollment at block group level
MA.Enrol.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B14001_003", # Enrolled in preschool
																					"B14001_004", # Enrolled in kindergarten
																					"B14001_005", # Enrolled in grade 1 to 4
																					"B14001_006", # Enrolled in grade 5 to 8
																					"B14001_007"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(EnrolPK12 = B14001_003 + B14001_004 + B14001_005 + B14001_006 + B14001_007) %>%
	select(City, EnrolPK12) %>%
  left_join(Chelsea.MA, MA.Enrol.ch, by="City")

Chelsea.MA <- cbind(MA.Enrol.ch)

```
* The total number of students, who enrolled in preschools to 12 grade levels in `r Chelsea.MA$City` schools is `r Chelsea.MA$EnrolPK12`.\

\


## Employment
\


### Number of Jobs within Community Boundaries
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

########################################################################################################################################

                                                #----------------------#
                                                #       EMPLOYMENT     #
                                                #----------------------#


##########################################    Number of Jobs within Community Boundaries   #############################################
MA.Num.Jobs.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B08008_003",
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME,
         NumJobs = B08008_003) %>% 
	select(City, NumJobs) %>%
  left_join(Chelsea.MA, MA.Num.Jobs.ch, by="City")

Chelsea.MA <- cbind(MA.Num.Jobs.ch)
```
* The number of jobs within community boundaries in `r Chelsea.MA$City` is `r Chelsea.MA$NumJobs`.\

Followed is the map of Number of Jobs within Community Boundaries of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}

## MAP

ch.MA.job <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B08008_003",
                     areas = area,
                     summary_level = "block group")

ch.job.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = 'B08008_003', 
													 keep_geo_vars = T, geometry = TRUE) %>%
	rename(NumJobs = B08008_003E) 

chelsea.job <- merge(ch.job.get, ch.MA.job, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.job) + tm_polygons("NumJobs", style="jenks", palette="Reds", border.col = "darkgray", title="Number of Jobs") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")
```

\


### Labor Force (Total number, participation)
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
############################################# Labor Force (Total number, participation)  ####################################

MA.Labors.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(LabForce = B23025_002,
	       LabForcePer = B23025_002/B23025_001,
	       CivLabForce = B23025_003,
	       CivLabForcePer = B23025_003/B23025_001,
	       Military = B23025_006,
	       MilitaryPer = 	B23025_006/B23025_001,
	       TotalWorkers = B23025_001) %>%
	select(City, LabForce, LabForcePer, CivLabForce, CivLabForcePer, Military, MilitaryPer, TotalWorkers)  %>%
  left_join(Chelsea.MA, MA.Labors.ch, by="City")

Chelsea.MA <- cbind(MA.Labors.ch)
```
* The number of labor force, who are 16 years and older in `r Chelsea.MA$City` is 13567 which is `r round(Chelsea.MA$LabForcePer,2)` of total number of labors (unemployed and not in labor force) of which 12961 are civilian labor forces and `r Chelsea.MA$Military` are armed labor forces.\

Followed is the map of Labor Force of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

ch.MA.labors <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"),
                     areas = area,
                     summary_level = "block group")

ch.labors.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(LabForce = B23025_002E,
	       LabForcePer = B23025_002E/B23025_001E,
	       CivLabForce = B23025_003E,
	       CivLabForcePer = B23025_003E/B23025_001E,
	       Military = B23025_006E,
	       MilitaryPer = 	B23025_006E/B23025_001E,
	       TotalWorkers = B23025_001E) 

chelsea.labors <- merge(ch.labors.get, ch.MA.labors, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.labors) + tm_polygons("LabForce", style="jenks", palette="seq", border.col = "darkgray", title="Number of Labors") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")
```

\

### Employed and Unemployed
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#####################################################    Employed and Unemployed   ####################################

MA.Emp.Unemp.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(EmpRate = B23025_004/B23025_003,
	       UnempRate = B23025_005/B23025_003,
	       EmployedCLF = B23025_004,
	       UnemployedCLF = B23025_005) %>%
	select(City ,EmpRate, UnempRate, EmployedCLF, UnemployedCLF) %>%
  left_join(Chelsea.MA, MA.Emp.Unemp.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.Unemp.ch)

```
* The rate of employment in `r Chelsea.MA$City` is `r round(Chelsea.MA$EmpRate,2)*100`%.\
* The rate of unemployment in `r Chelsea.MA$City` is `r round(Chelsea.MA$UnempRate,2)*100`%.\

Followed is Employed and Unemployed map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.emp <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"),
                     areas = area,
                     summary_level = "block group")

ch.emp.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(EmpRate_BG = (B23025_004E/B23025_003E)*100,
	       UnempRate_BG = (B23025_005E/B23025_003E)*100,
	       EmployedCLF_BG = B23025_004E,
	       UnemployedCLF_BG = B23025_005E) 

chelsea.emp <- merge(ch.emp.get, ch.MA.emp, by.x = 'NAME.y', by.y='NAME')

tm_shape(chelsea.emp) + tm_polygons(c("EmpRate_BG","UnempRate_BG"), style="jenks", palette=list("Greens","seq"), border.col = "darkgray", title=c("Employment rate","Unemployment rate"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))+ tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tm_layout(legend.position = c("right","bottom"))

```

\


### Major Employers by NCAIS Code
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

################################    Major Employers by NCAIS Code    ##########################################
MA.Emp.NCAIS.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(MaleNCAIS = C24030_002,
	       FemaleNCAIS = C24030_029,
	       MaleNCAISPer = C24030_002/C24030_001,
	       FemaleNCAISPer = C24030_029/C24030_001) %>%
	select(City , MaleNCAIS, FemaleNCAIS, MaleNCAISPer, FemaleNCAISPer) %>%
  left_join(Chelsea.MA, MA.Emp.NCAIS.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.NCAIS.ch)

```
* Number of male by industry for the civilian employed in `r Chelsea.MA$City` is `r Chelsea.MA$MaleNCAIS` which is `r round(Chelsea.MA$MaleNCAISPer,2)` of population, who are 16 years and over.\
* Number of female by industry for the civilian employed in `r Chelsea.MA$City` is `r Chelsea.MA$FemaleNCAIS` which is `r round(Chelsea.MA$FemaleNCAISPer,2)` of population, who are 16 years and over.\

Followed is the map of the Major Employers by NCAIS Code of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.majorEmp <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"),
                     areas = area,
                     summary_level = "block group")

ch.majorEmp.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(MaleNCAIS_BG = C24030_002E,
	       FemaleNCAIS_BG = C24030_029E,
	       MaleNCAISPer_BG = (C24030_002E/C24030_001E)*100,
	       FemaleNCAISPer_BG = (C24030_029E/C24030_001E)*100) 

chelsea.majorEmp <- merge(ch.majorEmp.get, ch.MA.majorEmp, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.majorEmp) + tm_polygons(c("MaleNCAIS_BG","FemaleNCAIS_BG"), style="jenks", palette=list("Greens","seq"), border.col = "darkgray", title=c("MaleNCAIS","FemaleNCAIS")) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tm_layout(legend.position = c("right","bottom"))

```

\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
tm_shape(chelsea.majorEmp) + tm_polygons(c("MaleNCAISPer_BG","FemaleNCAISPer_BG"), style="quantile", palette=list("Blues","Reds"), border.col = "darkgray", title=c("MaleNCAIS Pecentage","FemaleNCAIS Percentage"),popup.format = list(fun = make_percent), legend.format = list(fun = make_percent)) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tm_layout(legend.position = c("right","bottom"))
```




\

### Top Industries by NCAIS Code
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
######################################    Top Industries by NCAIS Code   ##################################################

MA.Industries.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("C24030_003", # Agriculture, forestry, fishing and hunting, and mining (Male)
														              "C24030_030", # Agriculture, forestry, fishing and hunting, and mining (Female)
														              "C24030_006", # Construction (Male)
														              "C24030_033", # Construction (Female)
														              "C24030_007", # Manufacturing (Male)
														              "C24030_034", # Manufacturing (Female)
														              "C24030_008", # Wholesale trade (Male)
														              "C24030_035", # Wholesale trade (Female)
														              "C24030_009", # Retail trade (Male)
														              "C24030_036", # Retail trade (Female)
														              "C24030_010", # Transportation and warehousing, and utilities (Male)
														              "C24030_037", # Transportation and warehousing, and utilities (Female)
														              "C24030_013", # Information (Male)
														              "C24030_040", # Information (Female)
														              "C24030_014", # Finance and insurance, and real estate, and rental and leasing (Male)
														              "C24030_041", # Finance and insurance, and real estate, and rental and leasing (Female)
														              "C24030_017", # Professional, scientific, and management, and administrative, and waste management services (Male)
														              "C24030_044", # Professional, scientific, and management, and administrative, and waste management services (Female)
														              "C24030_021", # Educational services, and health care and social assistance (Male)
														              "C24030_048", # Educational services, and health care and social assistance (Female)
														              "C24030_024", # Arts, entertainment, and recreation, and accommodation and food services (Male)
														              "C24030_051", # Arts, entertainment, and recreation, and accommodation and food services (Female)
														              "C24030_027", # Other services, except public administration (Male)
														              "C24030_054", # Other services, except public administration (Female)
														              "C24030_028", # Public administration (Male)
														              "C24030_055", # Public administration (Female)
														              "C24030_001"), # Total,
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(Agriculture = (C24030_003 + C24030_030)/C24030_001,
	       Construction = (C24030_006 + C24030_033)/C24030_001,
	       Manufacturing = (C24030_007 + C24030_034)/C24030_001,
	       WholesaleTrade = (C24030_008 + C24030_035)/C24030_001,
	       RetailTrade = (C24030_009 + C24030_036)/C24030_001,
	       Transportation = (C24030_010 + C24030_037)/C24030_001,
	       Information = (C24030_013 + C24030_040)/C24030_001,
	       Finance_Ins = (C24030_014 + C24030_041)/C24030_001,
	       Professional = (C24030_017 + C24030_044)/C24030_001,
	       Educ_Health_SocSvcs = (C24030_021 + C24030_048)/C24030_001,
	       RecreationEtc = (C24030_024 + C24030_051)/C24030_001,
	       OtherIndustries = (C24030_027 + C24030_054)/C24030_001,
	       PublicAdmin = (C24030_028 + C24030_055)/C24030_001) %>%
	select(City,Agriculture,Construction,Manufacturing,WholesaleTrade,RetailTrade,Transportation,Information,
	       Finance_Ins,Professional,Educ_Health_SocSvcs,RecreationEtc,OtherIndustries,PublicAdmin) %>%
  left_join(Chelsea.MA, MA.Industries.ch, by="City")

Chelsea.MA <- cbind(MA.Industries.ch)

```
* The percentage of people, who are in agriculture, forestry, fishing, hunting, and mining in `r Chelsea.MA$City` is `r (round(Chelsea.MA$Agriculture,4))*100`%.\

* The percentage of people, who are in construction in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Construction,4))*100`%.\

* The percentage of people, who are in manufacturing in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Manufacturing,4))*100`%.\

* The percentage of people, who are in wholesale trade in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$WholesaleTrade,4))*100`%.\

* The percentage of people, who are in retail trade in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$RetailTrade,4))*100`%.\

* The percentage of people, who are in transportation and warehousing, and utilities in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Transportation,4))*100`%.\

* The percentage of people, who are in information in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Information,4))*100`%.\

* The percentage of people, who are in finance and insurance, and real estate, and rental and leasing in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Finance_Ins,4))*100`%.\

* The percentage of people, who are in professional, scientific, and management, and administrative, and waste management services in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Professional,4))*100`%.\

* The percentage of people, who are in educational services, and health care and social assistance in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Educ_Health_SocSvcs,4))*100`%.\

* The percentage of people, who are in arts, entertainment, and recreation, and accommodation and food services in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$RecreationEtc,4))*100`%.\

* The percentage of people, who are in other services, except public administration in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$OtherIndustries,4))*100`%.\

* The percentage of people, who are in Public administration in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$PublicAdmin,4))*100`%.\
\

### Earning Breakdown 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
###########################    Earning Breakdown   ####################################
MA.Earning.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B20017_001",
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(MedEarning = B20017_001) %>%
	select(City,MedEarning) %>%
  left_join(Chelsea.MA, MA.Earning.ch, by="City")

Chelsea.MA <- cbind(MA.Earning.ch)
```
* The median earning in `r Chelsea.MA$City` is 44391 Dollar.\

Followed is the Median Earning map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.earning <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B20017_001",
                     areas = area,
                     summary_level = "block group")

ch.earning.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = 'B20017_001', 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(MedEarning = B20017_001E)

chelsea.earning <- merge(ch.earning.get, ch.MA.earning, by.x = 'NAME.y', by.y='NAME')

make_dollar <- function(x, digits = 0) {
  paste0("$", formatC(x, digits = digits, format = "f", big.mark = ","))
}


tm_shape(chelsea.earning) + tm_polygons("MedEarning" , palette="seq", style = "jenks", title = "Median Earning", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") 


```

\


### Employee Age
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################    Employee Age   #############################################################

MA.Emp.Age.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23001_005","B23001_007","B23001_012","B23001_014","B23001_019","B23001_021","B23001_026","B23001_028", # Age 29 or younger male
								"B23001_033","B23001_035","B23001_040","B23001_042","B23001_047","B23001_049", # Age 30 to 54 male
								"B23001_054","B23001_056","B23001_061","B23001_063","B23001_068","B23001_070","B23001_075","B23001_080","B23001_085", # Age 55 or older male
								"B23001_091","B23001_093","B23001_098","B23001_100","B23001_105","B23001_107","B23001_112","B23001_114", # Age 29 or younger female
								"B23001_119","B23001_121","B23001_126","B23001_128","B23001_133","B23001_135", # Age 30 to 54 female
								"B23001_140","B23001_142","B23001_147","B23001_149","B23001_154","B23001_156","B23001_161","B23001_166","B23001_171", # Age 55 or older female
														              "B23001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(AgeEmpU29 = B23001_005+B23001_007+B23001_012+B23001_014+B23001_019+B23001_021+B23001_026+B23001_028+
	         B23001_091+B23001_093+B23001_098+B23001_100+B23001_105+B23001_107+B23001_112+B23001_114,
	       AgeEmp3054 = B23001_033+B23001_035+B23001_040+B23001_042+B23001_047+B23001_049+
	         B23001_119+B23001_121+B23001_126+B23001_128+B23001_133+B23001_135,
	       AgeEmpO55 = B23001_054+B23001_056+B23001_061+B23001_063+B23001_068+B23001_070+B23001_075+B23001_080+B23001_085+
	        B23001_140+B23001_142+B23001_147+B23001_149+B23001_154+B23001_156+B23001_161+B23001_166+B23001_171,
         
         AgeEmpU29Per_BG = (B23001_005+B23001_007+B23001_012+B23001_014+B23001_019+B23001_021+B23001_026+B23001_028+
	         B23001_091+B23001_093+B23001_098+B23001_100+B23001_105+B23001_107+B23001_112+B23001_114)/B23001_001,
	        AgeEmp3054Per_BG = (B23001_033+B23001_035+B23001_040+B23001_042+B23001_047+B23001_049+
	         B23001_119+B23001_121+B23001_126+B23001_128+B23001_133+B23001_135)/B23001_001,
	       AgeEmpO55Per_BG = (B23001_054+B23001_056+B23001_061+B23001_063+B23001_068+B23001_070+B23001_075+B23001_080+B23001_085+
	        B23001_140+B23001_142+B23001_147+B23001_149+B23001_154+B23001_156+B23001_161+B23001_166+B23001_171)/B23001_001) %>%

	select(City ,AgeEmpU29, AgeEmp3054, AgeEmpO55, AgeEmpU29Per_BG,AgeEmp3054Per_BG,AgeEmpO55Per_BG) %>%
  left_join(Chelsea.MA, MA.Emp.Age.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.Age.ch)

```
* The number of workers, who are younger than 29 years old in `r Chelsea.MA$City` is `r Chelsea.MA$AgeEmpU29` which is `r (round(Chelsea.MA$AgeEmpU29Per,4))*100`% of total number of workers.\

* The number of workers, who are between 30 and 54 years old in `r Chelsea.MA$City` is `r Chelsea.MA$AgeEmp3054` which is `r (round(Chelsea.MA$AgeEmp3054Per,4))*100`% of total number of workers.\

* The number of workers, who are older than 55 years old in `r Chelsea.MA$City` is `r Chelsea.MA$AgeEmpO55` which is `r (round(Chelsea.MA$AgeEmpO55Per,4))*100`% of total number of workers.\

\


### Employee Race
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################      Employee Race    ############################################################
MA.Emp.Race.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("C23002A_007","C23002A_012","C23002A_020","C23002A_025","C23002A_005","C23002A_018", # White alone
														              "C23002B_007","C23002B_012","C23002B_020","C23002B_025","C23002B_005","C23002B_018", # Black or African American alone
														              "C23002D_007","C23002D_012","C23002D_020","C23002D_025","C23002D_005","C23002D_018", # Asian alone
														              "C23002I_007","C23002I_012","C23002I_020","C23002I_025","C23002I_005","C23002I_018", # Hispanic or Latino alone
														              "C23002G_007","C23002G_012","C23002G_020","C23002G_025","C23002G_005","C23002G_018",# Two or more races
														              "B23001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(WhiteEmp = C23002A_007+C23002A_012+C23002A_020+C23002A_025+C23002A_005+C23002A_018,
	       BlackEmp = C23002B_007+C23002B_012+C23002B_020+C23002B_025+C23002B_005+C23002B_018,
	       AsianEmp = C23002D_007+C23002D_012+C23002D_020+C23002D_025+C23002D_005+C23002D_018,
	       HispanicEmp = C23002I_007+C23002I_012+C23002I_020+C23002I_025+C23002I_005+C23002I_018,
	       TwoOrMoreEmp = C23002G_007+C23002G_012+C23002G_020+C23002G_025+C23002G_005+C23002G_018,
         WhiteEmpPer = (C23002A_007+C23002A_012+C23002A_020+C23002A_025+C23002A_005+C23002A_018)/B23001_001,
	       BlackEmpPer = (C23002B_007+C23002B_012+C23002B_020+C23002B_025+C23002B_005+C23002B_018)/B23001_001,
	       AsianEmpPer = (C23002D_007+C23002D_012+C23002D_020+C23002D_025+C23002D_005+C23002D_018)/B23001_001,
	       HispanicEmpPer = (C23002I_007+C23002I_012+C23002I_020+C23002I_025+C23002I_005+C23002I_018)/B23001_001,
	       TwoOrMoreEmpPer = (C23002G_007+C23002G_012+C23002G_020+C23002G_025+C23002G_005+C23002G_018)/B23001_001) %>%
	select(City ,WhiteEmp, BlackEmp, AsianEmp, HispanicEmp, TwoOrMoreEmp,
	       WhiteEmpPer, BlackEmpPer, AsianEmpPer, HispanicEmpPer, TwoOrMoreEmpPer) %>%
  left_join(Chelsea.MA, MA.Emp.Race.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.Race.ch)

```

* The number of white workers in `r Chelsea.MA$City` is `r Chelsea.MA$WhiteEmp` which is `r (round(Chelsea.MA$WhiteEmpPer,4))*100`% of total number of workers.\
* The number of black workers in `r Chelsea.MA$City` is `r Chelsea.MA$BlackEmp` which is `r (round(Chelsea.MA$BlackEmpPer,4))*100`% of total number of workers.\
* The number of asian workers in `r Chelsea.MA$City` is `r Chelsea.MA$AsianEmp` which is `r (round(Chelsea.MA$AsianEmpPer,4))*100`% of total number of workers.\
* The number of hispanic or latino workers in `r Chelsea.MA$City` is `r Chelsea.MA$HispanicEmp` which is `r (round(Chelsea.MA$HispanicEmpPer,4))*100`% of total number of workers.\
* The number of workers, who have two or more races in `r Chelsea.MA$City` is `r Chelsea.MA$TwoOrMoreEmp` which is `r (round(Chelsea.MA$TwoOrMoreEmpPer,4))*100`% of total number of workers.\
\


### Employee Education
\
```{r message=FALSE, warning=FALSE, ,echo=FALSE, results='hide', comment=""}
#############################################   Employee Education    ########################################################

MA.Educ.Emp.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B16010_003", # Less than high school graduate in labor force
														              "B16010_016", # High school graduate in labor force 
														              "B16010_029", # Some college or associate's degree in labor force
														              "B16010_042",
														              "B16010_001"), # Total
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(LessThanHSLabor = B16010_003,
	       HSGradLabor = B16010_016,
	       SomeCollLabor = B16010_029,
	       BachOrHigherLabor = B16010_042,
	       LessThanHSLaborPer = LessThanHSLabor/B16010_001,
	       HSGradLaborPer = HSGradLabor/B16010_001,
	       SomeCollLaborPer = SomeCollLabor/B16010_001,
	       BachOrHigherLaborPer = BachOrHigherLabor/B16010_001) %>%
	select(City ,LessThanHSLabor, HSGradLabor, SomeCollLabor, BachOrHigherLabor,
	       LessThanHSLaborPer, HSGradLaborPer, SomeCollLaborPer, BachOrHigherLaborPer) %>%
  left_join(Chelsea.MA, MA.Educ.Emp.ch, by="City")

Chelsea.MA <- cbind(MA.Educ.Emp.ch)
```
* The number of workers, who have less than high school degree in `r Chelsea.MA$City` is `r Chelsea.MA$LessThanHSLabor` which is `r (round(Chelsea.MA$LessThanHSLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have high school degree in `r Chelsea.MA$City` is `r Chelsea.MA$HSGradLabor` which is `r (round(Chelsea.MA$HSGradLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have some college or associates degree in `r Chelsea.MA$City` is `r Chelsea.MA$SomeCollLabor` which is `r (round(Chelsea.MA$SomeCollLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have bachelors degree or higher in `r Chelsea.MA$City` is `r Chelsea.MA$BachOrHigherLabor` which is `r (round(Chelsea.MA$BachOrHigherLaborPer,4))*100`% of total number of workers.\

\

### Employee Sex
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################    Employee Sex   #############################################################

MA.Emp.Sex.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23001_005", # Employed males
														              "B23001_007", 
														              "B23001_012",
														              "B23001_014",
														              "B23001_019",
														              "B23001_021",
														              "B23001_026",
														              "B23001_028",
														              "B23001_033",
														              "B23001_035",
														              "B23001_040",
														              "B23001_042",
														              "B23001_047",
														              "B23001_049",
														              "B23001_054",
														              "B23001_056",
														              "B23001_061",
														              "B23001_063",
														              "B23001_068",
														              "B23001_070",
														              "B23001_075",
														              "B23001_080",
														              "B23001_085",
														              "B23001_091", # Employed females
														              "B23001_093",
														              "B23001_098",
														              "B23001_100",
														              "B23001_105",
														              "B23001_107",
														              "B23001_112",
														              "B23001_114",
														              "B23001_119",
														              "B23001_121",
														              "B23001_126",
														              "B23001_128",
														              "B23001_133",
														              "B23001_135",
														              "B23001_140",
														              "B23001_142",
														              "B23001_147",
														              "B23001_149",
														              "B23001_154",
														              "B23001_156",
														              "B23001_161",
														              "B23001_166",
														              "B23001_171",
														              "B23001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(EmpMale = B23001_005 + B23001_007 + B23001_012 + B23001_014 + B23001_019 + B23001_021 + B23001_026 + B23001_028 + B23001_033 + B23001_035 + B23001_040 + B23001_042 + B23001_047 + B23001_049 + B23001_054 + B23001_056 + B23001_061 + B23001_063 + B23001_068+ B23001_070 + B23001_075 + B23001_080 + B23001_085,
	  EmpFemale = B23001_091 + B23001_093 + B23001_098 + B23001_100 + B23001_105 + B23001_107 + B23001_112 + B23001_114 + B23001_119 + B23001_121 + B23001_126+ B23001_128 + B23001_133 + B23001_135 + B23001_140 + B23001_142 + B23001_147 + B23001_149 + B23001_154 + B23001_156 + B23001_161 + B23001_166 + B23001_171,
	  TotalEmp = EmpMale + EmpFemale,
	  EmpMalePer = EmpMale/	B23001_001,
	  EmpFemalePer = EmpFemale/B23001_001) %>%
	select(City, EmpMale, EmpFemale, TotalEmp, EmpMalePer, EmpFemalePer) %>%
  left_join(Chelsea.MA, MA.Emp.Sex.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.Sex.ch)


```
* The number of male workers in `r Chelsea.MA$City` is `r Chelsea.MA$EmpMale` which is `r (round(Chelsea.MA$EmpMalePer,4))*100`% of total number of workers.\
* The number of female workers in `r Chelsea.MA$City` is `r Chelsea.MA$EmpFemale` which is `r (round(Chelsea.MA$EmpFemalePer,4))*100`% of total number of workers.\


\

## Healthcare
\

### Number of Hospitals
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

Chelsea.MA$Hospitals <- 2
```


* `r Chelsea.MA$City` has 2 hospitals.(https://www.ahd.com/)

\

###	Number of Nursing Homes 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$NursingHomes <- 2
```


* `r Chelsea.MA$City` has 2 nursing homes. (https://nursinghomedirectory.com/)


## Municipal Finances
\

###	Revenue Streams
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$RevenueGeneralFundTotalFY19 <- 114625793
Chelsea.MA$RevenueLocalFeesLicensesPermitsFY19 <- 1267000
Chelsea.MA$RevenueOtherLocalSourcesFY19 <- 10050803
Chelsea.MA$RevenueParkingFY19 <- 2412305
Chelsea.MA$RevenueInterestPenaltiesFY19 <- 900000
Chelsea.MA$RevenueSchoolFY19 <- 6516250
Chelsea.MA$RevenueStateFederalFY19 <- 3572372
Chelsea.MA$RevenueUseOfReservesFY19 <- 1850000
Chelsea.MA$RevenuePropertyTaxFY19  <- 88057063
```
* The total general fund revenues for Portsmouth city is $114,625,793 in fiscal year 2019, which contains the following items: Local Fees, Licenses, Permits with 1,267,000 Dollar, Other Local Sources with 10,050,803 Dollar, Parking Revenues with 
2,412,305 Dollar, Interest & Penalties with 900,000 Dollar, Sate/Federal Revenues with 3,572,372 Dollar, Use of Reserves with 1,850,000 Dollar, and Property Tax with 88,057,063 Dollar. (http://files.cityofportsmouth.com/finance/fy19/budgetfy19.pdf)

\

###	Major Expense Drivers
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$ExpendituresGeneralFundTotalFY19 <- 114625793
Chelsea.MA$ExpendituresCityCouncilFY19 <- 33536
Chelsea.MA$ExpendituresCityManagerFY19 <- 361897
Chelsea.MA$ExpendituresHumanResourcesTotalFY19 <- 553870
Chelsea.MA$ExpendituresCityClerkFY19 <- 258332
Chelsea.MA$ExpendituresElectionsFY19 <- 76045
Chelsea.MA$ExpendituresLegalFY19 <- 644917
Chelsea.MA$ExpendituresFinanceFY19 <- 4706687
Chelsea.MA$ExpenditureGeneralAdministrativeCollBargainingFY19 <- 931299
Chelsea.MA$ExpendituresPlanningFY19 <- 849088
Chelsea.MA$ExpendituresInspectionFY19 <- 499571
Chelsea.MA$ExpendituresPublicHealthFY19 <- 211403
Chelsea.MA$ExpendituresPublicWorksFY19 <- 7104223
Chelsea.MA$ExpendituresPublicLibraryFY19 <- 1921013
Chelsea.MA$ExpendituresRecreationFY19 <- 895628
Chelsea.MA$ExpendituresSeniorServicesFY19 <- 163909
Chelsea.MA$ExpendituresPublicWelfareFY19 <- 295373
Chelsea.MA$ExpendituresOutsideSocialServicesFY19 <- 186374
Chelsea.MA$ExpendituresEmergencyManagementFY19 <- 12014
Chelsea.MA$ExpendituresPoliceDepartmentFY19 <- 11280229
Chelsea.MA$ExpendituresFireDepartmentFY19 <- 8966305
Chelsea.MA$ExpendituresSchoolDepartmentFY19 <- 48086136
Chelsea.MA$ExpendituresIndoorPoolFY19 <- 150000
Chelsea.MA$ExpendituresPrescottParkFY19 <- 60000
Chelsea.MA$ExpendituresNonOperatingFY19 <- 26377944
```

* The total amount of general fund of expenditures for `r Chelsea.MA$City` is $114,625,793 in Fiscal Year 2019 and the major expense driver is related to school department, which is 48,086,136 Dollar. The other expenditures include city council with 33,536 Dollar, city manager with 361,897 Dollar, human resources with 553,870 Dollar, city clerk with 258,332 Dollar, elections with 76,045 Dollar, legal with 644,917 Dollar, finance with 4,706,687 Dollar, general administrative/coll bargaining with 931,299 Dollar, planning with 849,088 Dollar, inspection with 499,571 Dollar, public health with 211,403 Dollar, public works with 7,104,223 Dollar, public library with 1,921,013, recreation with 895,628 Dollar, senior services with 163,909 Dollar, public welfare with 295,373 Dollar, outside social services with 186,374 Dollar, emergency management with 12,014 Dollar, police department with 11,280,229 Dollar, fire department with 8,966,305 Dollar, indoor pool with 150,000 Dollar, prescott park with 60,000 Dollar, non-operating with 26,377,944 Dollar. (http://files.cityofportsmouth.com/finance/fy19/budgetfy19.pdf)




\

### FY20 Budget – Projected Deficits 
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$RevenuesTotalGeneralFundFY20 <- 118638630
Chelsea.MA$RevenuesLocalFeesLicensesPermitsFY20 <- 1539700
Chelsea.MA$RevenuesOtherLocalSourcesFY20 <- 10564901
Chelsea.MA$NetParkingRevenuesFY20 <- 2412305
Chelsea.MA$RevenuesInterestPenaltiesFY20 <- 1300000
Chelsea.MA$RevenuesSchoolTuitionFY20 <- 6569500
Chelsea.MA$StateRevenuesFY20 <- 3607246
Chelsea.MA$RevenuesUseOfFundBalanceFY20 <- 2500000
Chelsea.MA$RevenuesEstimatedPropertyTaxFY20 <- 90144978

Chelsea.MA$ExpendituresTotalGeneralFundFY20 <- 118473737
Chelsea.MA$ExpendituresMunicipalFY20 <- 20403772
Chelsea.MA$ExpendituresPoliceFY20 <- 11647381
Chelsea.MA$ExpendituresFireFY20 <- 9232857
Chelsea.MA$ExpendituresSchoolFY20 <- 49612427
Chelsea.MA$ExpendituresCollectiveBargainingFY20 <-1059942
Chelsea.MA$ExpendituresTransferToIndoorPoolFY20 <- 150000
Chelsea.MA$ExpendituresTransferToPrescottParkFY20 <- 60000
Chelsea.MA$ExpendituresNonOperatingFY20 <- 26307358
```

* The total revenues for general fund for Portsmouth city is 118,638,630 Dollar in fiscal year 2020, which contains the following items: Local Fees, Licenses, Permits with 1,539,700 Dollar, Other Local Sources with 10,564,901 Dollar, Net Parking Revenues with 2,412,305 Dollar, Interest/Penalties with 1,300,000 Dollar, School Tuition with 6,569,500 Dollar, State Revenues with 3,607,246 Dollar, Use of Fund Balance with 2,500,000 Dollar, and Estimated Property Tax with 90,144,978 Dollar. The total amount of general fund of expenditures for `r Chelsea.MA$City` is $118,473,737 in Fiscal Year 2020 and the major expense driver is related to school, which is 49,612,427 Dollar. The other expenditures include Municipal with 20,403,772 Dollar, Police with 11,647,381 Dollar, Fire with 9,232,857, Collective Bargaining with 1,059,942 Dollar, Transfer to Indoor Pool with 150,000 Dollar, Transfer to Prescott Park with 60,000 Dollar, and Non-Operating with 26,307,358 Dollar. (http://files.cityofportsmouth.com/finance/fy20/July%202019%20FY%2020.pdf)


\


## Infrastructure
\

### Presence of Nearby Ports, Airports, Major Rail Facilities, or Intermodal Freight Facilities
\

* Portsmouth city is located 50 miles north of Boston and it has a strategic position on the East Coast. Portsmouth's closest airport is Pease International Tradeport (PSM) in Portsmouth. Other airports are Manchester Airport, Logan Airport (Boston) and Portland International Airport (Maine), which are easily accessed within an hour drive from the city. There are some bus transportation and private airport shuttles, which serve all three airports with direct service into Portsmouth. "The rail system through Portsmouth is solely utilized for freight movement. Passenger Rail service does not directly serve Portsmouth, however neighboring communities Dover and Exeter have Amtrak service and COAST provides service to those stations". There is a port near to city, where is an effective means for freight shipping and receiving. (https://www.cityofportsmouth.com/)








\

### Public Transport Reliability and Scope 
\

* There is a bus system in Portsmouth, which is called COAST Bus. COAST has transported passengers all around the Seacoast region, offering access to Rockingham and Strafford counties as well as Berwick, Maine. The other type of public transportation in the city is Wildcat Transit, which provides frequent service between Portsmouth and Durham-UNH campus via Newington. Routes are open to the public and connect Market Square to the West End (via Islington) and the malls (via Woodbury and Maplewood Aves). Durham is the Wildcat Transit hub with additional service to Newmarket and Dover as well. The other type of transportation is C&J Trailways, which offers a convenient method of traveling between Portsmouth and Boston or New York. Seacoast Airport Service is located in Portsmouth and Epping, New Hampshire, both of which are only about an hour away from the three major airports in the New England area. Also, there is a bike sharing program in Portsmouth, which is called Zagster and it is the North American leader in bike sharing, powering more than half a million trips and counting, and people can use it in downtown Portsmouth. (https://www.cityofportsmouth.com/publicworks/transportation/public-transit)



\

### Internet Access
\

* Internet in Portsmouth city is coveraged by the two most common companies, Viasat Internet and HughesNet. Consolidated Communications and XFINITY from Comcast can also provide coverage in Portsmouth. The most frequently available broadband options in Portsmouth are Cable, followed by Satellite. There are 16 internet providers in Portsmouth with 6 of those offering residential service. Portsmouth is the 2nd most connected city in New Hampshire and the fastest zip code in Portsmouth for May 2020 is 03801. (https://broadbandnow.com/New-Hampshire/Portsmouth)


\

## Food Insecurity
\

\

### Number of Grocery Stores
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$NumGrocery <- 47
```
* `r Chelsea.MA$City` has 47 Grocery Stores. (https://www.city-data.com/city/Portsmouth-New-Hampshire.html)

\

### SNAP Recipients 
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##########################################################################################################################

                                                #----------------------#
                                                #    FOOD INSECURITY   #
                                                #----------------------#

####################################################  SNAP Recipients  ###################################################         

MA.Snap.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B22001_002", # Household received Food Stamps/SNAP in the past 12 months
														"B22001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(SnapRec = B22001_002/B22001_001) %>%
	select(City ,SnapRec) %>%
  left_join(Chelsea.MA, MA.Snap.ch, by="City")

Chelsea.MA <- cbind(MA.Snap.ch)

#######################################################################################################################################

```
* The percent of households, who received Food Stamps/SNAP in the past 12 months in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$SnapRec,4))*100`%.\

\

## Housing
\

### Proportion of Renters to Owners
\

### Home Values
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

                                                #----------------------#
                                                #       HOUSING        #
                                                #----------------------#

######################   Proportion of Renters to Owners, Home Values   ########################################

MA.Housing.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"), # Owner occupied
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME,
         MedianHValue = B25077_001,
	       AvgHValue = B25082_001/B25003_002) %>%
	mutate(RentersPer = B25009_010/B25009_001,
				 HomeOwnPer = B25009_002/B25009_001,
				 RentersToOwners = B25009_010/B25009_002) %>%
	select(City,RentersPer, HomeOwnPer, RentersToOwners, MedianHValue, AvgHValue) %>%
  left_join(Chelsea.MA, MA.Housing.ch, by="City")

Chelsea.MA <- cbind(MA.Housing.ch)
```
* The median house value in `r Chelsea.MA$City` is 397400 Dollar.\

* The average house value in `r Chelsea.MA$City` is 2333848800 Dollar.\

* The proportion of renters to owners in `r Chelsea.MA$City` is `r round(Chelsea.MA$RentersToOwners,3)`.\

* The percentage of renters in `r Chelsea.MA$City` is `r (round(Chelsea.MA$RentersPer,2))*100`%.\

* The percentage of owners in `r Chelsea.MA$City` is `r (round(Chelsea.MA$HomeOwnPer,2))*100`%.\

Followed is the map of Proportion of Renters to Owners, Median Home Values, and Average Home Values of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## MAP
ch.MA.housing <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"),
                     areas = area,
                     summary_level = "block group")

ch.housing.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(MedianHValue_BG = B25077_001E,
	       AvgHValue_BG = B25082_001E / B25003_002E) %>%
	mutate(RentersPer_BG = B25009_010E/B25009_001E,
				 HomeOwnPer_BG = B25009_002E/B25009_001E,
				 RentersToOwners_BG = B25009_010E/B25009_002E)

chelsea.housing <- merge(ch.housing.get, ch.MA.housing, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.housing) + tm_polygons("MedianHValue_BG" , palette="Blues", style = "quantile", title = "Median Home Value", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") + tm_layout(legend.position = c("right","bottom"))

```
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
tm_shape(chelsea.housing) + tm_polygons("AvgHValue_BG" , palette="Greens", style = "quantile", title = "Average Home Value", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray")+tm_layout(legend.position = c("right","bottom"))
```


\


\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
tm_shape(chelsea.housing) + tm_polygons("RentersToOwners_BG" , palette="Reds", style = "quantile", title = "RentersToOwners") + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") + tm_layout(legend.position = c("right","bottom"))
```

\

### Property Tax Rates
\



```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$PropertyTaxRate <- 14.86
```
* The 2019 tax rate is 14.86 Dollar per 1000 Dollar of valuation in `r Chelsea.MA$City`.(https://www.cityofportsmouth.com/city/press-releases/city-property-tax-rate-set-1486)


\



\


### Duration of Occupancy
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#########################################      Duration of Occupancy    ####################################################
MA.Dur.Occ.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME,
         MedYrMovedIn = B25039_001, 
				 MedYrRentMovedIn = B25039_003,
				 MedYrOwnMovedIn = B25039_002) %>%
	select(City, MedYrMovedIn, MedYrRentMovedIn, MedYrOwnMovedIn) %>%
  left_join(Chelsea.MA, MA.Dur.Occ.ch, by="City")

Chelsea.MA <- cbind(MA.Dur.Occ.ch)
```

* The median year that a homeowner moved into their current domicile in `r Chelsea.MA$City` is `r Chelsea.MA$MedYrOwnMovedIn`.\

* The median year that a renter moved into their current domicile in `r Chelsea.MA$City` is `r Chelsea.MA$MedYrRentMovedIn`.\

Followed is the map of Duration of Occupancy of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## MAP
ch.MA.dur <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"),
                     areas = area,
                     summary_level = "block group")

ch.dur.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(MedYrMovedIn_BG = B25039_001E, # I'm not sure if I should substract this value from 2018
				 MedYrRentMovedIn_BG = B25039_003E,
				 MedYrOwnMovedIn_BG = B25039_002E)

chelsea.dur <- merge(ch.dur.get, ch.MA.dur, by.x = 'NAME.y', by.y='NAME')



tm_shape(chelsea.dur) + tm_polygons(c("MedYrMovedIn_BG","MedYrRentMovedIn_BG","MedYrOwnMovedIn_BG"), style="jenks", palette=list("Greens","seq","Blues"), border.col = "darkgray", title=c("MedYrMovedIn","MedYrRentMovedIn","MedYrOwnMovedIn")) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tm_layout(legend.position = c("right","bottom"))
```


\

### Cost Burdened Occupants


\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

##############################################   Cost Burdened Occupants   ##################################
MA.CostBurdened.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25095_006", # Household income by selected monthly owner Costs as a percentage of household income
														              # Less than $10,000 (30 to 34.9 percent)
														              "B25095_007", # Less than $10,000 (35 to 39.9 percent)
														              "B25095_008", # Less than $10,000 (40 to 49.9 percent)
														              "B25095_009", # Less than $10,000 (50 percent or more)
														              "B25095_015", # $10,000 to $19,999 (30 to 34.9 percent)
														              "B25095_016", # $10,000 to $19,999 (35 to 39.9 percent)
														              "B25095_017", # $10,000 to $19,999 (40 to 49.9 percent)
														              "B25095_018", # $10,000 to $19,999 (50 percent or more)
														              "B25095_024", # $20,000 to $34,999 (30 to 34.9 percent)
														              "B25095_025", # $20,000 to $34,999 (35 to 39.9 percent)
														              "B25095_026", # $20,000 to $34,999 (40 to 49.9 percent)
														              "B25095_027", # $20,000 to $34,999 (50 percent or more)
														              "B25095_033", # $35,000 to $49,999 (30 to 34.9 percent)
														              "B25095_034", # $35,000 to $49,999 (35 to 39.9 percent)
														              "B25095_035", # $35,000 to $49,999 (40 to 49.9 percent)
														              "B25095_036", # $35,000 to $49,999 (50 percent or more)
														              "B25095_042", # $50,000 to $74,999 (30 to 34.9 percent)
														              "B25095_043", # $50,000 to $74,999 (35 to 39.9 percent)
														              "B25095_044", # $50,000 to $74,999 (40 to 49.9 percent)
														              "B25095_045", # $50,000 to $74,999 (50 percent or more)
														              "B25095_051", # $75,000 to $99,999 (30 to 34.9 percent)
														              "B25095_052", # $75,000 to $99,999 (35 to 39.9 percent)
														              "B25095_053", # $75,000 to $99,999 (40 to 49.9 percent)
														              "B25095_054", # $75,000 to $99,999 (50 percent or more)
														              "B25095_060", # $100,000 to $149,999 (30 to 34.9 percent)
														              "B25095_061", # $100,000 to $149,999 (35 to 39.9 percent)
														              "B25095_062", # $100,000 to $149,999 (40 to 49.9 percent)
														              "B25095_063", # $100,000 to $149,999 (50 percent or more)
														              "B25095_069", # $150,000 or more (30 to 34.9 percent)
														              "B25095_070", # $150,000 or more (35 to 39.9 percent)
														              "B25095_071", # $150,000 or more (40 to 49.9 percent)
														              "B25095_072", # $150,000 or more (50 percent or more)
														              "B25095_001",
														              "B25095_001"), # Total
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(CostBurdened = B25095_006+B25095_007+B25095_008+B25095_009+B25095_015+B25095_016+B25095_017+B25095_018+
	       B25095_024+B25095_025+B25095_026+B25095_027+B25095_033+B25095_034+B25095_035+B25095_036+B25095_042+B25095_043+B25095_044+B25095_045+B25095_051+B25095_052+B25095_053+B25095_054+B25095_060+B25095_061+B25095_062+B25095_063+B25095_069+B25095_070+B25095_071+B25095_072,
         CostBurdenedPer = CostBurdened/B25095_001) %>%
	select(City ,CostBurdened,CostBurdenedPer) %>%
  left_join(Chelsea.MA, MA.CostBurdened.ch, by="City")

Chelsea.MA <- cbind(MA.CostBurdened.ch)

```
* The number of households, who spend 30 percent or more on housing costs in `r Chelsea.MA$City` is `r Chelsea.MA$CostBurdened` which is `r (round(Chelsea.MA$CostBurdenedPer,3))*100`% of total number of households, who spend money on housing costs.\



\

### Local/State Policies + Assistance on Rent Deferment
\

* There is a program in Portsmouth city, which is Paycheck Protection Plan and it was created by the CARES Act to support COVID-19-impacted small business owners and their employees by providing loans that can be forgiven, in support of payroll expenses, mortgage, or rent.(https://www.cityofportsmouth.com/)

```{r}
Portsmouth <- data.frame()
Portsmouth <- Chelsea.MA

library(data.table)
Portsmouth <- as.data.frame(t(as.matrix(Portsmouth)))
colnames(Portsmouth) <- Portsmouth[1,]
setDT(Portsmouth, keep.rownames = TRUE)[]
names(Portsmouth)[1] <- 'Indicators'
Portsmouth
```
```{r}
library(data.table)
Keene <- as.data.frame(t(as.matrix(Keene)))
colnames(Keene) <- Keene[1,]
setDT(Keene, keep.rownames = TRUE)[]
names(Keene)[1] <- 'Indicators'
Keene 
```

```{r}
library(data.table)
Littleton <- as.data.frame(t(as.matrix(Littleton)))
colnames(Littleton) <- Littleton[1,]
setDT(Littleton, keep.rownames = TRUE)[]
names(Littleton)[1] <- 'Indicators'
Littleton
```

```{r}
library(data.table)
Manchester <- as.data.frame(t(as.matrix(Manchester)))
colnames(Manchester) <- Manchester[1,]
setDT(Manchester, keep.rownames = TRUE)[]
names(Manchester)[1] <- 'Indicators'
Manchester
```

```{r}
two.cities <- merge(Portsmouth, Keene , by="Indicators", all=TRUE)
two.cities
```

```{r}
three.cities <- merge(two.cities, Littleton, by="Indicators", all=TRUE)
Four.cities <- merge(three.cities, Manchester, by="Indicators", all=TRUE)
Cities.MA <- Four.cities
Cities.MA
```

```{r}
Cities.MA$Indicators <- as.character(Cities.MA$Indicators)
Cities.MA$Indicators[Cities.MA$Indicators == 'TotalPop'] <- 'TotalPopulation'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeU18'] <- 'AgeUnder18'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeU18Per'] <- 'AgeUnder18_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Age1834Per'] <- 'Age1834Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Age3564Per'] <- 'Age3564Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeO65'] <- 'AgeOlderThan65'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeO65Per'] <- 'AgeOlderThan65_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'MedHouseIncome'] <- 'MedianHouseIncome'
Cities.MA$Indicators[Cities.MA$Indicators == 'White'] <- 'WhitePopulation'
Cities.MA$Indicators[Cities.MA$Indicators == 'WhitePer'] <- 'WhitePopulation_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Black'] <- 'BlackPopulation'
Cities.MA$Indicators[Cities.MA$Indicators == 'BlackPer'] <- 'BlackPopulation_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Asian'] <- 'AsianPopulation'
Cities.MA$Indicators[Cities.MA$Indicators == 'AsianPer'] <- 'AsianProportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Hispanic'] <- 'HispanicPopulation'
Cities.MA$Indicators[Cities.MA$Indicators == 'HispanicPer'] <- 'HispanicPopulation_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'TwoOrMore'] <- 'PopulationWithTwoOrMoreRaces'
Cities.MA$Indicators[Cities.MA$Indicators == 'TwoOrMorePer'] <- 'PopulationWithTwoOrMoreRaces_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'FemalePer'] <- 'Female_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'MalePer'] <- 'Male_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'SexRatio'] <- 'NumberOfFemaleToMale'
Cities.MA$Indicators[Cities.MA$Indicators == 'AveHouseH'] <- 'AverageHouseholdSize'
Cities.MA$Indicators[Cities.MA$Indicators == 'LessThanHS'] <- 'LessThanHighSchoolDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'LessThanHSPer'] <- 'LessThanHighSchoolDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'HSGrad'] <- 'HighSchoolDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'HSGradPer'] <- 'HighSchoolDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'SomeColl'] <- 'SomeCollegeDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'SomeCollPer'] <- 'SomeCollegeDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Bach'] <- 'BachelorDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'BachPer'] <- 'BachelorDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Master'] <- 'MaterDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'MasterPer'] <- 'MaterDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Prof'] <- 'ProfessionalSchoolDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'ProfPer'] <- 'ProfessionalSchoolDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Doc'] <- 'DoctorateDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'DocPer'] <- 'DoctorateDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'FemHeadPer'] <- 'SingleFemaleHeaded_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'MaleHeadPer'] <- 'SingleMaleHeaded_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'FamPovPer'] <- 'FamiliesBelowPovertyLevel_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'PopPovPer'] <- 'PopulationBelowPovertyLevel_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'TotalPopPov'] <- 'TotalPopulationBelowPovertyLevel'
Cities.MA$Indicators[Cities.MA$Indicators == 'OldAlonePer'] <- 'ElderlyPeopleLivingAlone_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'SchoolsDistrict'] <- 'NumberOfSchoolsDistrict'
Cities.MA$Indicators[Cities.MA$Indicators == 'PubSchools'] <- 'NumberOfPublicSchools'
Cities.MA$Indicators[Cities.MA$Indicators == 'PvSchools'] <- 'NumberOfPrivateSchools'
Cities.MA$Indicators[Cities.MA$Indicators == 'SchoolsDistStudents'] <- 'NumberOfStudentsInSchoolsDistrict'
Cities.MA$Indicators[Cities.MA$Indicators == 'NumUni'] <- 'NumberOfUniversity'
Cities.MA$Indicators[Cities.MA$Indicators == 'EnrolPK12'] <- 'EnrolledInPK-12'
Cities.MA$Indicators[Cities.MA$Indicators == 'NumJobs'] <- 'NumberOfJobs'
Cities.MA$Indicators[Cities.MA$Indicators == 'LabForce'] <- 'LaborForce'
Cities.MA$Indicators[Cities.MA$Indicators == 'LabForcePer'] <- 'LaborForce_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'CivLabForce'] <- 'CivilianLaborforce'
Cities.MA$Indicators[Cities.MA$Indicators == 'CivLabForcePer'] <- 'CivilianLaborforce_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'MilitaryPer'] <- 'Military_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'EmpRate'] <- 'EmploymentRate'
Cities.MA$Indicators[Cities.MA$Indicators == 'UnempRate'] <- 'UnemploymentRate'
Cities.MA$Indicators[Cities.MA$Indicators == 'EmployedCLF'] <- 'EmployedCivilians'
Cities.MA$Indicators[Cities.MA$Indicators == 'UnemployedCLF'] <- 'UnemployedCivilians'
Cities.MA$Indicators[Cities.MA$Indicators == 'FemaleNCAIS'] <- 'FemaleByIndustry'
Cities.MA$Indicators[Cities.MA$Indicators == 'FemaleNCAISPer'] <- 'FemaleByIndustry_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'MaleNCAIS'] <- 'MaleByIndustry'
Cities.MA$Indicators[Cities.MA$Indicators == 'MaleNCAISPer'] <- 'MaleByIndustry_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Agriculture'] <- 'Agriculture&Forestry&Fishing&Hunting&Mining'
Cities.MA$Indicators[Cities.MA$Indicators == 'Transportation'] <- 'Transportation&Warehousing&Utilities'
Cities.MA$Indicators[Cities.MA$Indicators == 'Finance_Ins'] <- 'Finance&Insurance&RrealEstate&Rental&Leasing'
Cities.MA$Indicators[Cities.MA$Indicators == 'Professional'] <- 'Professional&Scientific&Mmanagement&Administrative&WasteManagmentServices'
Cities.MA$Indicators[Cities.MA$Indicators == 'Educ_Health_SocSvcs'] <- 'EducationalServices&HealthCare&SocialAssistance'
Cities.MA$Indicators[Cities.MA$Indicators == 'RecreationEtc'] <- 'Arts&Entertainment&Recreation&Accommodation&FoodServices'
Cities.MA$Indicators[Cities.MA$Indicators == 'OtherIndustries'] <- 'OtherServicesExceptPublicAdministration'
Cities.MA$Indicators[Cities.MA$Indicators == 'PublicAdmin'] <- 'PublicAdministration'
Cities.MA$Indicators[Cities.MA$Indicators == 'MedEarning'] <- 'MedianEarning'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeEmpU29'] <- 'EmployeesAgeUnder29'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeEmpU29Per_BG'] <- 'EmployeesAgeYoungerThan29_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeEmp3054'] <- 'EmployeesAge3054'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeEmp3054Per_BG'] <- 'EmployeesAge3054_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeEmpO55'] <- 'EmployeesAgeOlderThan55'
Cities.MA$Indicators[Cities.MA$Indicators == 'AgeEmpO55Per_BG'] <- 'EmployeesAgeOlderThan55_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'WhiteEmp'] <- 'WhiteEmployees'
Cities.MA$Indicators[Cities.MA$Indicators == 'WhiteEmpPer'] <- 'WhiteEmployees_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'BlackEmp'] <- 'BlackEmployees'
Cities.MA$Indicators[Cities.MA$Indicators == 'BlackEmpPer'] <- 'BlackEmployees_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'AsianEmp'] <- 'AsianEmployees'
Cities.MA$Indicators[Cities.MA$Indicators == 'AsianEmpPer'] <- 'AsianEmployees_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'HispanicEmp'] <- 'HispanicEmployees'
Cities.MA$Indicators[Cities.MA$Indicators == 'HispanicEmpPer'] <- 'HispanicEmployees_Propotion'
Cities.MA$Indicators[Cities.MA$Indicators == 'TwoOrMoreEmp'] <- 'EmployeesWithTwoOrMoreRaces'
Cities.MA$Indicators[Cities.MA$Indicators == 'TwoOrMoreEmpPer'] <- 'EmployeesWithTwoOrMoreRaces_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'LessThanHSLabor'] <- 'LaborsWithLessThanHighSchoolDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'LessThanHSLaborPer'] <- 'LaborsWithLessThanHighSchoolDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'HSGradLabor'] <- 'LaborsWithHighSchoolDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'HSGradLaborPer'] <- 'LaborsWithHighSchoolDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'SomeCollLabor'] <- 'LaborsWithCollegeDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'SomeCollLaborPer'] <- 'LaborsWithCollegeDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'BachOrHigherLabor'] <- 'LaborsWithBachelorOrHigherDegree'
Cities.MA$Indicators[Cities.MA$Indicators == 'BachOrHigherLaborPer'] <- 'LaborsWithBachelorOrHigherDegree_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'EmpFemale'] <- 'FemaleEmployess'
Cities.MA$Indicators[Cities.MA$Indicators == 'EmpFemalePer'] <- 'FemaleEmployess_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'EmpMale'] <- 'MaleEmployess'
Cities.MA$Indicators[Cities.MA$Indicators == 'EmpMalePer'] <- 'MaleEmployess_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'TotalEmp'] <- 'TotalEmployees'
Cities.MA$Indicators[Cities.MA$Indicators == 'NursingHomes'] <- 'NumberOfNursingHomes'
Cities.MA$Indicators[Cities.MA$Indicators == 'NumGrocery'] <- 'NumberOfGrocery'
Cities.MA$Indicators[Cities.MA$Indicators == 'SnapRec'] <- 'SNAPRecipients '
Cities.MA$Indicators[Cities.MA$Indicators == 'HomeOwnPer'] <- 'ProportionOfHomeOwners'
Cities.MA$Indicators[Cities.MA$Indicators == 'RentersPer'] <- 'NumberOfRenters_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'RentersToOwners'] <- 'ProportionOfRentersToOwners'
Cities.MA$Indicators[Cities.MA$Indicators == 'MedianHValue'] <- 'MedianHomeValue'
Cities.MA$Indicators[Cities.MA$Indicators == 'AvgHValue'] <- 'AverageHomeValues'
Cities.MA$Indicators[Cities.MA$Indicators == 'MedYrMovedIn'] <- 'MedianYearMovedIn'
Cities.MA$Indicators[Cities.MA$Indicators == 'MedYrOwnMovedIn'] <- 'MedianYearOwnerMovedIn'
Cities.MA$Indicators[Cities.MA$Indicators == 'MedYrRentMovedIn'] <- 'MedianYearRenterMovedIn'
Cities.MA$Indicators[Cities.MA$Indicators == 'CostBurdenedPer'] <- 'CostBurdened_Proportion'
Cities.MA$Indicators[Cities.MA$Indicators == 'Homelessness'] <- 'NumberOfHomelessPeople'
Cities.MA
#write.csv(Cities.MA,"~/Desktop/Cities.NH.csv", row.names = FALSE)
```




```{r}
MA.Vars$Indicators <- as.character(MA.Vars$Indicators)
MA.Vars$Indicators[MA.Vars$Indicators == 'TotalPop_State'] <- 'TotalPopulation'
MA.Vars$Indicators[MA.Vars$Indicators == 'Age1834_State'] <- 'Age1834'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeU18_State'] <- 'AgeUnder18'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeU18Per_State'] <- 'AgeUnder18_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Age1834Per_State'] <- 'Age1834Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Age3564Per_State'] <- 'Age3564Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Age3564_State'] <- 'Age3564'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeO65_State'] <- 'AgeOlderThan65'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeO65Per_State'] <- 'AgeOlderThan65_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'MedHouseIncome_State'] <- 'MedianHouseIncome'
MA.Vars$Indicators[MA.Vars$Indicators == 'White_State'] <- 'WhitePopulation'
MA.Vars$Indicators[MA.Vars$Indicators == 'WhitePer_State'] <- 'WhitePopulation_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Black_State'] <- 'BlackPopulation'
MA.Vars$Indicators[MA.Vars$Indicators == 'BlackPer_State'] <- 'BlackPopulation_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Asian_State'] <- 'AsianPopulation'
MA.Vars$Indicators[MA.Vars$Indicators == 'AsianPer_State'] <- 'AsianProportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Hispanic_State'] <- 'HispanicPopulation'
MA.Vars$Indicators[MA.Vars$Indicators == 'HispanicPer_State'] <- 'HispanicPopulation_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'TwoOrMore_State'] <- 'PopulationWithTwoOrMoreRaces'
MA.Vars$Indicators[MA.Vars$Indicators == 'TwoOrMorePer_State'] <- 'PopulationWithTwoOrMoreRaces_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'FemalePer_State'] <- 'Female_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'MalePer_State'] <- 'Male_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'SexRatio_State'] <- 'NumberOfFemaleToMale'
MA.Vars$Indicators[MA.Vars$Indicators == 'AveHouseH_State'] <- 'AverageHouseholdSize'
MA.Vars$Indicators[MA.Vars$Indicators == 'LessThanHS_State'] <- 'LessThanHighSchoolDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'LessThanHSPer_State'] <- 'LessThanHighSchoolDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'HSGrad_State'] <- 'HighSchoolDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'HSGradPer_State'] <- 'HighSchoolDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'SomeColl_State'] <- 'SomeCollegeDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'SomeCollPer_State'] <- 'SomeCollegeDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Bach_State'] <- 'BachelorDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'BachPer_State'] <- 'BachelorDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Master_State'] <- 'MaterDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'MasterPer_State'] <- 'MaterDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Prof_State'] <- 'ProfessionalSchoolDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'ProfPer_State'] <- 'ProfessionalSchoolDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Doc_State'] <- 'DoctorateDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'DocPer_State'] <- 'DoctorateDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'FemHeadPer_State'] <- 'SingleFemaleHeaded_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'MaleHeadPer_State'] <- 'SingleMaleHeaded_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'FamPovPer_State'] <- 'FamiliesBelowPovertyLevel_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'PopPovPer_State'] <- 'PopulationBelowPovertyLevel_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'TotalPopPov_State'] <- 'TotalPopulationBelowPovertyLevel'
MA.Vars$Indicators[MA.Vars$Indicators == 'OldAlonePer_State'] <- 'ElderlyPeopleLivingAlone_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'SchoolsDistrict'] <- 'NumberOfSchoolsDistrict'
MA.Vars$Indicators[MA.Vars$Indicators == 'PubSchools'] <- 'NumberOfPublicSchools'
MA.Vars$Indicators[MA.Vars$Indicators == 'PvSchools'] <- 'NumberOfPrivateSchools'
MA.Vars$Indicators[MA.Vars$Indicators == 'NumUni'] <- 'NumberOfUniversity'
MA.Vars$Indicators[MA.Vars$Indicators == 'EnrolPK12_State'] <- 'EnrolledInPK-12'
MA.Vars$Indicators[MA.Vars$Indicators == 'NumJobs_State'] <- 'NumberOfJobs'
MA.Vars$Indicators[MA.Vars$Indicators == 'LabForce_State'] <- 'LaborForce'
MA.Vars$Indicators[MA.Vars$Indicators == 'LabForcePer_State'] <- 'LaborForce_Proportion' 
MA.Vars$Indicators[MA.Vars$Indicators == 'CivLabForce_State'] <- 'CivilianLaborforce'
MA.Vars$Indicators[MA.Vars$Indicators == 'CivLabForcePer_State'] <- 'CivilianLaborforce_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'MilitaryPer_State'] <- 'Military_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'EmpRate_State'] <- 'EmploymentRate'
MA.Vars$Indicators[MA.Vars$Indicators == 'UnempRate_State'] <- 'UnemploymentRate'
MA.Vars$Indicators[MA.Vars$Indicators == 'EmployedCLF_State'] <- 'EmployedCivilians'
MA.Vars$Indicators[MA.Vars$Indicators == 'UnemployedCLF_State'] <- 'UnemployedCivilians'
MA.Vars$Indicators[MA.Vars$Indicators == 'FemaleNCAIS_State'] <- 'FemaleByIndustry'
MA.Vars$Indicators[MA.Vars$Indicators == 'FemaleNCAISPer_State'] <- 'FemaleByIndustry_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'MaleNCAIS_State'] <- 'MaleByIndustry'
MA.Vars$Indicators[MA.Vars$Indicators == 'MaleNCAISPer_State'] <- 'MaleByIndustry_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'Agriculture_State'] <- 'Agriculture&Forestry&Fishing&Hunting&Mining'
MA.Vars$Indicators[MA.Vars$Indicators == 'Transportation_State'] <- 'Transportation&Warehousing&Utilities'
MA.Vars$Indicators[MA.Vars$Indicators == 'Finance_Ins_State'] <- 'Finance&Insurance&RrealEstate&Rental&Leasing'
MA.Vars$Indicators[MA.Vars$Indicators == 'Professional_State'] <- 'Professional&Scientific&Mmanagement&Administrative&WasteManagmentServices'
MA.Vars$Indicators[MA.Vars$Indicators == 'Educ_Health_SocSvcs_State'] <- 'EducationalServices&HealthCare&SocialAssistance'
MA.Vars$Indicators[MA.Vars$Indicators == 'RecreationEtc_State'] <- 'Arts&Entertainment&Recreation&Accommodation&FoodServices'
MA.Vars$Indicators[MA.Vars$Indicators == 'OtherIndustries_State'] <- 'OtherServicesExceptPublicAdministration'
MA.Vars$Indicators[MA.Vars$Indicators == 'PublicAdmin_State'] <- 'PublicAdministration'
MA.Vars$Indicators[MA.Vars$Indicators == 'MedEarning_State'] <- 'MedianEarning'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeEmpU29_State'] <- 'EmployeesAgeUnder29'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeEmpU29Per_State'] <- 'EmployeesAgeYoungerThan29_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeEmp3054_State'] <- 'EmployeesAge3054'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeEmp3054Per_State'] <- 'EmployeesAge3054_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeEmpO55_State'] <- 'EmployeesAgeOlderThan55'
MA.Vars$Indicators[MA.Vars$Indicators == 'AgeEmpO55Per_State'] <- 'EmployeesAgeOlderThan55_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'WhiteEmp_State'] <- 'WhiteEmployees'
MA.Vars$Indicators[MA.Vars$Indicators == 'WhiteEmpPer_State'] <- 'WhiteEmployees_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'BlackEmp_State'] <- 'BlackEmployees'
MA.Vars$Indicators[MA.Vars$Indicators == 'BlackEmpPer_State'] <- 'BlackEmployees_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'AsianEmp_State'] <- 'AsianEmployees'
MA.Vars$Indicators[MA.Vars$Indicators == 'AsianEmpPer_State'] <- 'AsianEmployees_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'HispanicEmp_State'] <- 'HispanicEmployees'
MA.Vars$Indicators[MA.Vars$Indicators == 'HispanicEmpPer_State'] <- 'HispanicEmployees_Propotion'
MA.Vars$Indicators[MA.Vars$Indicators == 'TwoOrMoreEmp_State'] <- 'EmployeesWithTwoOrMoreRaces'
MA.Vars$Indicators[MA.Vars$Indicators == 'TwoOrMoreEmpPer_State'] <- 'EmployeesWithTwoOrMoreRaces_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'LessThanHSLabor_State'] <- 'LaborsWithLessThanHighSchoolDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'LessThanHSLaborPer'] <- 'LaborsWithLessThanHighSchoolDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'HSGradLabor_State'] <- 'LaborsWithHighSchoolDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'HSGradLaborPer'] <- 'LaborsWithHighSchoolDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'SomeCollLabor_State'] <- 'LaborsWithCollegeDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'SomeCollLaborPer'] <- 'LaborsWithCollegeDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'BachOrHigherLabor_State'] <- 'LaborsWithBachelorOrHigherDegree'
MA.Vars$Indicators[MA.Vars$Indicators == 'BachOrHigherLaborPer'] <- 'LaborsWithBachelorOrHigherDegree_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'EmpFemale_State'] <- 'FemaleEmployess'
MA.Vars$Indicators[MA.Vars$Indicators == 'EmpFemalePer'] <- 'FemaleEmployess_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'EmpMale_State'] <- 'MaleEmployess'
MA.Vars$Indicators[MA.Vars$Indicators == 'EmpMalePer'] <- 'MaleEmployess_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'TotalEmp_state'] <- 'TotalEmployees'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVBusinessProfitTaxFY19'] <- 'RevenueBusinessProfitTaxFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVBusinessEnterpriseTaxFY19'] <- 'RevenueBusinessEnterpriseTaxFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVMealsRentalsTaxFY19'] <- "RevenueMealsRentalsTaxFY19"
MA.Vars$Indicators[MA.Vars$Indicators == 'REVCigaretteTaxFY19'] <- 'RevenueCigaretteTaxFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVAlcoholTaxFY19'] <- 'RevenueAlcoholTaxFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVInterestTaxFY19'] <- 'RevenueInterestTaxFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVInsuranceFY19'] <- 'RevenueInsuranceFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVCommunicationFY19'] <- 'RevenueCommunicationFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVRealStateFY19'] <- 'RevenueRealStateFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVCourtFY19'] <- 'RevenueCourtFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVSecuritiesFY19'] <- 'RevenueSecuritiesFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVUtilityTaxFY19'] <- 'RevenueUtilityTaxFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVBeerTaxFY19'] <- 'RevenueBeerTaxFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVOtherFY19'] <- 'RevenueOtherFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVLotteryFY19'] <- 'RevenueLotteryFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVRacingGamingFY19'] <- 'RevenueRacingGamingFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVTobaccoSettlementFY19'] <- 'RevenueTobaccoSettlementFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVUtilityPropertyTaxFY19'] <- 'RevenueUtilityPropertyTaxFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'REVMedicaidRecoveriesFY19'] <- 'RevenueMedicaidRecoveriesFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'ExpendituresFY19'] <- 'TotalExpendituresFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'EXGeneralGovernmentFY19'] <- 'ExpendituresGeneralGovernmentFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'EXProtectionFY19'] <- 'ExpendituresProtectionFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'EXResourceProtectFY19'] <- 'ExpendituresResourceProtectFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'EXTransportationFY19'] <- 'ExpendituresTransportationFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'EXHumanServicesFY19'] <- 'ExpendituresHumanServicesFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'EXEducationFY19'] <- 'ExpendituresEducationFY19'
MA.Vars$Indicators[MA.Vars$Indicators == 'SnapRec_State'] <- 'SNAPRecipients '
MA.Vars$Indicators[MA.Vars$Indicators == 'HomeOwnPer_State'] <- 'ProportionOfHomeOwners'
MA.Vars$Indicators[MA.Vars$Indicators == 'RentersPer_State'] <- 'NumberOfRenters_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'RentersToOwners_State'] <- 'ProportionOfRentersToOwners'
MA.Vars$Indicators[MA.Vars$Indicators == 'MedianHValue_State'] <- 'MedianHomeValue'
MA.Vars$Indicators[MA.Vars$Indicators == 'AvgHValue_State'] <- 'AverageHomeValues'
MA.Vars$Indicators[MA.Vars$Indicators == 'MedYrMovedIn_State'] <- 'MedianYearMovedIn'
MA.Vars$Indicators[MA.Vars$Indicators == 'MedYrOwnMovedIn_State'] <- 'MedianYearOwnerMovedIn'
MA.Vars$Indicators[MA.Vars$Indicators == 'MedYrRentMovedIn_State'] <- 'MedianYearRenterMovedIn'
MA.Vars$Indicators[MA.Vars$Indicators == 'CostBurdenedPer'] <- 'CostBurdened_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'CostBurdened_State'] <- 'CostBurdened'
MA.Vars$Indicators[MA.Vars$Indicators == 'Construction_State'] <- 'Construction'
MA.Vars$Indicators[MA.Vars$Indicators == 'Manufacturing_State'] <- 'Manufacturing'
MA.Vars$Indicators[MA.Vars$Indicators == 'Information_State'] <- 'Information'
MA.Vars$Indicators[MA.Vars$Indicators == 'RetailTrade_State'] <- 'RetailTrade'
MA.Vars$Indicators[MA.Vars$Indicators == 'WholesaleTrade_State'] <- 'WholesaleTrade'
MA.Vars$Indicators[MA.Vars$Indicators == 'RetailTrade_State'] <- 'RetailTrade'
MA.Vars$Indicators[MA.Vars$Indicators == 'Female_State'] <- 'Female'
MA.Vars$Indicators[MA.Vars$Indicators == 'Male_State'] <- 'Male'
MA.Vars$Indicators[MA.Vars$Indicators == 'Military_State'] <- 'Military'
MA.Vars$Indicators[MA.Vars$Indicators == 'TotalWorkers_State'] <- 'TotalWorkers'
MA.Vars$Indicators[MA.Vars$Indicators == 'WorkPlacePer_State'] <- 'WorkInPlaceOfResidenc_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'WorkPlace_State'] <- 'WorkInPlaceOfResidenc'
MA.Vars$Indicators[MA.Vars$Indicators == 'WorkStateCountyPer_State'] <- 'WorkInState&CountyOfResidence_Proportion'
MA.Vars$Indicators[MA.Vars$Indicators == 'WorkStateCounty_State'] <- 'WorkInState&CountyOfResidence'
MA.Vars
```


```{r}
StateCities <- merge(Cities.MA, MA.Vars, by="Indicators", all=TRUE)
StateCities
write.csv(StateCities,"~/Desktop/NewHampshireCities.csv", row.names = FALSE)
```





