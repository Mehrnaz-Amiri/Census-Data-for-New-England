---
title: "Municipal Indicators For Pittsfield, MA"
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
  html_notebook:
    toc: yes
    toc_depth: 3
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '3'
---

In this report, 41 demographic, educational institutions, employment, healthcare, municipal finance, infrastructure, food insecurity and housing variables are presented using federally-published data sources for the city of Pittsfield, MA. To better demonstrate their ties to geography of the city, the variables have been mapped on the block group level. \


## Demographic
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
                                 #######################################################
                                 #       Municipal Indicators For Municipalities        #               
                                 #######################################################
library(stringr)
library(tidycensus)
library(tidyverse)
library(tigris)
library(totalcensus)

options(tigris_class = "sf",tigris_use_cache = T)
# Get API key 
# census_api_key("045944708d514a404443c9f2d227ac8bf6a8f8bd", install = TRUE, overwrite=TRUE)
# Specify the end year 
# This is for 5-year estimates
endyr <- 2018
# List of ACS variables
Var_List <- tidycensus::load_variables(year = endyr, dataset = "acs5", cache = T)
# View(Var_List)
```


\


### Population  Size
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

                                             #--------------------#
                                             #    DEMOGRAPHIC     #
                                             #--------------------#

##############################################    Population  Size    ###########################################################
library(tidyverse)
# set_path_to_census("C:\\Users\\ux305\\Desktop\\census")

Pit.pop <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = "B01003_001",
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
				 rename(TotalPop = population,
				        City = NAME) %>% select(City, TotalPop)

Pittsfield.MA <- cbind(Pit.pop)

Pit.MA.Pop <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = "B01003_001",
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")


MA.Pop.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county="Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = "B01003_001", # Total Population
													 keep_geo_vars = T, geometry = TRUE)

Pittsfield <- merge(MA.Pop.get, Pit.MA.Pop, by.x = 'NAME.y', by.y='NAME')


```


The total population of `r Pittsfield.MA$City` is `r Pittsfield.MA$TotalPop`. Followed is the population size map of the city.\
\

```{r , echo=FALSE, warning=FALSE, message=FALSE, comment=""}

## MAP
library(tmap)
tm_shape(Pittsfield) + tm_polygons('B01003_001E' , palette="seq", style = "jenks", title = "Total Population")  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")
```
\


### Population Age
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##############################################    Population  Age   #############################################################
MA.Age <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
				 mutate(AgeU18 = B01001_003+B01001_004+B01001_005+B01001_006+B01001_027+B01001_028+B01001_029+B01001_030, 
				 Age1834 = B01001_007+B01001_008+B01001_009+B01001_010+B01001_011+B01001_012+B01001_036+B01001_035+B01001_034+B01001_033+B01001_032+B01001_031,
				 Age3564 = B01001_013+B01001_014+B01001_015+B01001_016+B01001_017+B01001_018+B01001_019+B01001_043+B01001_042+B01001_041+B01001_040+B01001_039+B01001_038+B01001_037,
				 AgeO65 = B01001_020+B01001_021+B01001_022+B01001_023+B01001_024+B01001_025+B01001_044+B01001_045+B01001_046+B01001_047+B01001_048+B01001_049) %>%
  	mutate(AgeU18Per = AgeU18/population,
				 Age1834Per = Age1834/population,
				 Age3564Per = Age3564/population,
				 AgeO65Per = AgeO65/population) %>%
select(AgeU18,Age1834,Age3564,AgeO65,AgeU18Per,Age1834Per,Age3564Per,AgeO65Per, City) %>%
  left_join(Pittsfield.MA, MA.Age, by="City")

Pittsfield.MA <- cbind(MA.Age)
```
* The number of people, who are younger than 18 Years old is `r Pittsfield.MA$AgeU18` in `r Pittsfield.MA$City` 
, which is `r (round(Pittsfield.MA$AgeU18Per,4))*100`% of total population in `r  Pittsfield.MA$City`. \
* The number of people, who are between 18 and 34 years old is `r Pittsfield.MA$Age1834` in `r Pittsfield.MA$City`, which is `r (round(Pittsfield.MA$Age1834Per,4))*100`% of total population in `r Pittsfield.MA$City`.\
* The number of people, who are between 35 and 64 years old is `r Pittsfield.MA$Age3564` in `r Pittsfield.MA$City`, which is `r (round(Pittsfield.MA$Age3564Per,4))*100`% of total population in `r Pittsfield.MA$City`.\
* The number of people, who are older than 65 years old is `r Pittsfield.MA$AgeO65` in `r Pittsfield.MA$City`, which is `r (round(Pittsfield.MA$AgeO65Per,4))*100`% of total population in `r Pittsfield.MA$City`.\

Followed is the population age map of the city.\
```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## Map

Pit.MA.Age <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.age.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"), # Total Population
													 keep_geo_vars = T, geometry = TRUE) %>%
mutate(AgeU18 = B01001_003E+B01001_004E+B01001_005E+B01001_006E+B01001_027E+B01001_028E+B01001_029E+B01001_030E, 
				 Age1834 = B01001_007E+B01001_008E+B01001_009E+B01001_010E+B01001_011E+B01001_012E+B01001_036E+B01001_035E+B01001_034E+B01001_033E+B01001_032E+B01001_031E,
				 Age3564 = B01001_013E+B01001_014E+B01001_015E+B01001_016E+B01001_017E+B01001_018E+B01001_019E+B01001_043E+B01001_042E+B01001_041E+B01001_040E+B01001_039E+B01001_038E+B01001_037E,
				 AgeO65 = B01001_020E+B01001_021E+B01001_022E+B01001_023E+B01001_024E+B01001_025E+B01001_044E+B01001_045E+B01001_046E+B01001_047E+B01001_048E+B01001_049E)  %>%
  rename(AgeU18_BG = AgeU18,
				 Age1834_BG = Age1834,
				 Age3564_BG = Age3564,
				 AgeO65_BG = AgeO65) %>%
	mutate(AgeU18Per_BG = ((AgeU18_BG/B01003_001E)*100),
				 Age1834Per_BG = ((Age1834_BG/B01003_001E)*100),
				 Age3564Per_BG = ((Age3564_BG/B01003_001E)*100),
				 AgeO65Per_BG = ((AgeO65_BG/B01003_001E)*100))  

Pittsfield.age <- merge(pit.age.get, Pit.MA.Age, by.x = 'NAME.y', by.y='NAME')

make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}
 

tm_shape(Pittsfield.age) + tm_polygons(c('AgeU18Per_BG','Age1834Per_BG',"Age3564Per_BG","AgeO65Per_BG") , palette=list("Oranges", "Greens", "Blues", "Purples") ,style = "quantile", title = c('AgeU18','Age1834',"Age3564","AgeO65"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) 

```


### Median Household Income
\

```{r  echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#################################################    Median Household Income    ##############################################################

MA.MHI <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = "B19013_001",
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
				 rename(MedHouseIncome = B19013_001,
				        City = NAME) %>% 
	select(City, MedHouseIncome) %>%
  left_join(Pittsfield.MA, MA.MHI, by="City")
Pittsfield.MA <- cbind(MA.MHI)
```
* The median household income in the past 12 months is 48555 Dollar in `r Pittsfield.MA$City`.\
Followed is the Median Household Income map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## MAP
Pit.MA.income <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = "B19013_001",
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.income.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = "B19013_001", 
													 keep_geo_vars = T, geometry = TRUE) 

Pittsfield.income <- merge(pit.income.get, Pit.MA.income, by.x = 'NAME.y', by.y='NAME')

make_dollar <- function(x, digits = 0) {
  paste0("$", formatC(x, digits = digits, format = "f", big.mark = ","))
}

library(tmap)
tm_shape(Pittsfield.income) + tm_polygons('B19013_001E' , palette="seq", style="jenks", title = "Median Household Income", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar))  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) 
```

\

### Racial Breakdown 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##############################################      Racial Breakdown     ###################################################################
MA.Race <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
				 rename(White = B03002_003,
				 Black = B03002_004,
				 Asian = B03002_006,
				 Hispanic = B03002_012,
				 TwoOrMore = B03002_009,
				 City = NAME) %>% 
  mutate(WhitePer = (White/population),
         BlackPer = (Black/population),
         AsianPer = (Asian/population),
         HispanicPer = (Hispanic/population),
         TwoOrMorePer = (TwoOrMore/population)) %>%
	select(City, White, Black, Asian, Hispanic, TwoOrMore,
	       WhitePer, BlackPer, AsianPer, HispanicPer, TwoOrMorePer) %>%
  left_join(Pittsfield.MA, MA.Race, by="City")
Pittsfield.MA <- cbind(MA.Race)

```
* The number of people who are white in `r Pittsfield.MA$City` is `r Pittsfield.MA$White` which is `r (round(Pittsfield.MA$WhitePer,4))*100`% of total population in `r Pittsfield.MA$City`.\
* The number of people who are black in `r Pittsfield.MA$City` is `r Pittsfield.MA$Black` which is `r (round(Pittsfield.MA$BlackPer,4))*100`% of total population in `r Pittsfield.MA$City`.\
* The number of people who are asian in `r Pittsfield.MA$City` is `r Pittsfield.MA$Asian` which is `r (round(Pittsfield.MA$AsianPer,4))*100`% of total population in `r Pittsfield.MA$City`.\
* The number of people who are hispanic in `r Pittsfield.MA$City` is `r Pittsfield.MA$Hispanic` which is `r (round(Pittsfield.MA$HispanicPer,4))*100`% of total population in `r Pittsfield.MA$City`.\
* The number of people who are have two or more races in `r Pittsfield.MA$City` is `r Pittsfield.MA$TwoOrMore` which is `r (round(Pittsfield.MA$TwoOrMorePer,4))*100`% of total population in `r Pittsfield.MA$City`. \
Followed is the Racial Breakdown map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## Map
Pit.MA.race <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009",
																					"B01003_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.race.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009",
																					"B01003_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(White_BG = B03002_003E,
				 Black_BG = B03002_004E,
				 Asian_BG = B03002_006E,
				 Hispanic_BG = B03002_012E,
				 TwoOrMore_BG = B03002_009E) %>%
  mutate(WhitePer_BG = (White_BG/B01003_001E)*100,
         BlackPer_BG = (Black_BG/B01003_001E)*100,
         AsianPer_BG = (Asian_BG/B01003_001E)*100,
         HispanicPer_BG = (Hispanic_BG/B01003_001E)*100,
         TwoOrMorePer_BG = (TwoOrMore_BG/B01003_001E)*100) 

Pittsfield.race <- merge(pit.race.get, Pit.MA.race, by.x = 'NAME.y', by.y='NAME')


make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}
 
library(tmap)
tm_shape(Pittsfield.race) + tm_polygons(c("WhitePer_BG", "BlackPer_BG", "AsianPer_BG", "HispanicPer_BG", "TwoOrMorePer_BG") , palette=list("Oranges", "Greens", "Blues", "Purples", "Reds"), style = "quantile", title = c("White", "Black", "Asian","Hispanic", "TwoOrMore"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) 

```

\

### Gender Breakdown
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#####################################################    Gender Breakdown    #############################################################

MA.Sex <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B01001_026",
													               "B01001_002"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  mutate(SexRatio = B01001_026/B01001_002) %>%
  rename(Female = B01001_026,
				 Male = B01001_002,
				 City = NAME) %>%
  mutate(FemalePer = Female/population,
				 MalePer = Male/population) %>% 
	select(City, SexRatio, Female, Male, FemalePer, MalePer) %>%
  left_join(Pittsfield.MA, MA.Sex, by="City")

Pittsfield.MA <- cbind(MA.Sex)

```
* The number of females in `r Pittsfield.MA$City` is `r Pittsfield.MA$Female` which is `r 100*(round(Pittsfield.MA$FemalePer,2))`% of total population in `r Pittsfield.MA$City`.\
* The number of males in `r Pittsfield.MA$City` is `r Pittsfield.MA$Male` which is `r 100*(round(Pittsfield.MA$MalePer,2))`% of total population in `r Pittsfield.MA$City`.\
* The ratio of number of females to males in `r Pittsfield.MA$City` is `r Pittsfield.MA$SexRatio`.\
Followed is the Gender Breakdown map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
Pit.MA.sex <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B01001_026",
													               "B01001_002",
													               "B01003_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.sex.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B01001_026",
													               "B01001_002",
													               "B01003_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
mutate(SexRatio = B01001_026E/B01001_002E) %>%
  rename(Female = B01001_026E,
				 Male = B01001_002E) %>%
  mutate(FemalePer = (Female/B01003_001E)*100,
         MalePer = (Male/B01003_001E)*100)

Pittsfield.sex <- merge(pit.sex.get, Pit.MA.sex, by.x = 'NAME.y', by.y='NAME')

library(tmap)
tm_shape(Pittsfield.sex) + tm_polygons(c('Female', 'Male'), palette=list("Purples", "Reds"), title = c("Female","Male"))  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")+ tmap_options(show.messages = FALSE) 

make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}
tm_shape(Pittsfield.sex) + tm_polygons(c('FemalePer', 'MalePer'), palette=list("Blues", "Oranges"), title = c("FemalePercentage","MalePercentage"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent)) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")+ tmap_options(show.messages = FALSE) 

```


\


### Average Household Size
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#################################################    Average Household Size    ############################################################

MA.AveHH.Size <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B11002_001", 
															         "B19001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(AveHouseH = B11002_001/B19001_001) %>%
	select(City, AveHouseH) %>%
  left_join(Pittsfield.MA, MA.AveHH.Size, by="City")

Pittsfield.MA <- cbind(MA.AveHH.Size)

```
* The average household size is `r round(Pittsfield.MA$AveHouseH,2)` in `r Pittsfield.MA$City`.\
Followed is the Average Household Size map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

Pit.MA.HH.Size <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B11002_001", # Household type by relatives and nonrelatives for population in households
															              "B19001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.HH.Size.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B11002_001", # Household type by relatives and nonrelatives for population in households
															              "B19001_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
  mutate(AveHouseH = B11002_001E/B19001_001E) 

Pittsfield.HH.Size <- merge(pit.HH.Size.get, Pit.MA.HH.Size, by.x = 'NAME.y', by.y='NAME')


tm_shape(Pittsfield.HH.Size) + tm_polygons("AveHouseH", style = "jenks", palette="Purples", border.col = "darkgray", title="Ave Household Size") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite") + tmap_options(show.messages = FALSE)

```

\

### Educational Attainment
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################   Educational Attainment    ##################################################################
MA.Educ <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(LessThanHS = (B15002_003+B15002_004+B15002_005+B15002_006+B15002_007+B15002_008+B15002_009+B15002_010+B15002_020+B15002_021+B15002_022+B15002_023+B15002_024+B15002_025+B15002_026+B15002_027),
				 HSGrad = (B15002_011 + B15002_028),
				 SomeColl = (B15002_012+ B15002_013 + B15002_014 + B15002_029 + B15002_030 + B15002_031),
				 Bach = (B15002_015 + B15002_032),
				 Master = (B15002_016 + B15002_033),
				 Prof = (B15002_017 + B15002_034),
				 Doc = (B15002_018 + B15002_035),
				 LessThanHSPer = (LessThanHS/population),
         HSGradPer = (HSGrad/population),
         SomeCollPer = (SomeColl/population),
         BachPer = (Bach/population),
         MasterPer = (Master/population),
         ProfPer = (Prof/population),            
         DocPer = (Doc/population)) %>%
	select(City, LessThanHS, HSGrad, SomeColl, Bach, Master, Prof, Doc,
	       LessThanHSPer, HSGradPer, SomeCollPer, BachPer, MasterPer, ProfPer, DocPer) %>% 
  left_join(Pittsfield.MA, MA.Educ, by="City") 

Pittsfield.MA <- cbind(MA.Educ)
```
* The number of people, who have less than high school degree is `r  Pittsfield.MA$LessThanHS` in `r Pittsfield.MA$City` which is `r (round(Pittsfield.MA$LessThanHSPer,4))*100`% of the population who are 25 years old or older in `r Pittsfield.MA$City`.\
* The number of people, who have high school degree is `r  Pittsfield.MA$HSGrad` in `r Pittsfield.MA$City` which is `r (round(Pittsfield.MA$HSGradPer,4))*100`% of the population who are 25 years old or older in `r Pittsfield.MA$City`.\
* The number of people, who have some college degree is `r  Pittsfield.MA$SomeColl` in `r Pittsfield.MA$City` which is `r (round(Pittsfield.MA$SomeCollPer,4))*100`% of the population who are 25 years old or older in `r Pittsfield.MA$City`.\
* The number of people, who have bachelor degree is `r Pittsfield.MA$Bach` in `r Pittsfield.MA$City` which is `r (round(Pittsfield.MA$BachPer,4))*100`% of the population who are 25 years old or older in `r Pittsfield.MA$City`.\
* The number of people, who have master's degree is `r Pittsfield.MA$Master` in `r Pittsfield.MA$City` which is `r (round(Pittsfield.MA$MasterPer,4))*100`% of the population who are 25 years old or older in `r Pittsfield.MA$City`.\
* The number of people, who have professional school degree is `r  Pittsfield.MA$Prof` in `r Pittsfield.MA$City` which is `r (round(Pittsfield.MA$ProfPer,4))*100`% of the population who are 25 years old or older in `r Pittsfield.MA$City`.\
* The number of people, who have doctorate degree is `r  Pittsfield.MA$Doc` in `r Pittsfield.MA$City` which is `r (round(Pittsfield.MA$DocPer,4))*100`% of the population who are 25 years old or older in `r Pittsfield.MA$City`.\
Followed is the Educational Attainment map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
Pit.MA.Educ <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.Educ.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(LessThanHS_BG = (B15002_003E+B15002_004E+B15002_005E+B15002_006E+B15002_007E+B15002_008E+B15002_009E+B15002_010E+B15002_020E+B15002_021E+B15002_022E+B15002_023E+B15002_024E+B15002_025E+B15002_026E+B15002_027E),
				 HSGrad_BG = (B15002_011E + B15002_028E),
				 SomeColl_BG = (B15002_012E + B15002_013E + B15002_014E + B15002_029E + B15002_030E + B15002_031E),
				 Bach_BG = (B15002_015E + B15002_032E),
				 Master_BG = (B15002_016E + B15002_033E),
				 Prof_BG = (B15002_017E + B15002_034E),
				 Doc_BG = (B15002_018E + B15002_035E),
		    LessThanHSPer_BG = ((B15002_003E+B15002_004E+B15002_005E+B15002_006E+B15002_007E+B15002_008E+B15002_009E+B15002_010E+B15002_020E+B15002_021E+B15002_022E+B15002_023E+B15002_024E+B15002_025E+B15002_026E+B15002_027E)/B15002_001E)*100,
				 HSGradPer_BG = ((B15002_011E + B15002_028E)/B15002_001E)*100,
				 SomeCollPer_BG = ((B15002_012E + B15002_013E + B15002_014E + B15002_029E + B15002_030E + B15002_031E)/B15002_001E)*100,
				 BachPer_BG = ((B15002_015E + B15002_032E)/B15002_001E)*100,
				 MasterPer_BG = ((B15002_016E + B15002_033E)/B15002_001E)*100,
				 ProfPer_BG = ((B15002_017E + B15002_034E)/B15002_001E)*100,
				 DocPer_BG = ((B15002_018E + B15002_035E)/B15002_001E)*100)

Pittsfield.Educ <- merge(pit.Educ.get, Pit.MA.Educ, by.x = 'NAME.y', by.y='NAME')

make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}

tm_shape(Pittsfield.Educ) +
    tm_fill(c('LessThanHSPer_BG', 'HSGradPer_BG', 'SomeCollPer_BG', 'BachPer_BG', 'MasterPer_BG', 'ProfPer_BG', 'DocPer_BG'),
        style="quantile", 
        palette=list("Oranges", "Greens", "Blues", "Purples", "Reds","Dark2", "seq"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent), title=c('LessThanHS', 'HSGrad', 'SomeColl', 'Bach', 'Master', 'Prof', 'Doc')) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") + tmap_options(limits = c(facets.view = 7))

```

\

### Single Parent Households
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

##########################################      Single Parent Households     ##################################################################
MA.Single <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(FemHeadPer = B11001_006/B11001_001,
	       MaleHeadPer = B11001_005/B11001_001) %>%
	select(City, FemHeadPer, MaleHeadPer) %>%
  left_join(Pittsfield.MA, MA.Single, by="City")

Pittsfield.MA <- cbind(MA.Single)
```
* The percentage of single-female-headed is `r (round(Pittsfield.MA$FemHeadPer,4))*100`% of total number of family households in `r Pittsfield.MA$City`.\
* The percentage of single-male-headed is `r (round(Pittsfield.MA$MaleHeadPer,4))*100`% of total number of family households in `r Pittsfield.MA$City`.\
Followed is the Single Parent Households map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
Pit.MA.single <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.single.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
mutate(FemHeadPer = (B11001_006E/B11001_001E)*100,
	       MaleHeadPer = (B11001_005E/B11001_001E)*100)

Pittsfield.single <- merge(pit.single.get, Pit.MA.single, by.x = 'NAME.y', by.y='NAME')


make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}


tm_shape(Pittsfield.single) + tm_polygons(c("FemHeadPer", "MaleHeadPer"), style="quantile", palette=list("Oranges", "Purples"),popup.format = list(fun = make_percent), legend.format = list(fun = make_percent), border.col = "darkgray", title=c("Female Householder", "Male Householder")) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite") + tmap_options(show.messages = FALSE) 

```


\


### Population in Poverty
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
###########################################      Population in Poverty    ######################################################################

MA.PopPov <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  	mutate(FamPovPer = B17010_002/B17010_001,
	       PopPovPer = B17001_002/B17001_001,
	       TotalPopPov = B17001_002) %>%
	select(City, FamPovPer, PopPovPer, TotalPopPov) %>%
  left_join(Pittsfield.MA,MA.PopPov, by="City")

Pittsfield.MA <- cbind(MA.PopPov )

```
* The percentage of family, who are in poverty is `r (round(Pittsfield.MA$FamPovPer,4))*100` % in `r Pittsfield.MA$City`.\
* The percentage of population, who are in poverty is `r (round(Pittsfield.MA$PopPovPer,4))*100` % in `r Pittsfield.MA$City`.\
* The total number of people, who are in poverty is `r Pittsfield.MA$TotalPopPov` in `r Pittsfield.MA$City`.\
Followed is the Population in Poverty map of the city.\
```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

Pit.MA.pov <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.pov.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(FamPovPer_BG = (B17010_002E/B17010_001E)*100,
	       PopPovPer_BG = (B17001_002E/B17001_001E)*100,
	       TotalPopPov_BG = B17001_002E) 

Pittsfield.pov <- merge(pit.pov.get, Pit.MA.pov, by.x = 'NAME.y', by.y='NAME')


make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}

tm_shape(Pittsfield.pov) + tm_polygons("FamPovPer_BG", style="quantile", palette="Purples", border.col = "darkgray", title="Family in Poverty",popup.format = list(fun = make_percent), legend.format = list(fun = make_percent)) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")


```

\


### Elderly People Living Alone
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

########################################     Elderly People Living Alone    ##############################################################
MA.old <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B11010_005", # Male householder, Living alone, 65 years and over
																					"B11010_012", # Female householder, Living alone, 65 years and over
																					"B11010_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(OldAlonePer = (B11010_012 + B11010_005)/B11010_001) %>%
	select(City, OldAlonePer) %>%
  left_join(Pittsfield.MA,MA.old, by="City")

Pittsfield.MA <- cbind(MA.old) 

## GIVE US NA
```
* The percentage of householders, who are living alone and are older than 65 years old is `r (round(Pittsfield.MA$OldAlonePer,4))*100` % in `r Pittsfield.MA$City`.\

\

## Educational Institutions
\

\

### Number/Type of Schools
\

* `r Pittsfield.MA$City` has 1 public school district, which contains 5,879 students and 12 public schools. Also, `r Pittsfield.MA$City` has 5 private schools.(https://nces.ed.gov/)

\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Pittsfield.MA$SchoolsDistrict <- 1
Pittsfield.MA$SchoolsDistStudents <- 5879
Pittsfield.MA$PubSchools <- 12
Pittsfield.MA$PvSchools <- 5
```


\


### Number/Type of Universities
\

* `r Pittsfield.MA$City` has 2 universities in 01201 ZIP Code.(https://nces.ed.gov/)

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Pittsfield.MA$NumUni <- 2
```


\

###	Employment Numbers per Institution
\


* Berkshire Community College is located in `r Pittsfield.MA$City`, which contains 52 full time and 81 part time faculties. Also, Mildred Elley-Pittsfield Campus is located in `r Pittsfield.MA$City`, which includes 7 full time and 22 part time faculties.\
* Pittsfield School District in `r Pittsfield.MA$City`contains 482 teachers and 421 other staffs. The total number of teachers in all private schools in `r Pittsfield.MA$City` is 70.(http://www.usa.com/)


\

### Number of PK-12 Enrollment in Schools
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
############################################################################################################################

                                             # ----------------------------- #
                                             #    Educational Institutions   #
                                             #-------------------------------#

# Number of PK-12 Enrollment at block group level
MA.Enrol <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B14001_003", # Enrolled in preschool
																					"B14001_004", # Enrolled in kindergarten
																					"B14001_005", # Enrolled in grade 1 to 4
																					"B14001_006", # Enrolled in grade 5 to 8
																					"B14001_007"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(EnrolPK12 = B14001_003 + B14001_004 + B14001_005 + B14001_006 + B14001_007) %>%
	select(City, EnrolPK12) %>%
  left_join(Pittsfield.MA, MA.Enrol, by="City")

Pittsfield.MA <- cbind(MA.Enrol)

```
* The total number of students, who enrolled in preschools to 12 grade levels in `r Pittsfield.MA$City` schools is`r Pittsfield.MA$EnrolPK12`.\

\


## Employment
\


### Number of Jobs within Community Boundaries
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

########################################################################################################################################

                                                #----------------------#
                                                #       EMPLOYMENT     #
                                                #----------------------#

##########################################    Number of Jobs within Community Boundaries   #############################################
MA.Num.Jobs <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = "B08008_003",
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME,
         NumJobs = B08008_003) %>% 
	select(City, NumJobs) %>%
  left_join(Pittsfield.MA, MA.Num.Jobs, by="City")

Pittsfield.MA <- cbind(MA.Num.Jobs)

```
* The number of jobs within community boundaries in `r Pittsfield.MA$City` is `r Pittsfield.MA$NumJobs`.\

Followed is the map of Number of Jobs within Community Boundaries of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}

## MAP

Pit.MA.job <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = "B08008_003",
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.job.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = 'B08008_003', 
													 keep_geo_vars = T, geometry = TRUE) %>%
	rename(NumJobs = B08008_003E) 

Pittsfield.job <- merge(pit.job.get, Pit.MA.job, by.x = 'NAME.y', by.y='NAME')


tm_shape(Pittsfield.job) + tm_polygons("NumJobs", style="jenks", palette="Reds", border.col = "darkgray", title="Number of Jobs") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")
```

\


### Labor Force (Total number, participation)
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
############################################# Labor Force (Total number, participation)  ####################################

MA.Labors <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(LabForce = B23025_002,
	       LabForcePer = B23025_002/B23025_001,
	       CivLabForce = B23025_003,
	       CivLabForcePer = B23025_003/B23025_001,
	       Military = B23025_006,
	       MilitaryPer = 	B23025_006/B23025_001,
	       TotalWorkers = B23025_001) %>%
	select(City, LabForce, LabForcePer, CivLabForce, CivLabForcePer, Military, MilitaryPer, TotalWorkers)  %>%
  left_join(Pittsfield.MA, MA.Labors, by="City")

Pittsfield.MA <- cbind(MA.Labors)
```

* The number of labor force, who are 16 years and older in `r Pittsfield.MA$City` is 23400 which is `r round(Pittsfield.MA$LabForcePer,2)` of total number of labors of which 23400 are civilian labor forces and `r Pittsfield.MA$Military` are armed labor forces.\



Followed is the map of Labor Force of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

Pit.MA.labors <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.labors.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(LabForce = B23025_002E,
	       LabForcePer = B23025_002E/B23025_001E,
	       CivLabForce = B23025_003E,
	       CivLabForcePer = B23025_003E/B23025_001E,
	       Military = B23025_006E,
	       MilitaryPer = 	B23025_006E/B23025_001E,
	       TotalWorkers = B23025_001E) 

Pittsfield.labors <- merge(pit.labors.get, Pit.MA.labors, by.x = 'NAME.y', by.y='NAME')


tm_shape(Pittsfield.labors) + tm_polygons("LabForce", style="jenks", palette="seq", border.col = "darkgray", title="Number of Labors") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")
```

\

### Employed and Unemployed
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#####################################################    Employed and Unemployed   ####################################

MA.Emp.Unemp <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(EmpRate = B23025_004/B23025_003,
	       UnempRate = B23025_005/B23025_003,
	       EmployedCLF = B23025_004,
	       UnemployedCLF = B23025_005) %>%
	select(City ,EmpRate, UnempRate, EmployedCLF, UnemployedCLF) %>%
  left_join(Pittsfield.MA, MA.Emp.Unemp, by="City")

Pittsfield.MA <- cbind(MA.Emp.Unemp)

```
* The rate of employment in `r Pittsfield.MA$City` is `r round(Pittsfield.MA$EmpRate,2)*100`%.\
* The rate of unemployment in `r Pittsfield.MA$City` is `r round(Pittsfield.MA$UnempRate,2)*100`%.\

Followed is Employed and Unemployed map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
Pit.MA.emp <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.emp.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(EmpRate_BG = B23025_004E/B23025_003E,
	       UnempRate_BG = B23025_005E/B23025_003E,
	       EmployedCLF_BG = B23025_004E,
	       UnemployedCLF_BG = B23025_005E) 

Pittsfield.emp <- merge(pit.emp.get, Pit.MA.emp, by.x = 'NAME.y', by.y='NAME')

tm_shape(Pittsfield.emp) + tm_polygons(c("EmpRate_BG","UnempRate_BG"), style="jenks", palette=list("Greens","seq"), border.col = "darkgray", title=c("Employment rate","Unemployment rate")) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")

```

\


### Major Employers by NCAIS Code
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

################################    Major Employers by NCAIS Code    ##########################################
MA.Emp.NCAIS <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(MaleNCAIS = C24030_002,
	       FemaleNCAIS = C24030_029,
	       MaleNCAISPer = C24030_002/C24030_001,
	       FemaleNCAISPer = C24030_029/C24030_001) %>%
	select(City , MaleNCAIS, FemaleNCAIS, MaleNCAISPer, FemaleNCAISPer) %>%
  left_join(Pittsfield.MA, MA.Emp.NCAIS, by="City")

Pittsfield.MA <- cbind(MA.Emp.NCAIS)

```
* Number of male by industry for the civilian employed in `r Pittsfield.MA$City` is `r Pittsfield.MA$MaleNCAIS` which is `r round(Pittsfield.MA$MaleNCAISPer,2)` of population, who are 16 years and over.\
* Number of female by industry for the civilian employed in `r Pittsfield.MA$City` is `r Pittsfield.MA$FemaleNCAIS` which is `r round(Pittsfield.MA$FemaleNCAISPer,2)` of population, who are 16 years and over.\

Followed is the map of the Major Employers by NCAIS Code of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
Pit.MA.majorEmp <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.majorEmp.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(MaleNCAIS_BG = C24030_002E,
	       FemaleNCAIS_BG = C24030_029E,
	       MaleNCAISPer_BG = C24030_002E/C24030_001E,
	       FemaleNCAISPer_BG = C24030_029E/C24030_001E) 

Pittsfield.majorEmp <- merge(pit.majorEmp.get, Pit.MA.majorEmp, by.x = 'NAME.y', by.y='NAME')


tm_shape(Pittsfield.majorEmp) + tm_polygons(c("MaleNCAISPer_BG","FemaleNCAISPer_BG"), style="jenks", palette=list("Greens","seq"), border.col = "darkgray", title=c("MaleNCAIS Per","FemaleNCAIS Per")) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")

tm_shape(Pittsfield.majorEmp) + tm_polygons(c("MaleNCAIS_BG","FemaleNCAIS_BG"), style="jenks", palette=list("Greens","seq"), border.col = "darkgray", title=c("MaleNCAIS","FemaleNCAIS")) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")

```

\


### Top Industries by NCAIS Code
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
######################################    Top Industries by NCAIS Code   ##################################################

MA.Industries <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("C24030_003", # Agriculture, forestry, fishing and hunting, and mining (Male)
														              "C24030_030", # Agriculture, forestry, fishing and hunting, and mining (Female)
														              "C24030_006", # Construction (Male)
														              "C24030_033", # Construction (Female)
														              "C24030_007", # Manufacturing (Male)
														              "C24030_034", # Manufacturing (Female)
														              "C24030_008", # Wholesale trade (Male)
														              "C24030_035", # Wholesale trade (Female)
														              "C24030_009", # Retail trade (Male)
														              "C24030_036", # Retail trade (Female)
														              "C24030_010", # Transportation and warehousing, and utilities (Male)
														              "C24030_037", # Transportation and warehousing, and utilities (Female)
														              "C24030_013", # Information (Male)
														              "C24030_040", # Information (Female)
														              "C24030_014", # Finance and insurance, and real estate, and rental and leasing (Male)
														              "C24030_041", # Finance and insurance, and real estate, and rental and leasing (Female)
														              "C24030_017", # Professional, scientific, and management, and administrative, and waste management services (Male)
														              "C24030_044", # Professional, scientific, and management, and administrative, and waste management services (Female)
														              "C24030_021", # Educational services, and health care and social assistance (Male)
														              "C24030_048", # Educational services, and health care and social assistance (Female)
														              "C24030_024", # Arts, entertainment, and recreation, and accommodation and food services (Male)
														              "C24030_051", # Arts, entertainment, and recreation, and accommodation and food services (Female)
														              "C24030_027", # Other services, except public administration (Male)
														              "C24030_054", # Other services, except public administration (Female)
														              "C24030_028", # Public administration (Male)
														              "C24030_055", # Public administration (Female)
														              "C24030_001"), # Total,
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(Agriculture = (C24030_003 + C24030_030)/C24030_001,
	       Construction = (C24030_006 + C24030_033)/C24030_001,
	       Manufacturing = (C24030_007 + C24030_034)/C24030_001,
	       WholesaleTrade = (C24030_008 + C24030_035)/C24030_001,
	       RetailTrade = (C24030_009 + C24030_036)/C24030_001,
	       Transportation = (C24030_010 + C24030_037)/C24030_001,
	       Information = (C24030_013 + C24030_040)/C24030_001,
	       Finance_Ins = (C24030_014 + C24030_041)/C24030_001,
	       Professional = (C24030_017 + C24030_044)/C24030_001,
	       Educ_Health_SocSvcs = (C24030_021 + C24030_048)/C24030_001,
	       RecreationEtc = (C24030_024 + C24030_051)/C24030_001,
	       OtherIndustries = (C24030_027 + C24030_054)/C24030_001,
	       PublicAdmin = (C24030_028 + C24030_055)/C24030_001) %>%
	select(City,Agriculture,Construction,Manufacturing,WholesaleTrade,RetailTrade,Transportation,Information,
	       Finance_Ins,Professional,Educ_Health_SocSvcs,RecreationEtc,OtherIndustries,PublicAdmin) %>%
  left_join(Pittsfield.MA, MA.Industries, by="City")

Pittsfield.MA <- cbind(MA.Industries)

```
* The percentage of people, who are in agriculture, forestry, fishing, hunting, and mining in `r Pittsfield.MA$City` is `r (round(Pittsfield.MA$Agriculture,4))*100`%.\

* The percentage of people, who are in construction in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$Construction,4))*100`%".\

* The percentage of people, who are in manufacturing in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$Manufacturing,4))*100`%.\

* The percentage of people, who are in wholesale trade in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$WholesaleTrade,4))*100`%.\

* The percentage of people, who are in retail trade in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$RetailTrade,4))*100`%.\

* The percentage of people, who are in transportation and warehousing, and utilities in`r Pittsfield.MA$City`state is`r (round(Pittsfield.MA$Transportation,4))*100`%.\

* The percentage of people, who are in information in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$Information,4))*100`%.\

* The percentage of people, who are in finance and insurance, and real estate, and rental and leasing in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$Finance_Ins,4))*100`%.\

* The percentage of people, who are in professional, scientific, and management, and administrative, and waste management services in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$Professional,4))*100`%.\

* The percentage of people, who are in educational services, and health care and social assistance in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$Educ_Health_SocSvcs,4))*100`%.\

* The percentage of people, who are in arts, entertainment, and recreation, and accommodation and food services in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$RecreationEtc,4))*100`%.\

* The percentage of people, who are in other services, except public administration in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$OtherIndustries,4))*100`%.\

* The percentage of people, who are in Public administration in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$PublicAdmin,4))*100`%.\
\

### Earning Breakdown 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
###########################    Earning Breakdown   ####################################
MA.Earning <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = "B20017_001",
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(MedEarning = B20017_001) %>%
	select(City,MedEarning) %>%
  left_join(Pittsfield.MA, MA.Earning, by="City")

Pittsfield.MA <- cbind(MA.Earning)
```
* The median earning in `r Pittsfield.MA$City` is 31756 Dollar.\
Followed is the Median Earning map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
Pit.MA.earning <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = "B20017_001",
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.earning.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = 'B20017_001', 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(MedEarning = B20017_001E)

Pittsfield.earning <- merge(pit.earning.get, Pit.MA.earning, by.x = 'NAME.y', by.y='NAME')

make_dollar <- function(x, digits = 0) {
  paste0("$", formatC(x, digits = digits, format = "f", big.mark = ","))
}


tm_shape(Pittsfield.earning) + tm_polygons("MedEarning" , palette="seq", style = "jenks", title = "Median Earning", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") 


```

\


### Employee Age
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################    Employee Age   #############################################################

MA.Emp.Age <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B23001_005","B23001_007","B23001_012","B23001_014","B23001_019","B23001_021","B23001_026","B23001_028", # Age 29 or younger male
								"B23001_033","B23001_035","B23001_040","B23001_042","B23001_047","B23001_049", # Age 30 to 54 male
								"B23001_054","B23001_056","B23001_061","B23001_063","B23001_068","B23001_070","B23001_075","B23001_080","B23001_085", # Age 55 or older male
								"B23001_091","B23001_093","B23001_098","B23001_100","B23001_105","B23001_107","B23001_112","B23001_114", # Age 29 or younger female
								"B23001_119","B23001_121","B23001_126","B23001_128","B23001_133","B23001_135", # Age 30 to 54 female
								"B23001_140","B23001_142","B23001_147","B23001_149","B23001_154","B23001_156","B23001_161","B23001_166","B23001_171", # Age 55 or older female
														              "B23001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(AgeEmpU29 = B23001_005+B23001_007+B23001_012+B23001_014+B23001_019+B23001_021+B23001_026+B23001_028+
	         B23001_091+B23001_093+B23001_098+B23001_100+B23001_105+B23001_107+B23001_112+B23001_114,
	       AgeEmp3054 = B23001_033+B23001_035+B23001_040+B23001_042+B23001_047+B23001_049+
	         B23001_119+B23001_121+B23001_126+B23001_128+B23001_133+B23001_135,
	       AgeEmpO55 = B23001_054+B23001_056+B23001_061+B23001_063+B23001_068+B23001_070+B23001_075+B23001_080+B23001_085+
	        B23001_140+B23001_142+B23001_147+B23001_149+B23001_154+B23001_156+B23001_161+B23001_166+B23001_171,
         
         AgeEmpU29Per_BG = (B23001_005+B23001_007+B23001_012+B23001_014+B23001_019+B23001_021+B23001_026+B23001_028+
	         B23001_091+B23001_093+B23001_098+B23001_100+B23001_105+B23001_107+B23001_112+B23001_114)/B23001_001,
	        AgeEmp3054Per_BG = (B23001_033+B23001_035+B23001_040+B23001_042+B23001_047+B23001_049+
	         B23001_119+B23001_121+B23001_126+B23001_128+B23001_133+B23001_135)/B23001_001,
	       AgeEmpO55Per_BG = (B23001_054+B23001_056+B23001_061+B23001_063+B23001_068+B23001_070+B23001_075+B23001_080+B23001_085+
	        B23001_140+B23001_142+B23001_147+B23001_149+B23001_154+B23001_156+B23001_161+B23001_166+B23001_171)/B23001_001) %>%

	select(City ,AgeEmpU29, AgeEmp3054, AgeEmpO55, AgeEmpU29Per_BG,AgeEmp3054Per_BG,AgeEmpO55Per_BG) %>%
  left_join(Pittsfield.MA, MA.Emp.Age, by="City")

Pittsfield.MA <- cbind(MA.Emp.Age)

```
* The number of workers, who are younger than 29 years old in `r Pittsfield.MA$City` is `r Pittsfield.MA$AgeEmpU29` which is `r (round(Pittsfield.MA$AgeEmpU29Per,4))*100`% of total number of workers.\

* The number of workers, who are between 30 and 54 years old in `r Pittsfield.MA$City` is `r Pittsfield.MA$AgeEmp3054` which is `r (round(Pittsfield.MA$AgeEmp3054Per,4))*100`% of total number of workers.\

* The number of workers, who are older than 55 years old in `r Pittsfield.MA$City` is `r Pittsfield.MA$AgeEmpO55` which is `r (round(Pittsfield.MA$AgeEmpO55Per,4))*100`% of total number of workers.\

\


### Employee Race
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################      Employee Race    ############################################################
MA.Emp.Race <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("C23002A_007","C23002A_012","C23002A_020","C23002A_025","C23002A_005","C23002A_018", # White alone
														              "C23002B_007","C23002B_012","C23002B_020","C23002B_025","C23002B_005","C23002B_018", # Black or African American alone
														              "C23002D_007","C23002D_012","C23002D_020","C23002D_025","C23002D_005","C23002D_018", # Asian alone
														              "C23002I_007","C23002I_012","C23002I_020","C23002I_025","C23002I_005","C23002I_018", # Hispanic or Latino alone
														              "C23002G_007","C23002G_012","C23002G_020","C23002G_025","C23002G_005","C23002G_018",# Two or more races
														              "B23001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(WhiteEmp = C23002A_007+C23002A_012+C23002A_020+C23002A_025+C23002A_005+C23002A_018,
	       BlackEmp = C23002B_007+C23002B_012+C23002B_020+C23002B_025+C23002B_005+C23002B_018,
	       AsianEmp = C23002D_007+C23002D_012+C23002D_020+C23002D_025+C23002D_005+C23002D_018,
	       HispanicEmp = C23002I_007+C23002I_012+C23002I_020+C23002I_025+C23002I_005+C23002I_018,
	       TwoOrMoreEmp = C23002G_007+C23002G_012+C23002G_020+C23002G_025+C23002G_005+C23002G_018,
         WhiteEmpPer = (C23002A_007+C23002A_012+C23002A_020+C23002A_025+C23002A_005+C23002A_018)/B23001_001,
	       BlackEmpPer = (C23002B_007+C23002B_012+C23002B_020+C23002B_025+C23002B_005+C23002B_018)/B23001_001,
	       AsianEmpPer = (C23002D_007+C23002D_012+C23002D_020+C23002D_025+C23002D_005+C23002D_018)/B23001_001,
	       HispanicEmpPer = (C23002I_007+C23002I_012+C23002I_020+C23002I_025+C23002I_005+C23002I_018)/B23001_001,
	       TwoOrMoreEmpPer = (C23002G_007+C23002G_012+C23002G_020+C23002G_025+C23002G_005+C23002G_018)/B23001_001) %>%
	select(City ,WhiteEmp, BlackEmp, AsianEmp, HispanicEmp, TwoOrMoreEmp,
	       WhiteEmpPer, BlackEmpPer, AsianEmpPer, HispanicEmpPer, TwoOrMoreEmpPer) %>%
  left_join(Pittsfield.MA, MA.Emp.Race, by="City")

Pittsfield.MA <- cbind(MA.Emp.Race)

```

* The number of white workers in `r Pittsfield.MA$City` is `r Pittsfield.MA$WhiteEmp` which is `r (round(Pittsfield.MA$WhiteEmpPer,4))*100`% of total number of workers.\
* The number of black workers in `r Pittsfield.MA$City` is `r Pittsfield.MA$BlackEmp` which is `r (round(Pittsfield.MA$BlackEmpPer,4))*100`% of total number of workers.\
* The number of asian workers in `r Pittsfield.MA$City` is `r Pittsfield.MA$AsianEmp` which is `r (round(Pittsfield.MA$AsianEmpPer,4))*100`% of total number of workers.\
* The number of hispanic or latino workers in `r Pittsfield.MA$City` is `r Pittsfield.MA$HispanicEmp` which is `r (round(Pittsfield.MA$HispanicEmpPer,4))*100`% of total number of workers.\
* The number of workers, who have two or more races in `r Pittsfield.MA$City` is `r Pittsfield.MA$TwoOrMoreEmp` which is `r (round(Pittsfield.MA$TwoOrMoreEmpPer,4))*100`% of total number of workers.\
\


### Employee Education
\
```{r message=FALSE, warning=FALSE, ,echo=FALSE, results='hide', comment=""}
#############################################   Employee Education    ########################################################

MA.Educ.Emp <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B16010_003", # Less than high school graduate in labor force
														              "B16010_016", # High school graduate in labor force 
														              "B16010_029", # Some college or associate's degree in labor force
														              "B16010_042",
														              "B16010_001"), # Total
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(LessThanHSLabor = B16010_003,
	       HSGradLabor = B16010_016,
	       SomeCollLabor = B16010_029,
	       BachOrHigherLabor = B16010_042,
	       LessThanHSLaborPer = LessThanHSLabor/B16010_001,
	       HSGradLaborPer = HSGradLabor/B16010_001,
	       SomeCollLaborPer = SomeCollLabor/B16010_001,
	       BachOrHigherLaborPer = BachOrHigherLabor/B16010_001) %>%
	select(City ,LessThanHSLabor, HSGradLabor, SomeCollLabor, BachOrHigherLabor,
	       LessThanHSLaborPer, HSGradLaborPer, SomeCollLaborPer, BachOrHigherLaborPer) %>%
  left_join(Pittsfield.MA, MA.Educ.Emp, by="City")

Pittsfield.MA <- cbind(MA.Educ.Emp)
```
* The number of workers, who have less than high school degree in `r Pittsfield.MA$City` is `r Pittsfield.MA$LessThanHSLabor` which is `r (round(Pittsfield.MA$LessThanHSLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have high school degree in `r Pittsfield.MA$City` is `r Pittsfield.MA$HSGradLabor` which is `r (round(Pittsfield.MA$HSGradLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have some college or associates degree in `r Pittsfield.MA$City` is `r Pittsfield.MA$SomeCollLabor` which is `r (round(Pittsfield.MA$SomeCollLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have bachelors degree or higher in `r Pittsfield.MA$City` is `r Pittsfield.MA$BachOrHigherLabor` which is `r (round(Pittsfield.MA$BachOrHigherLaborPer,4))*100`% of total number of workers.\

\

### Employee Sex
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################    Employee Sex   #############################################################

MA.Emp.Sex <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B23001_005", # Employed males
														              "B23001_007", 
														              "B23001_012",
														              "B23001_014",
														              "B23001_019",
														              "B23001_021",
														              "B23001_026",
														              "B23001_028",
														              "B23001_033",
														              "B23001_035",
														              "B23001_040",
														              "B23001_042",
														              "B23001_047",
														              "B23001_049",
														              "B23001_054",
														              "B23001_056",
														              "B23001_061",
														              "B23001_063",
														              "B23001_068",
														              "B23001_070",
														              "B23001_075",
														              "B23001_080",
														              "B23001_085",
														              "B23001_091", # Employed females
														              "B23001_093",
														              "B23001_098",
														              "B23001_100",
														              "B23001_105",
														              "B23001_107",
														              "B23001_112",
														              "B23001_114",
														              "B23001_119",
														              "B23001_121",
														              "B23001_126",
														              "B23001_128",
														              "B23001_133",
														              "B23001_135",
														              "B23001_140",
														              "B23001_142",
														              "B23001_147",
														              "B23001_149",
														              "B23001_154",
														              "B23001_156",
														              "B23001_161",
														              "B23001_166",
														              "B23001_171",
														              "B23001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(EmpMale = B23001_005 + B23001_007 + B23001_012 + B23001_014 + B23001_019 + B23001_021 + B23001_026 + B23001_028 + B23001_033 + B23001_035 + B23001_040 + B23001_042 + B23001_047 + B23001_049 + B23001_054 + B23001_056 + B23001_061 + B23001_063 + B23001_068+ B23001_070 + B23001_075 + B23001_080 + B23001_085,
	  EmpFemale = B23001_091 + B23001_093 + B23001_098 + B23001_100 + B23001_105 + B23001_107 + B23001_112 + B23001_114 + B23001_119 + B23001_121 + B23001_126+ B23001_128 + B23001_133 + B23001_135 + B23001_140 + B23001_142 + B23001_147 + B23001_149 + B23001_154 + B23001_156 + B23001_161 + B23001_166 + B23001_171,
	  TotalEmp = EmpMale + EmpFemale,
	  EmpMalePer = EmpMale/	B23001_001,
	  EmpFemalePer = EmpFemale/B23001_001) %>%
	select(City, EmpMale, EmpFemale, TotalEmp, EmpMalePer, EmpFemalePer) %>%
  left_join(Pittsfield.MA, MA.Emp.Sex, by="City")

Pittsfield.MA <- cbind(MA.Emp.Sex)


```
* The number of male workers in `r Pittsfield.MA$City` is `r Pittsfield.MA$EmpMale` which is `r (round(Pittsfield.MA$EmpMalePer,4))*100`% of total number of workers.\
* The number of female workers in `r Pittsfield.MA$City` is `r Pittsfield.MA$EmpFemale` which is `r (round(Pittsfield.MA$EmpFemalePer,4))*100`% of total number of workers.\

\

## Healthcare
\

### Number of Hospitals
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

Pittsfield.MA$Hospitals <- 1
```


* `r Pittsfield.MA$City` has one hospital, which contains 275 beds.(https://www.ahd.com/)

\


###	Number of Nursing Homes 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Pittsfield.MA$NursingHomes <- 4
```


* `r Pittsfield.MA$City` has 4 nursing homes.(https://nursinghomedirectory.com/)


## Municipal Finances
\

###	Revenue Streams
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

Pittsfield.MA$TotalRevenueFY19 <- 154576084
Pittsfield.MA$RevenueTaxesFY19 <- 93258642
Pittsfield.MA$StateRevenueFY19 <- 56869795 
Pittsfield.MA$RevenueMiscellaneousFY19 <- 1554433
Pittsfield.MA$RevenueServiceChargesFY19 <- 1756234
Pittsfield.MA$RevenuePermitsFY19 <- 644345
Pittsfield.MA$RevenueFineForfeituresFY19 <- 380400
Pittsfield.MA$RevenueGovernmentsFY19 <- 73820
Pittsfield.MA$RevenueTransferFY19 <- 38415
```
* The total revenues for `r Pittsfield.MA$City` is $154,576,084 in Fiscal Year 2019, which includes taxes with 93,258,642 Dollar, state revenue with 56,869,795 Dollar, miscellaneous with 1,554,433 Dollar, service charges with 1,756,234 Dollar, licenses and permits with 644,345 Dollar, fines and forfeitures with 380,400 Dollar, revenue from other governments with 73,820 Dollar, and transfers with 38,415 Dollar.(https://dlsgateway.dor.state.ma.us/)

\

###	Major Expense Drivers
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Pittsfield.MA$ExpendituresFY19 <- 156220867
Pittsfield.MA$EXEducationFY19 <- 62054582
Pittsfield.MA$EXFixedCostsFY19 <- 40983208
Pittsfield.MA$EXDebtServiceFY19 <- 11661554
Pittsfield.MA$EXPoliceFY19 <- 10288679
Pittsfield.MA$EXPublicWorksFY19 <- 897266
Pittsfield.MA$EXFireFY19 <- 7060305
Pittsfield.MA$EXIntergovernmentalFY19 <- 6194181
Pittsfield.MA$EXGeneralGovernmentFY19 <- 4847905
Pittsfield.MA$EXHumanServicesFY19 <- 1734699
Pittsfield.MA$EXCultureRecreationFY19 <- 1683496
Pittsfield.MA$EXOtherExpendituresFY19 <- 375733
Pittsfield.MA$EXPublicSafetyFY19 <- 363861
```

* The total amount of expenditures for `r Pittsfield.MA$City` is $156,220,867 in Fiscal Year 2019 and the major expense driver is related to education, which is 62,054,582 Dollar. After that fixed costs with 40,983,208 Dollar, debt service with 11,661,554 Dollar, police with 10,288,679 Dollar, public works with 8,972,66 Dollar, fire with 7,060,305 Dollar, intergovernmental assessments with 6,194,181 Dollar, general government with 4,847,905 Dollar, human services with 1,734,699 Dollar, culture and recreation with 1,683,496 Dollar, other expenditures with 375,733 Dollar, and other public safety with 363,861 Dollar. (https://dlsgateway.dor.state.ma.us/)


\

### FY20 Budget – Projected Deficits 
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Pittsfield.MA$ExpendituresFY20 <- 175487453
Pittsfield.MA$EXEducationFY20 <- 154167742
Pittsfield.MA$EXGeneralGovernmentFY20 <- 90686042

Pittsfield.MA$TotalRevenueFY20 <- 176009460
Pittsfield.MA$RevenuePopertyTaxFY20 <- 90800000

```


* Expenditures: The proposed FY20 municipal operating budget in `r Pittsfield.MA$City` is 175,487,453 Dollar "reflecting a 3.9% increase over FY19. This proposal includes increases in the following fixed costs: (1) a 1,400,000 Dollar increase in health insurance; (2) a 200,524 Dollar increase in the retirement contribution; and (3) a 188,448 Dollar increase in solid waste collection and disposal. In addition to these increases, there is a $2,299,695 decrease in long-term debt payments, principal and interest".
Revenue: The proposed FY20 municipal operating budget in `r Pittsfield.MA$City` is 176,009,460 Dollar. "Amounts to be raised from the property tax equals 90,800,000 Dollar. The remaining revenue will come from state aid and local receipts. State aid is projected to be $57,427,891 and local receipts are estimated to be 12,200,285 Dollar. The budget includes a 750,000 Dollar appropriation from free cash to offset the tax rate. An appropriation from water and sewer enterprise funds equaling 12,481,397 Dollar has been applied to the revenue stream".(https://www.cityofpittsfield.org/)


\


## Infrastructure
\

### Presence of Nearby Ports, Airports, Major Rail Facilities, or Intermodal Freight Facilities
\

* There is a rail service in Pittsfield, which provides daily service for passangers by AMTRAK on its "Lakeshore Limited" route from Boston to Chicago through Pittsfield. Also, Pittsfield contains an Airport, which its name is Pittsfield Municipal Airport and it offers "business and casual travel access to the region via private and chartered aircraft ranging from single engine piston to multi-engine private jet".(https://www.cityofpittsfield.org/)

\

### Public Transport Reliability and Scope 
\

* Berkshire Regional Transit Authority provides fourteen fixed route bus services in thirteen-member communities spanning Berkshire County from Williamstown in the north to Great Barrington in the south. Six routes are operated solely in Pittsfield. Five additional routes originate in Pittsfield and travel to Lanesborough.(https://www.cityofpittsfield.org/)\


\

### Internet Access
\

* `r Pittsfield.MA$City` has two major Internet service types, which are; coaxial cable (close to one hundred % coverage) and DSL (97.52% availability). "Cable broadband service is generally delivered via traditional cable TV companies via pre-existing copper coaxial television wires on utility poles or buried in the street. DSL Internet is delivered via landline phone lines. Most Pittsfield census blocks have access to cable service and/or DSL from two or more providers. Charter Spectrum as well as Verizon High Speed Internet also have Internet service in Pittsfield, with significant shared territory in some parts of town. Coverage from Viasat Internet (formerly Exede) and HughesNet, as a rule, will overlap. As a result, the decision between Viasat and HughesNet is a common one. The average census block has 3.00 or more serviceable Internet providers in `r Pittsfield.MA$City`. There are 15 internet providers in Pittsfield with 6 of those offering residential service". Pittsfield is the 207th most connected city in Massachusetts and the fastest zip code in Pittsfield for April 2020 is 01201.(https://broadbandnow.com/Massachusetts/Pittsfield)\







\

## Food Insecurity
\


### Number of Grocery Stores
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Pittsfield.MA$NumGrocery <- 33
```
* `r Pittsfield.MA$City` has 33 Grocery Stores.

\


### SNAP Recipients
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##########################################################################################################################

                                                #----------------------#
                                                #    FOOD INSECURITY   #
                                                #----------------------#

####################################################  SNAP Recipients  ###################################################         

MA.Snap <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B22001_002", # Household received Food Stamps/SNAP in the past 12 months
														"B22001_001"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(SnapRec = B22001_002/B22001_001) %>%
	select(City ,SnapRec) %>%
  left_join(Pittsfield.MA, MA.Snap, by="City")

Pittsfield.MA <- cbind(MA.Snap)

#######################################################################################################################################

```
* The percent of households, who received Food Stamps/SNAP in the past 12 months in `r Pittsfield.MA$City` state is `r (round(Pittsfield.MA$SnapRec,4))*100`%.\

\

## Housing
\

### Proportion of Renters to Owners
\

### Home Values
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

                                                #----------------------#
                                                #       HOUSING        #
                                                #----------------------#

######################   Proportion of Renters to Owners, Home Values   ########################################

MA.Housing <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"), # Owner occupied
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME,
         MedianHValue = B25077_001,
	       AvgHValue = B25082_001/B25003_002) %>%
	mutate(RentersPer = B25009_010/B25009_001,
				 HomeOwnPer = B25009_002/B25009_001,
				 RentersToOwners = B25009_010/B25009_002) %>%
	select(City,RentersPer, HomeOwnPer, RentersToOwners, MedianHValue, AvgHValue) %>%
  left_join(Pittsfield.MA, MA.Housing, by="City")

Pittsfield.MA <- cbind(MA.Housing)

```
* The median house value in `r Pittsfield.MA$City` is 172600 Dollar.\

* The average house value in `r Pittsfield.MA$City` is 2521194700 Dollar.\

* The proportion of renters to owners in `r Pittsfield.MA$City` is `r round(Pittsfield.MA$RentersToOwners,3)`.\

* The percentage of renters in `r Pittsfield.MA$City` is `r (round(Pittsfield.MA$RentersPer,2))*100`%.\

* The percentage of owners in `r Pittsfield.MA$City` is `r (round(Pittsfield.MA$HomeOwnPer,2))*100`%.\
Followed is the map of Proportion of Renters to Owners, Median Home Values, and Average Home Values of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## MAP
Pit.MA.housing <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.housing.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(MedianHValue_BG = B25077_001E,
	       AvgHValue_BG = B25082_001E / B25003_002E) %>%
	mutate(RentersPer_BG = B25009_010E/B25009_001E,
				 HomeOwnPer_BG = B25009_002E/B25009_001E,
				 RentersToOwners_BG = B25009_010E/B25009_002E)

Pittsfield.housing <- merge(pit.housing.get, Pit.MA.housing, by.x = 'NAME.y', by.y='NAME')


tm_shape(Pittsfield.housing) + tm_polygons("MedianHValue_BG" , palette="Blues", style = "quantile", title = "Median Home Value", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") 

```
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
tm_shape(Pittsfield.housing) + tm_polygons("AvgHValue_BG" , palette="Greens", style = "quantile", title = "Average Home Value", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray")
```
\



\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
tm_shape(Pittsfield.housing) + tm_polygons("RentersToOwners_BG" , palette="Reds", style = "quantile", title = "RentersToOwners") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") 
```
\



\

### Property Tax Rates
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Pittsfield.MA$PropertyTaxRate.RES <- 19.71
Pittsfield.MA$PropertyTaxRate.Com <- 40.36
```
* The amount of tax rate in `r Pittsfield.MA$City` is 19.71 Dollar per 1,000 Dollar worth of value for residential properties and is 40.36 Dollar for per 1,000 Dollar for commercial properties in fiscal year 2020.\


\


### Duration of Occupancy
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#########################################      Duration of Occupancy    ####################################################
MA.Dur.Occ <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"),
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME,
         MedYrMovedIn = B25039_001, 
				 MedYrRentMovedIn = B25039_003,
				 MedYrOwnMovedIn = B25039_002) %>%
	select(City, MedYrMovedIn, MedYrRentMovedIn, MedYrOwnMovedIn) %>%
  left_join(Pittsfield.MA, MA.Dur.Occ, by="City")

Pittsfield.MA <- cbind(MA.Dur.Occ)
```
* The median year that a homeowner moved into their current domicile in `r Pittsfield.MA$City` is `r Pittsfield.MA$MedYrOwnMovedIn`.\
* The median year that a renter moved into their current domicile in `r Pittsfield.MA$City` is `r Pittsfield.MA$MedYrRentMovedIn`.\
Followed is the map of Duration of Occupancy of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
## MAP
Pit.MA.dur <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"),
                     areas = "Pittsfield city, MA",
                     summary_level = "block group")

pit.dur.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state="MA",
													 county = "Berkshire",
													 year = endyr,
													 output = "wide",
													 variables = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(MedYrMovedIn_BG = B25039_001E, # I'm not sure if I should substract this value from 2018
				 MedYrRentMovedIn_BG = B25039_003E,
				 MedYrOwnMovedIn_BG = B25039_002E)

Pittsfield.dur <- merge(pit.dur.get, Pit.MA.dur, by.x = 'NAME.y', by.y='NAME')



tm_shape(Pittsfield.dur) + tm_polygons(c("MedYrMovedIn_BG","MedYrRentMovedIn_BG","MedYrOwnMovedIn_BG"), style="jenks", palette=list("Greens","seq","Blues"), border.col = "darkgray", title=c("MedYrMovedIn","MedYrRentMovedIn","MedYrOwnMovedIn")) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")
```

\

### Cost Burdened Occupants
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

##############################################   Cost Burdened Occupants   ##################################
MA.CostBurdened <- read_acs5year(year = endyr,
                     states = "MA",
                     table_contents = c("B25095_006", # Household income by selected monthly owner Costs as a percentage of household income
														              # Less than $10,000 (30 to 34.9 percent)
														              "B25095_007", # Less than $10,000 (35 to 39.9 percent)
														              "B25095_008", # Less than $10,000 (40 to 49.9 percent)
														              "B25095_009", # Less than $10,000 (50 percent or more)
														              "B25095_015", # $10,000 to $19,999 (30 to 34.9 percent)
														              "B25095_016", # $10,000 to $19,999 (35 to 39.9 percent)
														              "B25095_017", # $10,000 to $19,999 (40 to 49.9 percent)
														              "B25095_018", # $10,000 to $19,999 (50 percent or more)
														              "B25095_024", # $20,000 to $34,999 (30 to 34.9 percent)
														              "B25095_025", # $20,000 to $34,999 (35 to 39.9 percent)
														              "B25095_026", # $20,000 to $34,999 (40 to 49.9 percent)
														              "B25095_027", # $20,000 to $34,999 (50 percent or more)
														              "B25095_033", # $35,000 to $49,999 (30 to 34.9 percent)
														              "B25095_034", # $35,000 to $49,999 (35 to 39.9 percent)
														              "B25095_035", # $35,000 to $49,999 (40 to 49.9 percent)
														              "B25095_036", # $35,000 to $49,999 (50 percent or more)
														              "B25095_042", # $50,000 to $74,999 (30 to 34.9 percent)
														              "B25095_043", # $50,000 to $74,999 (35 to 39.9 percent)
														              "B25095_044", # $50,000 to $74,999 (40 to 49.9 percent)
														              "B25095_045", # $50,000 to $74,999 (50 percent or more)
														              "B25095_051", # $75,000 to $99,999 (30 to 34.9 percent)
														              "B25095_052", # $75,000 to $99,999 (35 to 39.9 percent)
														              "B25095_053", # $75,000 to $99,999 (40 to 49.9 percent)
														              "B25095_054", # $75,000 to $99,999 (50 percent or more)
														              "B25095_060", # $100,000 to $149,999 (30 to 34.9 percent)
														              "B25095_061", # $100,000 to $149,999 (35 to 39.9 percent)
														              "B25095_062", # $100,000 to $149,999 (40 to 49.9 percent)
														              "B25095_063", # $100,000 to $149,999 (50 percent or more)
														              "B25095_069", # $150,000 or more (30 to 34.9 percent)
														              "B25095_070", # $150,000 or more (35 to 39.9 percent)
														              "B25095_071", # $150,000 or more (40 to 49.9 percent)
														              "B25095_072", # $150,000 or more (50 percent or more)
														              "B25095_001",
														              "B25095_001"), # Total
                     areas = "Pittsfield city, MA",
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(CostBurdened = B25095_006+B25095_007+B25095_008+B25095_009+B25095_015+B25095_016+B25095_017+B25095_018+
	       B25095_024+B25095_025+B25095_026+B25095_027+B25095_033+B25095_034+B25095_035+B25095_036+B25095_042+B25095_043+B25095_044+B25095_045+B25095_051+B25095_052+B25095_053+B25095_054+B25095_060+B25095_061+B25095_062+B25095_063+B25095_069+B25095_070+B25095_071+B25095_072,
         CostBurdenedPer = CostBurdened/B25095_001) %>%
	select(City ,CostBurdened,CostBurdenedPer) %>%
  left_join(Pittsfield.MA, MA.CostBurdened, by="City")

Pittsfield.MA <- cbind(MA.CostBurdened)

```
* The number of households, who spend 30 percent or more on housing costs in `r Pittsfield.MA$City` is `r Pittsfield.MA$CostBurdened` which is `r (round(Pittsfield.MA$CostBurdenedPer,3))*100`% of total number of households, who spend money on housing costs.\

\

### Homelessness
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Pittsfield.MA$Homelessness <- 546
```


* The number of people homeless on a given night in 2019 in `r Pittsfield.MA$City` is 546, which means 15.2 homeless per 10,000 people in the general population.(https://endhomelessness.org/)


\

### Local/State Policies + Assistance on Rent Deferment
\

* Pittsfield offers some type of state of federally subsidized Rental Assistance Programs and/or emergency financial assistance for low income persons in need. There are also thousands of local non-profit organizations that offer help paying rent along with providing housing assistance.\ 


