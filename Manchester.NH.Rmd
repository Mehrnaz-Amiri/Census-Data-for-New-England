---
title: "Municipal Indicators For Manchester, NH"
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
  html_notebook:
    toc: yes
    toc_depth: 3
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '3'
---

In this report, 41 demographic, educational institutions, employment, healthcare, municipal finance, infrastructure, food insecurity and housing variables are presented using federally-published data sources for the city of Manchester, New Hampshire. To better demonstrate their ties to geography of the city, the variables have been mapped on the block group level. \


## Demographic
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
                                 #######################################################
                                 #       Municipal Indicators For Municipalities        #               
                                 #######################################################
library(stringr)
library(tidycensus)
library(tidyverse)
library(tigris)
library(totalcensus)

options(tigris_class = "sf",tigris_use_cache = T)
# Get API key 
# census_api_key("045944708d514a404443c9f2d227ac8bf6a8f8bd", install = TRUE, overwrite=TRUE)
# Specify the end year 
# This is for 5-year estimates
endyr <- 2018
# List of ACS variables
Var_List <- tidycensus::load_variables(year = endyr, dataset = "acs5", cache = T)
# View(Var_List)
```


\


### Population  Size
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

                                             #--------------------#
                                             #    DEMOGRAPHIC     #
                                             #--------------------#

##############################################    Population  Size    ###########################################################
library(tidyverse)
# search_cbsa()
# search_fips()
# set_path_to_census("C:\\Users\\ux305\\Desktop\\census")
j <- "NH"
area <- "Keene city, NH"
#c <- "Hillsborough"
ch.pop <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B01003_001",
                     areas = area,
                     summary_level = "place") %>%
				 rename(TotalPop = population,
				        City = NAME) %>% select(City, TotalPop)
Chelsea.MA <- cbind(ch.pop)
```


The total population of `r Chelsea.MA$City` is `r Chelsea.MA$TotalPop`. Followed is the population size map of the city.\
\

```{r , echo=FALSE, warning=FALSE, message=FALSE, comment=""}

## MAP
library(tmap)
tm_shape(Chelsea) + tm_polygons('B01003_001E' , palette="seq", style = "jenks", title = "Total Population")  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")
```
\


### Population Age
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##############################################    Population  Age   #############################################################
MA.Age.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
				 mutate(AgeU18 = B01001_003+B01001_004+B01001_005+B01001_006+B01001_027+B01001_028+B01001_029+B01001_030, 
				 Age1834 = B01001_007+B01001_008+B01001_009+B01001_010+B01001_011+B01001_012+B01001_036+B01001_035+B01001_034+B01001_033+B01001_032+B01001_031,
				 Age3564 = B01001_013+B01001_014+B01001_015+B01001_016+B01001_017+B01001_018+B01001_019+B01001_043+B01001_042+B01001_041+B01001_040+B01001_039+B01001_038+B01001_037,
				 AgeO65 = B01001_020+B01001_021+B01001_022+B01001_023+B01001_024+B01001_025+B01001_044+B01001_045+B01001_046+B01001_047+B01001_048+B01001_049) %>%
  	mutate(AgeU18Per = AgeU18/population,
				 Age1834Per = Age1834/population,
				 Age3564Per = Age3564/population,
				 AgeO65Per = AgeO65/population) %>%
select(AgeU18,Age1834,Age3564,AgeO65,AgeU18Per,Age1834Per,Age3564Per,AgeO65Per, City) %>%
  left_join(Chelsea.MA, MA.Age.ch, by="City")

Chelsea.MA <- cbind(MA.Age.ch)
```
* The number of people, who are younger than 18 Years old is `r Chelsea.MA$AgeU18` in `r Chelsea.MA$City` 
, which is `r (round(Chelsea.MA$AgeU18Per,4))*100`% of total population in `r Chelsea.MA$City`. \
* The number of people, who are between 18 and 34 years old is `r Chelsea.MA$Age1834` in `r Chelsea.MA$City`, which is `r (round(Chelsea.MA$Age1834Per,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people, who are between 35 and 64 years old is `r Chelsea.MA$Age3564` in `r Chelsea.MA$City`, which is `r (round(Chelsea.MA$Age3564Per,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people, who are older than 65 years old is `r Chelsea.MA$AgeO65` in `r Chelsea.MA$City`, which is `r (round(Chelsea.MA$AgeO65Per,4))*100`% of total population in `r Chelsea.MA$City`.\

Followed is the population age map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## Map

ch.MA.Age <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"),
                     areas = area,
                     summary_level = "block group")

ch.age.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B01001_003","B01001_004","B01001_005","B01001_006",
													 							"B01001_027","B01001_028","B01001_029","B01001_030", # Under 5 years; Between 5 to 17
													 							"B01001_007","B01001_008","B01001_009",
													 							"B01001_010","B01001_011","B01001_012",
													 							"B01001_036","B01001_035","B01001_034",
													 							"B01001_033","B01001_032","B01001_031", # 18 to 24 years; 25 to 34 years
													 							"B01001_013","B01001_014","B01001_015",
													 							"B01001_016","B01001_017","B01001_018","B01001_019",
													 							"B01001_043","B01001_042","B01001_041","B01001_040",
													 							"B01001_039","B01001_038","B01001_037", # 35 to 44 years; 45 to 54 years; 55 to 59 years; 60 to 64 years
													 							"B01001_020","B01001_021","B01001_022",
													 							"B01001_023","B01001_024","B01001_025",
													 							"B01001_044","B01001_045","B01001_046",
													 							"B01001_047","B01001_048","B01001_049","B01003_001"), # Total Population
													 keep_geo_vars = T, geometry = TRUE) %>%
mutate(AgeU18 = B01001_003E+B01001_004E+B01001_005E+B01001_006E+B01001_027E+B01001_028E+B01001_029E+B01001_030E, 
				 Age1834 = B01001_007E+B01001_008E+B01001_009E+B01001_010E+B01001_011E+B01001_012E+B01001_036E+B01001_035E+B01001_034E+B01001_033E+B01001_032E+B01001_031E,
				 Age3564 = B01001_013E+B01001_014E+B01001_015E+B01001_016E+B01001_017E+B01001_018E+B01001_019E+B01001_043E+B01001_042E+B01001_041E+B01001_040E+B01001_039E+B01001_038E+B01001_037E,
				 AgeO65 = B01001_020E+B01001_021E+B01001_022E+B01001_023E+B01001_024E+B01001_025E+B01001_044E+B01001_045E+B01001_046E+B01001_047E+B01001_048E+B01001_049E)  %>%
  rename(AgeU18_BG = AgeU18,
				 Age1834_BG = Age1834,
				 Age3564_BG = Age3564,
				 AgeO65_BG = AgeO65) %>%
	mutate(AgeU18Per_BG = ((AgeU18_BG/B01003_001E)*100),
				 Age1834Per_BG = ((Age1834_BG/B01003_001E)*100),
				 Age3564Per_BG = ((Age3564_BG/B01003_001E)*100),
				 AgeO65Per_BG = ((AgeO65_BG/B01003_001E)*100))  

Chelsea.age <- merge(ch.age.get, ch.MA.Age, by.x = 'NAME.y', by.y='NAME')

make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}
 

tm_shape(Chelsea.age) + tm_polygons(c('AgeU18Per_BG','Age1834Per_BG',"Age3564Per_BG","AgeO65Per_BG") , palette=list("Oranges", "Greens", "Blues", "Purples") ,style = "quantile", title = c('AgeU18','Age1834',"Age3564","AgeO65"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))  + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) +tm_layout(legend.position = c("left","top"))

```
\

### Median Household Income
\

```{r  echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#################################################    Median Household Income    ##############################################################

MA.MHI.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B19013_001",
                     areas = area,
                     summary_level = "place") %>%
				 rename(MedHouseIncome = B19013_001,
				        City = NAME) %>% 
	select(City, MedHouseIncome) %>%
  left_join(Chelsea.MA, MA.MHI.ch, by="City")
Chelsea.MA <- cbind(MA.MHI.ch)
```
* The median household income in the past 12 months is 56307 Dollar in `r Chelsea.MA$City`.\

Followed is the Median Household Income map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## MAP
ch.MA.income <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B19013_001",
                     areas = area,
                     summary_level = "block group")

ch.income.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = "B19013_001", 
													 keep_geo_vars = T, geometry = TRUE) 

chelsea.income <- merge(ch.income.get, ch.MA.income, by.x = 'NAME.y', by.y='NAME')

make_dollar <- function(x, digits = 0) {
  paste0("$", formatC(x, digits = digits, format = "f", big.mark = ","))
}

library(tmap)
tm_shape(chelsea.income) + tm_polygons('B19013_001E' , palette="Blues", style="jenks", title = "Median Household Income", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar))  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) 
```

\

### Racial Breakdown 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##############################################      Racial Breakdown     ###################################################################
MA.Race.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009"),
                     areas = area,
                     summary_level = "place") %>%
				 rename(White = B03002_003,
				 Black = B03002_004,
				 Asian = B03002_006,
				 Hispanic = B03002_012,
				 TwoOrMore = B03002_009,
				 City = NAME) %>% 
  mutate(WhitePer = (White/population),
         BlackPer = (Black/population),
         AsianPer = (Asian/population),
         HispanicPer = (Hispanic/population),
         TwoOrMorePer = (TwoOrMore/population)) %>%
	select(City, White, Black, Asian, Hispanic, TwoOrMore,
	       WhitePer, BlackPer, AsianPer, HispanicPer, TwoOrMorePer) %>%
  left_join(Chelsea.MA, MA.Race.ch, by="City")
Chelsea.MA <- cbind(MA.Race.ch)

```
* The number of people who are white in `r Chelsea.MA$City` is `r Chelsea.MA$White` which is `r (round(Chelsea.MA$WhitePer,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people who are black in `r Chelsea.MA$City` is `r Chelsea.MA$Black` which is `r (round(Chelsea.MA$BlackPer,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people who are asian in `r Chelsea.MA$City` is `r Chelsea.MA$Asian` which is `r (round(Chelsea.MA$AsianPer,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people who are hispanic in `r Chelsea.MA$City` is `r Chelsea.MA$Hispanic` which is `r (round(Chelsea.MA$HispanicPer,4))*100`% of total population in `r Chelsea.MA$City`.\
* The number of people who are have two or more races in `r Chelsea.MA$City` is `r Chelsea.MA$TwoOrMore` which is `r (round(Chelsea.MA$TwoOrMorePer,4))*100`% of total population in `r Chelsea.MA$City`. \

Followed is the Racial Breakdown map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## Map
ch.MA.race <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009",
																					"B01003_001"),
                     areas = area,
                     summary_level = "block group")

ch.race.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B03002_003", # white alone
																					"B03002_004", # black or African American alone
																					"B03002_006", # Asian alone
																					"B03002_012", # Hispanic or Latino alone
																					"B03002_009",
																					"B01003_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(White_BG = B03002_003E,
				 Black_BG = B03002_004E,
				 Asian_BG = B03002_006E,
				 Hispanic_BG = B03002_012E,
				 TwoOrMore_BG = B03002_009E) %>%
  mutate(WhitePer_BG = (White_BG/B01003_001E)*100,
         BlackPer_BG = (Black_BG/B01003_001E)*100,
         AsianPer_BG = (Asian_BG/B01003_001E)*100,
         HispanicPer_BG = (Hispanic_BG/B01003_001E)*100,
         TwoOrMorePer_BG = (TwoOrMore_BG/B01003_001E)*100) 

chelsea.race <- merge(ch.race.get, ch.MA.race, by.x = 'NAME.y', by.y='NAME')


make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}
 
library(tmap)
tm_shape(chelsea.race) + tm_polygons(c("WhitePer_BG", "BlackPer_BG", "AsianPer_BG", "HispanicPer_BG", "TwoOrMorePer_BG") , palette=list("Oranges", "Greens", "Blues", "Purples", "Reds"), style = "quantile", title = c("White", "Black", "Asian","Hispanic", "TwoOrMore"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))  + tm_view(alpha = 0.85,view,basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray") + tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("left","top"))
```

\


### Gender Breakdown
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#####################################################    Gender Breakdown    #############################################################

MA.Sex.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B01001_026",
													               "B01001_002"),
                     areas = area,
                     summary_level = "place") %>%
  mutate(SexRatio = B01001_026/B01001_002) %>%
  rename(Female = B01001_026,
				 Male = B01001_002,
				 City = NAME) %>%
  mutate(FemalePer = Female/population,
				 MalePer = Male/population) %>% 
	select(City, SexRatio, Female, Male, FemalePer, MalePer) %>%
  left_join(Chelsea.MA, MA.Sex.ch, by="City")

Chelsea.MA <- cbind(MA.Sex.ch)

```
* The number of females in `r Chelsea.MA$City` is `r Chelsea.MA$Female` which is `r 100*(round(Chelsea.MA$FemalePer,2))`% of total population in `r Chelsea.MA$City`.\
* The number of males in `r Chelsea.MA$City` is `r Chelsea.MA$Male` which is `r 100*(round(Chelsea.MA$MalePer,2))`% of total population in `r Chelsea.MA$City`.\
* The ratio of number of females to males in `r Chelsea.MA$City` is `r Chelsea.MA$SexRatio`.\
Followed is the Gender Breakdown map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.sex <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B01001_026",
													               "B01001_002",
													               "B01003_001"),
                     areas = area,
                     summary_level = "block group")

ch.sex.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B01001_026",
													               "B01001_002",
													               "B01003_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
mutate(SexRatio = B01001_026E/B01001_002E) %>%
  rename(Female = B01001_026E,
				 Male = B01001_002E) %>%
  mutate(FemalePer = (Female/B01003_001E)*100,
         MalePer = (Male/B01003_001E)*100)

chelsea.sex <- merge(ch.sex.get, ch.MA.sex, by.x = 'NAME.y', by.y='NAME')

library(tmap)
tm_shape(chelsea.sex) + tm_polygons(c('Female', 'Male'), palette=list("Purples", "Reds"), title = c("Female","Male"))  + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")+ tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("left","bottom"))

```

\



```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

tm_shape(chelsea.sex) + tm_polygons(c('FemalePer', 'MalePer'), palette=list("Blues", "Oranges"), title = c("Female Percentage","Male Percentage"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent)) + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") +tm_borders(col = "darkgray")+ tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("left","bottom"))

```




\

### Average Household Size
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#################################################    Average Household Size    ############################################################

MA.AveHH.Size.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11002_001", 
															         "B19001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(AveHouseH = B11002_001/B19001_001) %>%
	select(City, AveHouseH) %>%
  left_join(Chelsea.MA, MA.AveHH.Size.ch, by="City")

Chelsea.MA <- cbind(MA.AveHH.Size.ch)
```
* The average household size is `r round(Chelsea.MA$AveHouseH, 2)` in `r Chelsea.MA$City`.\
Followed is the Average Household Size map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

ch.MA.HH.Size <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11002_001", # Household type by relatives and nonrelatives for population in households
															              "B19001_001"),
                     areas = area,
                     summary_level = "block group")

ch.HH.Size.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B11002_001", # Household type by relatives and nonrelatives for population in households
															              "B19001_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
  mutate(AveHouseH = B11002_001E/B19001_001E) 

chelsea.HH.Size <- merge(ch.HH.Size.get, ch.MA.HH.Size, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.HH.Size) + tm_polygons("AveHouseH", style = "quantile", palette="Purples", border.col = "darkgray", title="Ave Household Size") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite") + tmap_options(show.messages = FALSE)

```

\

### Educational Attainment
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################   Educational Attainment    ##################################################################
MA.Educ.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(LessThanHS = (B15002_003+B15002_004+B15002_005+B15002_006+B15002_007+B15002_008+B15002_009+B15002_010+B15002_020+B15002_021+B15002_022+B15002_023+B15002_024+B15002_025+B15002_026+B15002_027),
				 HSGrad = (B15002_011 + B15002_028),
				 SomeColl = (B15002_012+ B15002_013 + B15002_014 + B15002_029 + B15002_030 + B15002_031),
				 Bach = (B15002_015 + B15002_032),
				 Master = (B15002_016 + B15002_033),
				 Prof = (B15002_017 + B15002_034),
				 Doc = (B15002_018 + B15002_035),
				 LessThanHSPer = (LessThanHS/population),
         HSGradPer = (HSGrad/population),
         SomeCollPer = (SomeColl/population),
         BachPer = (Bach/population),
         MasterPer = (Master/population),
         ProfPer = (Prof/population),            
         DocPer = (Doc/population)) %>%
	select(City, LessThanHS, HSGrad, SomeColl, Bach, Master, Prof, Doc,
	       LessThanHSPer, HSGradPer, SomeCollPer, BachPer, MasterPer, ProfPer, DocPer) %>% 
  left_join(Chelsea.MA, MA.Educ.ch, by="City") 

Chelsea.MA <- cbind(MA.Educ.ch)
```
* The number of people, who have less than high school degree is `r  Chelsea.MA$LessThanHS` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$LessThanHSPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have high school degree is `r  Chelsea.MA$HSGrad` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$HSGradPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have some college degree is `r  Chelsea.MA$SomeColl` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$SomeCollPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have bachelor degree is `r Chelsea.MA$Bach` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$BachPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have master's degree is `r Chelsea.MA$Master` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$MasterPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have professional school degree is `r  Chelsea.MA$Prof` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$ProfPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
* The number of people, who have doctorate degree is `r  Chelsea.MA$Doc` in `r Chelsea.MA$City` which is `r (round(Chelsea.MA$DocPer,4))*100`% of the population who are 25 years old or older in `r Chelsea.MA$City`.\
Followed is the Educational Attainment map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.Educ <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"),
                     areas = area,
                     summary_level = "block group")

ch.Educ.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B15002_001", # variables for Sex by Edu Attainment for Population 25 yrs or Over
																					"B15002_003","B15002_004","B15002_005",
																					"B15002_006","B15002_007","B15002_008","B15002_009","B15002_010",
																					"B15002_020","B15002_021","B15002_022","B15002_023","B15002_024",
																					"B15002_025","B15002_026","B15002_027",
																					"B15002_011","B15002_028",
																					"B15002_012","B15002_013","B15002_014",
																					"B15002_029","B15002_030","B15002_031",
																					"B15002_015","B15002_032",
																					"B15002_016","B15002_033",
																					"B15002_017","B15002_034",
																					"B15002_018","B15002_035"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(LessThanHS_BG = (B15002_003E+B15002_004E+B15002_005E+B15002_006E+B15002_007E+B15002_008E+B15002_009E+B15002_010E+B15002_020E+B15002_021E+B15002_022E+B15002_023E+B15002_024E+B15002_025E+B15002_026E+B15002_027E),
				 HSGrad_BG = (B15002_011E + B15002_028E),
				 SomeColl_BG = (B15002_012E + B15002_013E + B15002_014E + B15002_029E + B15002_030E + B15002_031E),
				 Bach_BG = (B15002_015E + B15002_032E),
				 Master_BG = (B15002_016E + B15002_033E),
				 Prof_BG = (B15002_017E + B15002_034E),
				 Doc_BG = (B15002_018E + B15002_035E),
		    LessThanHSPer_BG = ((B15002_003E+B15002_004E+B15002_005E+B15002_006E+B15002_007E+B15002_008E+B15002_009E+B15002_010E+B15002_020E+B15002_021E+B15002_022E+B15002_023E+B15002_024E+B15002_025E+B15002_026E+B15002_027E)/B15002_001E)*100,
				 HSGradPer_BG = ((B15002_011E + B15002_028E)/B15002_001E)*100,
				 SomeCollPer_BG = ((B15002_012E + B15002_013E + B15002_014E + B15002_029E + B15002_030E + B15002_031E)/B15002_001E)*100,
				 BachPer_BG = ((B15002_015E + B15002_032E)/B15002_001E)*100,
				 MasterPer_BG = ((B15002_016E + B15002_033E)/B15002_001E)*100,
				 ProfPer_BG = ((B15002_017E + B15002_034E)/B15002_001E)*100,
				 DocPer_BG = ((B15002_018E + B15002_035E)/B15002_001E)*100)

chelsea.Educ <- merge(ch.Educ.get, ch.MA.Educ, by.x = 'NAME.y', by.y='NAME')

make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}

tm_shape(chelsea.Educ) +
    tm_fill(c('LessThanHSPer_BG', 'HSGradPer_BG', 'SomeCollPer_BG', 'BachPer_BG', 'MasterPer_BG', 'ProfPer_BG', 'DocPer_BG'),
        style="quantile", 
        palette=list("Oranges", "Greens", "Blues", "Purples", "Reds","Dark2", "seq"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent), title=c('LessThanHS', 'HSGrad', 'SomeColl', 'Bach', 'Master', 'Prof', 'Doc')) + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") +tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("left","bottom"))

```

\

### Single Parent Households
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

##########################################      Single Parent Households     ##################################################################
MA.Single.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(FemHeadPer = B11001_006/B11001_001,
	       MaleHeadPer = B11001_005/B11001_001) %>%
	select(City, FemHeadPer, MaleHeadPer) %>%
  left_join(Chelsea.MA, MA.Single.ch, by="City")

Chelsea.MA <- cbind(MA.Single.ch)

```
* The percentage of single-female-headed is `r (round(Chelsea.MA$FemHeadPer,4))*100`% of total number of family households in `r Chelsea.MA$City`.\
* The percentage of single-male-headed is `r (round(Chelsea.MA$MaleHeadPer,4))*100`% of total number of family households in `r Chelsea.MA$City`.\

Followed is the Single Parent Households map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.single <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"),
                     areas = area,
                     summary_level = "block group")

ch.single.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B11001_006", # Female Hoseholder, No Husband Present
																						"B11001_005", # Male Householder, No Wife Present
																						"B11001_001"), 
													 keep_geo_vars = T, geometry = TRUE)  %>%
mutate(FemHeadPer = (B11001_006E/B11001_001E)*100,
	       MaleHeadPer = (B11001_005E/B11001_001E)*100)

chelsea.single <- merge(ch.single.get, ch.MA.single, by.x = 'NAME.y', by.y='NAME')


make_percent <- function(x, digits = 2) {
  paste0("%", formatC(x, digits = digits, format = "f", big.mark = ","))
}


tm_shape(chelsea.single) + tm_polygons(c("FemHeadPer", "MaleHeadPer"), style="quantile", palette=list("Oranges", "Purples"), popup.format = list(fun = make_percent), legend.format = list(fun = make_percent), border.col = "darkgray", title=c("Female Householder", "Male Householder")) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tmap_options(show.messages = FALSE) + tm_layout(legend.position = c("left","bottom"))

```


\


### Population in Poverty
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
###########################################      Population in Poverty    ######################################################################

MA.PopPov.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  	mutate(FamPovPer = B17010_002/B17010_001,
	       PopPovPer = B17001_002/B17001_001,
	       TotalPopPov = B17001_002) %>%
	select(City, FamPovPer, PopPovPer, TotalPopPov) %>%
  left_join(Chelsea.MA,MA.PopPov.ch, by="City")

Chelsea.MA <- cbind(MA.PopPov.ch)
```
* The percentage of family, who are in poverty is `r (round(Chelsea.MA$FamPovPer,4))*100` % in `r Chelsea.MA$City`.\
* The percentage of population, who are in poverty is `r (round(Chelsea.MA$PopPovPer,4))*100` % in `r Chelsea.MA$City`.\
* The total number of people, who are in poverty is `r Chelsea.MA$TotalPopPov` in `r Chelsea.MA$City`.\
Followed is the Population in Poverty map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

ch.MA.pov <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"),
                     areas = area,
                     summary_level = "block group")

ch.pov.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B17010_002", # Income in the Past 12 Months Below Poverty Level (Family households in poverty)
																					"B17010_001",  # Total Families Below Poverty Level
																					"B17001_002", # Persons below poverty
																					"B17001_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(FamPovPer_BG = (B17010_002E/B17010_001E)*100,
	       PopPovPer_BG = (B17001_002E/B17001_001E)*100,
	       TotalPopPov_BG = B17001_002E) 

chelsea.pov <- merge(ch.pov.get, ch.MA.pov, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.pov) + tm_polygons("FamPovPer_BG", style="quantile", palette="Purples", border.col = "darkgray", title="Family in Poverty", popup.format = list(fun = make_percent), legend.format = list(fun = make_percent))  + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")


```

\


### Elderly People Living Alone
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

########################################     Elderly People Living Alone    ##############################################################
MA.old.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B11010_005", # Male householder, Living alone, 65 years and over
																					"B11010_012", # Female householder, Living alone, 65 years and over
																					"B11010_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(OldAlonePer = (B11010_012 + B11010_005)/B11010_001) %>%
	select(City, OldAlonePer) %>%
  left_join(Chelsea.MA,MA.old.ch, by="City")

Chelsea.MA <- cbind(MA.old.ch) 
Chelsea.MA

## GIVE US NA
```
* The percentage of householders, who are living alone and are older than 65 years old is `r (round(Chelsea.MA$OldAlonePer,4))*100` % in `r Chelsea.MA$City`.\

\

## Educational Institutions
\


\

### Number/Type of Schools
\

* `r Chelsea.MA$City` has 10 public school district, which contains 4101 students and 8 public schools. Also, `r  Chelsea.MA$City` has 5 private schools with 565 students.(https://nces.ed.gov/) 

\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$SchoolsDistrict <- 10
Chelsea.MA$SchoolsDistStudents <- 4101
Chelsea.MA$PubSchools <- 8
Chelsea.MA$PvSchools <- 5
```


\


### Number/Type of Universities
\

* `r Chelsea.MA$City` has 7 university in 03101, 03102, 03103, and 03106 ZIP Codes.(https://nces.ed.gov/) 

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$NumUni <- 7
```


\

###	Employment Numbers per Institution
\


* The largest School District in `r Chelsea.MA$City` contains 985 teachers and 686 other staffs. The total number of teachers in all private schools in `r Chelsea.MA$City` is 250.(http://www.usa.com/)


\

### Number of PK-12 Enrollment in Schools
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
############################################################################################################################

                                             # ----------------------------- #
                                             #    Educational Institutions   #
                                             #-------------------------------#

# Number of PK-12 Enrollment at block group level
MA.Enrol.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B14001_003", # Enrolled in preschool
																					"B14001_004", # Enrolled in kindergarten
																					"B14001_005", # Enrolled in grade 1 to 4
																					"B14001_006", # Enrolled in grade 5 to 8
																					"B14001_007"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(EnrolPK12 = B14001_003 + B14001_004 + B14001_005 + B14001_006 + B14001_007) %>%
	select(City, EnrolPK12) %>%
  left_join(Chelsea.MA, MA.Enrol.ch, by="City")

Chelsea.MA <- cbind(MA.Enrol.ch)

```
* The total number of students, who enrolled in preschools to 12 grade levels in `r Chelsea.MA$City` schools is `r Chelsea.MA$EnrolPK12`.\

\


## Employment
\


### Number of Jobs within Community Boundaries
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

########################################################################################################################################

                                                #----------------------#
                                                #       EMPLOYMENT     #
                                                #----------------------#


##########################################    Number of Jobs within Community Boundaries   #############################################
MA.Num.Jobs.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B08008_003",
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME,
         NumJobs = B08008_003) %>% 
	select(City, NumJobs) %>%
  left_join(Chelsea.MA, MA.Num.Jobs.ch, by="City")

Chelsea.MA <- cbind(MA.Num.Jobs.ch)
```
* The number of jobs within community boundaries in `r Chelsea.MA$City` is `r Chelsea.MA$NumJobs`.\

Followed is the map of Number of Jobs within Community Boundaries of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}

## MAP

ch.MA.job <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B08008_003",
                     areas = area,
                     summary_level = "block group")

ch.job.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = 'B08008_003', 
													 keep_geo_vars = T, geometry = TRUE) %>%
	rename(NumJobs = B08008_003E) 

chelsea.job <- merge(ch.job.get, ch.MA.job, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.job) + tm_polygons("NumJobs", style="jenks", palette="Reds", border.col = "darkgray", title="Number of Jobs") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")
```

\


### Labor Force (Total number, participation)
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
############################################# Labor Force (Total number, participation)  ####################################

MA.Labors.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>% 
  mutate(LabForce = B23025_002,
	       LabForcePer = B23025_002/B23025_001,
	       CivLabForce = B23025_003,
	       CivLabForcePer = B23025_003/B23025_001,
	       Military = B23025_006,
	       MilitaryPer = 	B23025_006/B23025_001,
	       TotalWorkers = B23025_001) %>%
	select(City, LabForce, LabForcePer, CivLabForce, CivLabForcePer, Military, MilitaryPer, TotalWorkers)  %>%
  left_join(Chelsea.MA, MA.Labors.ch, by="City")

Chelsea.MA <- cbind(MA.Labors.ch)
```
* The number of labor force, who are 16 years and older in `r Chelsea.MA$City` is 63866 which is `r round(Chelsea.MA$LabForcePer,2)` of total number of labors of which 63790 are civilian labor forces and `r Chelsea.MA$Military` are armed labor forces.\

Followed is the map of Labor Force of the city.\
```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP

ch.MA.labors <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"),
                     areas = area,
                     summary_level = "block group")

ch.labors.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B23025_002", # Number of Labor Force 16 years and over
														              "B23025_003", # Number of Civilian Labor Force 16 years and over
														              "B23025_006", # Number of Armed Forces 16 years and over
														              "B23025_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(LabForce = B23025_002E,
	       LabForcePer = B23025_002E/B23025_001E,
	       CivLabForce = B23025_003E,
	       CivLabForcePer = B23025_003E/B23025_001E,
	       Military = B23025_006E,
	       MilitaryPer = 	B23025_006E/B23025_001E,
	       TotalWorkers = B23025_001E) 

chelsea.labors <- merge(ch.labors.get, ch.MA.labors, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.labors) + tm_polygons("LabForce", style="jenks", palette="seq", border.col = "darkgray", title="Number of Labors") + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"), basemaps = "Stamen.TonerLite")
```

\

### Employed and Unemployed
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#####################################################    Employed and Unemployed   ####################################

MA.Emp.Unemp.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(EmpRate = B23025_004/B23025_003,
	       UnempRate = B23025_005/B23025_003,
	       EmployedCLF = B23025_004,
	       UnemployedCLF = B23025_005) %>%
	select(City ,EmpRate, UnempRate, EmployedCLF, UnemployedCLF) %>%
  left_join(Chelsea.MA, MA.Emp.Unemp.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.Unemp.ch)

```
* The rate of employment in `r Chelsea.MA$City` is `r round(Chelsea.MA$EmpRate,2)*100`%.\
* The rate of unemployment in `r Chelsea.MA$City` is `r round(Chelsea.MA$UnempRate,2)*100`%.\

Followed is Employed and Unemployed map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.emp <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"),
                     areas = area,
                     summary_level = "block group")

ch.emp.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B23025_003", # Number of civilian Labor Force 16 years and over
														              "B23025_004", # Number of Employed individuals 16 years and over
														              "B23025_005"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
	mutate(EmpRate_BG = B23025_004E/B23025_003E,
	       UnempRate_BG = B23025_005E/B23025_003E,
	       EmployedCLF_BG = B23025_004E,
	       UnemployedCLF_BG = B23025_005E) 

chelsea.emp <- merge(ch.emp.get, ch.MA.emp, by.x = 'NAME.y', by.y='NAME')

tm_shape(chelsea.emp) + tm_polygons(c("EmpRate_BG","UnempRate_BG"), style="jenks", palette=list("Greens","seq"), border.col = "darkgray", title=c("Employment rate","Unemployment rate")) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tm_layout(legend.position = c("left","bottom"))

```

\


### Major Employers by NCAIS Code
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

################################    Major Employers by NCAIS Code    ##########################################
MA.Emp.NCAIS.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(MaleNCAIS = C24030_002,
	       FemaleNCAIS = C24030_029,
	       MaleNCAISPer = C24030_002/C24030_001,
	       FemaleNCAISPer = C24030_029/C24030_001) %>%
	select(City , MaleNCAIS, FemaleNCAIS, MaleNCAISPer, FemaleNCAISPer) %>%
  left_join(Chelsea.MA, MA.Emp.NCAIS.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.NCAIS.ch)

```
* Number of male by industry for the civilian employed in `r Chelsea.MA$City` is `r Chelsea.MA$MaleNCAIS` which is `r round(Chelsea.MA$MaleNCAISPer,2)` of population, who are 16 years and over.\
* Number of female by industry for the civilian employed in `r Chelsea.MA$City` is `r Chelsea.MA$FemaleNCAIS` which is `r round(Chelsea.MA$FemaleNCAISPer,2)` of population, who are 16 years and over.\

Followed is the map of the Major Employers by NCAIS Code of the city.\
```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.majorEmp <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"),
                     areas = area,
                     summary_level = "block group")

ch.majorEmp.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("C24030_002", # Number of male by industry for the civilian employed, 16 years and over
														              "C24030_029", # Number of female by industry for the civilian employed, 16 years and over
														              "C24030_001"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(MaleNCAIS_BG = C24030_002E,
	       FemaleNCAIS_BG = C24030_029E,
	       MaleNCAISPer_BG = C24030_002E/C24030_001E,
	       FemaleNCAISPer_BG = C24030_029E/C24030_001E) 

chelsea.majorEmp <- merge(ch.majorEmp.get, ch.MA.majorEmp, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.majorEmp) + tm_polygons(c("MaleNCAIS_BG","FemaleNCAIS_BG"), style="jenks", palette=list("Greens","seq"), border.col = "darkgray", title=c("MaleNCAIS","FemaleNCAIS")) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tm_layout(legend.position = c("left","bottom"))

```

\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
tm_shape(chelsea.majorEmp) + tm_polygons(c("MaleNCAISPer_BG","FemaleNCAISPer_BG"), style="jenks", palette=list("Blues","Reds"), border.col = "darkgray", title=c("MaleNCAIS Proportion","FemaleNCAIS Proportion")) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tm_layout(legend.position = c("left","bottom"))
```




\

### Top Industries by NCAIS Code
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
######################################    Top Industries by NCAIS Code   ##################################################

MA.Industries.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("C24030_003", # Agriculture, forestry, fishing and hunting, and mining (Male)
														              "C24030_030", # Agriculture, forestry, fishing and hunting, and mining (Female)
														              "C24030_006", # Construction (Male)
														              "C24030_033", # Construction (Female)
														              "C24030_007", # Manufacturing (Male)
														              "C24030_034", # Manufacturing (Female)
														              "C24030_008", # Wholesale trade (Male)
														              "C24030_035", # Wholesale trade (Female)
														              "C24030_009", # Retail trade (Male)
														              "C24030_036", # Retail trade (Female)
														              "C24030_010", # Transportation and warehousing, and utilities (Male)
														              "C24030_037", # Transportation and warehousing, and utilities (Female)
														              "C24030_013", # Information (Male)
														              "C24030_040", # Information (Female)
														              "C24030_014", # Finance and insurance, and real estate, and rental and leasing (Male)
														              "C24030_041", # Finance and insurance, and real estate, and rental and leasing (Female)
														              "C24030_017", # Professional, scientific, and management, and administrative, and waste management services (Male)
														              "C24030_044", # Professional, scientific, and management, and administrative, and waste management services (Female)
														              "C24030_021", # Educational services, and health care and social assistance (Male)
														              "C24030_048", # Educational services, and health care and social assistance (Female)
														              "C24030_024", # Arts, entertainment, and recreation, and accommodation and food services (Male)
														              "C24030_051", # Arts, entertainment, and recreation, and accommodation and food services (Female)
														              "C24030_027", # Other services, except public administration (Male)
														              "C24030_054", # Other services, except public administration (Female)
														              "C24030_028", # Public administration (Male)
														              "C24030_055", # Public administration (Female)
														              "C24030_001"), # Total,
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(Agriculture = (C24030_003 + C24030_030)/C24030_001,
	       Construction = (C24030_006 + C24030_033)/C24030_001,
	       Manufacturing = (C24030_007 + C24030_034)/C24030_001,
	       WholesaleTrade = (C24030_008 + C24030_035)/C24030_001,
	       RetailTrade = (C24030_009 + C24030_036)/C24030_001,
	       Transportation = (C24030_010 + C24030_037)/C24030_001,
	       Information = (C24030_013 + C24030_040)/C24030_001,
	       Finance_Ins = (C24030_014 + C24030_041)/C24030_001,
	       Professional = (C24030_017 + C24030_044)/C24030_001,
	       Educ_Health_SocSvcs = (C24030_021 + C24030_048)/C24030_001,
	       RecreationEtc = (C24030_024 + C24030_051)/C24030_001,
	       OtherIndustries = (C24030_027 + C24030_054)/C24030_001,
	       PublicAdmin = (C24030_028 + C24030_055)/C24030_001) %>%
	select(City,Agriculture,Construction,Manufacturing,WholesaleTrade,RetailTrade,Transportation,Information,
	       Finance_Ins,Professional,Educ_Health_SocSvcs,RecreationEtc,OtherIndustries,PublicAdmin) %>%
  left_join(Chelsea.MA, MA.Industries.ch, by="City")

Chelsea.MA <- cbind(MA.Industries.ch)

```
* The percentage of people, who are in agriculture, forestry, fishing, hunting, and mining in `r Chelsea.MA$City` is `r (round(Chelsea.MA$Agriculture,4))*100`%.\

* The percentage of people, who are in construction in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Construction,4))*100`%".\

* The percentage of people, who are in manufacturing in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Manufacturing,4))*100`%.\

* The percentage of people, who are in wholesale trade in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$WholesaleTrade,4))*100`%.\

* The percentage of people, who are in retail trade in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$RetailTrade,4))*100`%.\

* The percentage of people, who are in transportation and warehousing, and utilities in`r Chelsea.MA$City`state is`r (round(Chelsea.MA$Transportation,4))*100`%.\

* The percentage of people, who are in information in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Information,4))*100`%.\

* The percentage of people, who are in finance and insurance, and real estate, and rental and leasing in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Finance_Ins,4))*100`%.\

* The percentage of people, who are in professional, scientific, and management, and administrative, and waste management services in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Professional,4))*100`%.\

* The percentage of people, who are in educational services, and health care and social assistance in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$Educ_Health_SocSvcs,4))*100`%.\

* The percentage of people, who are in arts, entertainment, and recreation, and accommodation and food services in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$RecreationEtc,4))*100`%.\

* The percentage of people, who are in other services, except public administration in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$OtherIndustries,4))*100`%.\

* The percentage of people, who are in Public administration in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$PublicAdmin,4))*100`%.\
\

### Earning Breakdown 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
###########################    Earning Breakdown   ####################################
MA.Earning.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B20017_001",
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(MedEarning = B20017_001) %>%
	select(City,MedEarning) %>%
  left_join(Chelsea.MA, MA.Earning.ch, by="City")

Chelsea.MA <- cbind(MA.Earning.ch)
```
* The median earning in `r Chelsea.MA$City` is 34763 Dollar.\

Followed is the Median Earning map of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="",results='hide'}
## MAP
ch.MA.earning <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = "B20017_001",
                     areas = area,
                     summary_level = "block group")

ch.earning.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = 'B20017_001', 
													 keep_geo_vars = T, geometry = TRUE) %>%
  mutate(MedEarning = B20017_001E)

chelsea.earning <- merge(ch.earning.get, ch.MA.earning, by.x = 'NAME.y', by.y='NAME')

make_dollar <- function(x, digits = 0) {
  paste0("$", formatC(x, digits = digits, format = "f", big.mark = ","))
}


tm_shape(chelsea.earning) + tm_polygons("MedEarning" , palette="seq", style = "jenks", title = "Median Earning", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,view.legend.position = c("right", "bottom"),basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") 


```

\


### Employee Age
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################    Employee Age   #############################################################

MA.Emp.Age.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23001_005","B23001_007","B23001_012","B23001_014","B23001_019","B23001_021","B23001_026","B23001_028", # Age 29 or younger male
								"B23001_033","B23001_035","B23001_040","B23001_042","B23001_047","B23001_049", # Age 30 to 54 male
								"B23001_054","B23001_056","B23001_061","B23001_063","B23001_068","B23001_070","B23001_075","B23001_080","B23001_085", # Age 55 or older male
								"B23001_091","B23001_093","B23001_098","B23001_100","B23001_105","B23001_107","B23001_112","B23001_114", # Age 29 or younger female
								"B23001_119","B23001_121","B23001_126","B23001_128","B23001_133","B23001_135", # Age 30 to 54 female
								"B23001_140","B23001_142","B23001_147","B23001_149","B23001_154","B23001_156","B23001_161","B23001_166","B23001_171", # Age 55 or older female
														              "B23001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(AgeEmpU29 = B23001_005+B23001_007+B23001_012+B23001_014+B23001_019+B23001_021+B23001_026+B23001_028+
	         B23001_091+B23001_093+B23001_098+B23001_100+B23001_105+B23001_107+B23001_112+B23001_114,
	       AgeEmp3054 = B23001_033+B23001_035+B23001_040+B23001_042+B23001_047+B23001_049+
	         B23001_119+B23001_121+B23001_126+B23001_128+B23001_133+B23001_135,
	       AgeEmpO55 = B23001_054+B23001_056+B23001_061+B23001_063+B23001_068+B23001_070+B23001_075+B23001_080+B23001_085+
	        B23001_140+B23001_142+B23001_147+B23001_149+B23001_154+B23001_156+B23001_161+B23001_166+B23001_171,
         
         AgeEmpU29Per_BG = (B23001_005+B23001_007+B23001_012+B23001_014+B23001_019+B23001_021+B23001_026+B23001_028+
	         B23001_091+B23001_093+B23001_098+B23001_100+B23001_105+B23001_107+B23001_112+B23001_114)/B23001_001,
	        AgeEmp3054Per_BG = (B23001_033+B23001_035+B23001_040+B23001_042+B23001_047+B23001_049+
	         B23001_119+B23001_121+B23001_126+B23001_128+B23001_133+B23001_135)/B23001_001,
	       AgeEmpO55Per_BG = (B23001_054+B23001_056+B23001_061+B23001_063+B23001_068+B23001_070+B23001_075+B23001_080+B23001_085+
	        B23001_140+B23001_142+B23001_147+B23001_149+B23001_154+B23001_156+B23001_161+B23001_166+B23001_171)/B23001_001) %>%

	select(City ,AgeEmpU29, AgeEmp3054, AgeEmpO55, AgeEmpU29Per_BG,AgeEmp3054Per_BG,AgeEmpO55Per_BG) %>%
  left_join(Chelsea.MA, MA.Emp.Age.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.Age.ch)

```
* The number of workers, who are younger than 29 years old in `r Chelsea.MA$City` is `r Chelsea.MA$AgeEmpU29` which is `r (round(Chelsea.MA$AgeEmpU29Per,4))*100`% of total number of workers.\

* The number of workers, who are between 30 and 54 years old in `r Chelsea.MA$City` is `r Chelsea.MA$AgeEmp3054` which is `r (round(Chelsea.MA$AgeEmp3054Per,4))*100`% of total number of workers.\

* The number of workers, who are older than 55 years old in `r Chelsea.MA$City` is `r Chelsea.MA$AgeEmpO55` which is `r (round(Chelsea.MA$AgeEmpO55Per,4))*100`% of total number of workers.\

\


### Employee Race
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################      Employee Race    ############################################################
MA.Emp.Race.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("C23002A_007","C23002A_012","C23002A_020","C23002A_025","C23002A_005","C23002A_018", # White alone
														              "C23002B_007","C23002B_012","C23002B_020","C23002B_025","C23002B_005","C23002B_018", # Black or African American alone
														              "C23002D_007","C23002D_012","C23002D_020","C23002D_025","C23002D_005","C23002D_018", # Asian alone
														              "C23002I_007","C23002I_012","C23002I_020","C23002I_025","C23002I_005","C23002I_018", # Hispanic or Latino alone
														              "C23002G_007","C23002G_012","C23002G_020","C23002G_025","C23002G_005","C23002G_018",# Two or more races
														              "B23001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(WhiteEmp = C23002A_007+C23002A_012+C23002A_020+C23002A_025+C23002A_005+C23002A_018,
	       BlackEmp = C23002B_007+C23002B_012+C23002B_020+C23002B_025+C23002B_005+C23002B_018,
	       AsianEmp = C23002D_007+C23002D_012+C23002D_020+C23002D_025+C23002D_005+C23002D_018,
	       HispanicEmp = C23002I_007+C23002I_012+C23002I_020+C23002I_025+C23002I_005+C23002I_018,
	       TwoOrMoreEmp = C23002G_007+C23002G_012+C23002G_020+C23002G_025+C23002G_005+C23002G_018,
         WhiteEmpPer = (C23002A_007+C23002A_012+C23002A_020+C23002A_025+C23002A_005+C23002A_018)/B23001_001,
	       BlackEmpPer = (C23002B_007+C23002B_012+C23002B_020+C23002B_025+C23002B_005+C23002B_018)/B23001_001,
	       AsianEmpPer = (C23002D_007+C23002D_012+C23002D_020+C23002D_025+C23002D_005+C23002D_018)/B23001_001,
	       HispanicEmpPer = (C23002I_007+C23002I_012+C23002I_020+C23002I_025+C23002I_005+C23002I_018)/B23001_001,
	       TwoOrMoreEmpPer = (C23002G_007+C23002G_012+C23002G_020+C23002G_025+C23002G_005+C23002G_018)/B23001_001) %>%
	select(City ,WhiteEmp, BlackEmp, AsianEmp, HispanicEmp, TwoOrMoreEmp,
	       WhiteEmpPer, BlackEmpPer, AsianEmpPer, HispanicEmpPer, TwoOrMoreEmpPer) %>%
  left_join(Chelsea.MA, MA.Emp.Race.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.Race.ch)

```

* The number of white workers in `r Chelsea.MA$City` is `r Chelsea.MA$WhiteEmp` which is `r (round(Chelsea.MA$WhiteEmpPer,4))*100`% of total number of workers.\
* The number of black workers in `r Chelsea.MA$City` is `r Chelsea.MA$BlackEmp` which is `r (round(Chelsea.MA$BlackEmpPer,4))*100`% of total number of workers.\
* The number of asian workers in `r Chelsea.MA$City` is `r Chelsea.MA$AsianEmp` which is `r (round(Chelsea.MA$AsianEmpPer,4))*100`% of total number of workers.\
* The number of hispanic or latino workers in `r Chelsea.MA$City` is `r Chelsea.MA$HispanicEmp` which is `r (round(Chelsea.MA$HispanicEmpPer,4))*100`% of total number of workers.\
* The number of workers, who have two or more races in `r Chelsea.MA$City` is `r Chelsea.MA$TwoOrMoreEmp` which is `r (round(Chelsea.MA$TwoOrMoreEmpPer,4))*100`% of total number of workers.\
\


### Employee Education
\
```{r message=FALSE, warning=FALSE, ,echo=FALSE, results='hide', comment=""}
#############################################   Employee Education    ########################################################

MA.Educ.Emp.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B16010_003", # Less than high school graduate in labor force
														              "B16010_016", # High school graduate in labor force 
														              "B16010_029", # Some college or associate's degree in labor force
														              "B16010_042",
														              "B16010_001"), # Total
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(LessThanHSLabor = B16010_003,
	       HSGradLabor = B16010_016,
	       SomeCollLabor = B16010_029,
	       BachOrHigherLabor = B16010_042,
	       LessThanHSLaborPer = LessThanHSLabor/B16010_001,
	       HSGradLaborPer = HSGradLabor/B16010_001,
	       SomeCollLaborPer = SomeCollLabor/B16010_001,
	       BachOrHigherLaborPer = BachOrHigherLabor/B16010_001) %>%
	select(City ,LessThanHSLabor, HSGradLabor, SomeCollLabor, BachOrHigherLabor,
	       LessThanHSLaborPer, HSGradLaborPer, SomeCollLaborPer, BachOrHigherLaborPer) %>%
  left_join(Chelsea.MA, MA.Educ.Emp.ch, by="City")

Chelsea.MA <- cbind(MA.Educ.Emp.ch)
```
* The number of workers, who have less than high school degree in `r Chelsea.MA$City` is `r Chelsea.MA$LessThanHSLabor` which is `r (round(Chelsea.MA$LessThanHSLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have high school degree in `r Chelsea.MA$City` is `r Chelsea.MA$HSGradLabor` which is `r (round(Chelsea.MA$HSGradLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have some college or associates degree in `r Chelsea.MA$City` is `r Chelsea.MA$SomeCollLabor` which is `r (round(Chelsea.MA$SomeCollLaborPer,4))*100`% of total number of workers.\
* The number of workers, who have bachelors degree or higher in `r Chelsea.MA$City` is `r Chelsea.MA$BachOrHigherLabor` which is `r (round(Chelsea.MA$BachOrHigherLaborPer,4))*100`% of total number of workers.\

\

### Employee Sex
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#############################################    Employee Sex   #############################################################

MA.Emp.Sex.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B23001_005", # Employed males
														              "B23001_007", 
														              "B23001_012",
														              "B23001_014",
														              "B23001_019",
														              "B23001_021",
														              "B23001_026",
														              "B23001_028",
														              "B23001_033",
														              "B23001_035",
														              "B23001_040",
														              "B23001_042",
														              "B23001_047",
														              "B23001_049",
														              "B23001_054",
														              "B23001_056",
														              "B23001_061",
														              "B23001_063",
														              "B23001_068",
														              "B23001_070",
														              "B23001_075",
														              "B23001_080",
														              "B23001_085",
														              "B23001_091", # Employed females
														              "B23001_093",
														              "B23001_098",
														              "B23001_100",
														              "B23001_105",
														              "B23001_107",
														              "B23001_112",
														              "B23001_114",
														              "B23001_119",
														              "B23001_121",
														              "B23001_126",
														              "B23001_128",
														              "B23001_133",
														              "B23001_135",
														              "B23001_140",
														              "B23001_142",
														              "B23001_147",
														              "B23001_149",
														              "B23001_154",
														              "B23001_156",
														              "B23001_161",
														              "B23001_166",
														              "B23001_171",
														              "B23001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(EmpMale = B23001_005 + B23001_007 + B23001_012 + B23001_014 + B23001_019 + B23001_021 + B23001_026 + B23001_028 + B23001_033 + B23001_035 + B23001_040 + B23001_042 + B23001_047 + B23001_049 + B23001_054 + B23001_056 + B23001_061 + B23001_063 + B23001_068+ B23001_070 + B23001_075 + B23001_080 + B23001_085,
	  EmpFemale = B23001_091 + B23001_093 + B23001_098 + B23001_100 + B23001_105 + B23001_107 + B23001_112 + B23001_114 + B23001_119 + B23001_121 + B23001_126+ B23001_128 + B23001_133 + B23001_135 + B23001_140 + B23001_142 + B23001_147 + B23001_149 + B23001_154 + B23001_156 + B23001_161 + B23001_166 + B23001_171,
	  TotalEmp = EmpMale + EmpFemale,
	  EmpMalePer = EmpMale/	B23001_001,
	  EmpFemalePer = EmpFemale/B23001_001) %>%
	select(City, EmpMale, EmpFemale, TotalEmp, EmpMalePer, EmpFemalePer) %>%
  left_join(Chelsea.MA, MA.Emp.Sex.ch, by="City")

Chelsea.MA <- cbind(MA.Emp.Sex.ch)


```
* The number of male workers in `r Chelsea.MA$City` is `r Chelsea.MA$EmpMale` which is `r (round(Chelsea.MA$EmpMalePer,4))*100`% of total number of workers.\
* The number of female workers in `r Chelsea.MA$City` is `r Chelsea.MA$EmpFemale` which is `r (round(Chelsea.MA$EmpFemalePer,4))*100`% of total number of workers.\


\

## Healthcare
\

### Number of Hospitals
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

Chelsea.MA$Hospitals <- 4
```


* `r Chelsea.MA$City` has 4 hospital.(https://www.ahd.com/)

\

###	Number of Nursing Homes 
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$NursingHomes <- 9
```


* `r Chelsea.MA$City` has 9 nursing homes. (https://nursinghomedirectory.com/)


## Municipal Finances
\

###	Revenue Streams
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$RevenueGeneralFundTotalFY19 <- 52875844
Chelsea.MA$RevenueEnvironmentalProtectionDivisionTotalFY19 <- 20472833
Chelsea.MA$RevenueAviationTotalFY19 <- 45366180
Chelsea.MA$RevenueParkingEnterpriseFY19 <- 5768755
Chelsea.MA$TotalRevenueBudgetFY19 <- 124483612
Chelsea.MA$RevenueBoardOfAssessorsFY19 <- 692000
Chelsea.MA$RevenueCityClerkOfficeFY19 <- 2560712
Chelsea.MA$RevenueManchesterEconomicDevelopmentOfficeF19 <- 200
Chelsea.MA$RevenueCitySolicitorOfficeF19 <- 600000
Chelsea.MA$RevenueFinanceDepartmentF19 <- 6776458
Chelsea.MA$RevenueInformationSystemsFY19 <- 195000
Chelsea.MA$RevenueHumanResourcesFY19 <- 6000
Chelsea.MA$RevenuePlanningCommunityDevelopmentFY19 <- 3000000 
Chelsea.MA$RevenueFacilitiesDivisionFY19 <- 5771098
Chelsea.MA$RevenueTaxCollectorOfficeFY19 <- 20790116
Chelsea.MA$RevenueCentralFleetManagementFY19 <- 45000
Chelsea.MA$RevenueFireDepartmentFY19 <- 881771
Chelsea.MA$RevenuePoliceDepartmentFY19 <- 1335169
Chelsea.MA$RevenueHealthDepartmentCityFY19 <- 241000
Chelsea.MA$RevenueHealthDepartmentSchoolFY19 <- 2414511
Chelsea.MA$RevenueHighwayDepartmentFY19 <- 4525749
Chelsea.MA$RevenueWelfareDepartmentFY19 <- 15000
Chelsea.MA$RevenueParksRecreationsCemeteriesFY19 <- 3021810
Chelsea.MA$RevenueSeniorServicesFY19 <- 4250
```
* The total revenues for general fund for Manchester city is $52,875,844 in fiscal year 2019, which contains the following items: Board of Assessors with 692000 Dollar, City Clerk's Office with 2,560,712 Dollar, Manchester Economic Development Office with 200 Dollar, City Solicitor's Office with 600,000 Dollar, Finance Department with 6,776,458 Dollar, Information Systems with 195,000 Dollar, Human Resources with 6,000 Dollar, Planning & Community Development with 3,000,000 Dollar, Facilities Division with 5,771,098 Dollar, Tax Collector's Office with 20,790,116 Dollar, Central Fleet Management with 45,000 Dollar, Fire Department with 881,771, Police Department with 1,335,169 Dollar, Health Department - City with 241,000 Dollar, Health Department - School with 2,414,511 Dollar, Highway Department with 4,525,749 Dollar, Welfare Department with 15,000, Parks, Recreations & Cemeteries with 3,021,810 dollar, and Senior Services with 4,250 Dollar. The total expenditures for environmental protection division is 20,472,833 Dollar, for Aviation is 45,366,180 Dollar, and for parking enterprise is 5,768,755 Dollar.(https://www.manchesternh.gov/Portals/2/Departments/finance/FiscalYear2019BudgetBook.pdf)

\

###	Major Expense Drivers
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$ExpendituresGeneralFundTotalFY19 <- 153355956
Chelsea.MA$ExpendituresEnvironmentalProtectionDivisionFY19 <- 14192485
Chelsea.MA$ExpendituresAviationFY19 <- 45286500
Chelsea.MA$ExpendituresParkingEnterpriseFY19 <- 5768755
Chelsea.MA$ExpendituresAldermenFY19 <- 70000
Chelsea.MA$ExpendituresBoardOfAssessorsFY19 <- 612629
Chelsea.MA$ExpendituresCityClerkOfficeFY19 <- 990419
Chelsea.MA$ExpendituresManchesterEconomicDevelopmentOfficeFY19 <- 139151
Chelsea.MA$ExpendituresCitySolicitorOfficeFY19 <- 1268682
Chelsea.MA$ExpendituresFinanceDepartmentFY19 <- 952853
Chelsea.MA$ExpendituresInformationSystemsFY19 <- 1589242
Chelsea.MA$ExpendituresDebtServiceFY19 <- 17212645
Chelsea.MA$ExpendituresMayorOfficeFY19 <- 235784
Chelsea.MA$ExpendituresNonDepartmentalExpensesFY19 <- 43158644
Chelsea.MA$ExpendituresCivicContributionsFY19 <- 161640
Chelsea.MA$ExpendituresOfficeOfYouthServicesFY19 <- 591232
Chelsea.MA$ExpendituresHumanResourcesFY19 <- 776763
Chelsea.MA$ExpendituresPlanningCommunityDevelopmentFY19 <- 2032556
Chelsea.MA$ExpendituresFacilitiesDivisionFY19 <- 6689148
Chelsea.MA$ExpendituresTaxCollectorOfficeFY19 <- 512495
Chelsea.MA$ExpendituresCentralFleetManagementFY19 <- 3188433
Chelsea.MA$ExpendituresFireDepartmentFY19 <- 19732544
Chelsea.MA$ExpendituresPoliceDepartmentFY19 <- 25259730
Chelsea.MA$ExpendituresHealthDepartmentCityFY19 <- 1452041
Chelsea.MA$ExpendituresHealthDepartmentSchoolFY19 <- 1502487
Chelsea.MA$ExpendituresHighwayDepartmentFY19 <- 16171283
Chelsea.MA$ExpendituresWelfareDepartmentFY19 <- 926331
Chelsea.MA$ExpendituresParksRecreationsCemeteriesFY19 <- 4285831
Chelsea.MA$ExpendituresMPTSFY19 <- 451253
Chelsea.MA$ExpendituresLibraryDepartmentFY19 <- 1998154
Chelsea.MA$ExpendituresSeniorServicesFY19 <- 222007
```

* The total amount of general fund of expenditures for `r Chelsea.MA$City` is $153,355,956 in Fiscal Year 2019 and the major expense driver is related to police department, which is 25,259,730 Dollar. The other expenditures include aldermen with 70,000 Dollar, board of assessors with 612,629 Dollar, City Clerk's Office with 990,419 Dollar, Manchester Economic Development Office with 139,151 Dollar, City Solicitor's Office with 1,268,682 Dollar, Finance Department with 952,853 Dollar, Information Systems with 1,589,242 Dollar, Debt Service with 17,212,645 Dollar,Mayor's Office with 235,784 Dollar, Non-Departmental Expenses with 43,158,644 Dollar, Civic Contributions with 161,640 Dollar, Office of Youth Services with 591,232 Dollar, Human Resources with 776,763 Dollar, Planning & Community Development with 2,032,556 Facilities Division with 6,689,148 Dollar, Tax Collector's Office with 512,495 Dollar, Central Fleet Management with 3,188,433 Dollar, Fire Department with 19,732,544 Dollar, Health Department - City with 1,452,041 Dollar, Health Department - School with 1,502,487 Dollar, Highway Department with 1,6171,283 Dollar, Welfare Department with 926,331, Parks, Recreations & Cemeteries with 4,285,831 dollar, MPTS with 451,253 Dollar, Library Department with 1,998,154 Dollar, and Senior Services with 222,007 Dollar. The total expenditures for environmental protection division is 14,192,485 Dollar, for Aviation is 45,286,500 Dollar, and for parking enterprise is 5,768,755 Dollar.(https://www.manchesternh.gov/Portals/2/Departments/finance/FiscalYear2019BudgetBook.pdf)


\

### FY20 Budget  Projected Deficits 
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$TotalBudgetFY20 <- 332679199
Chelsea.MA$BudgetEducationFY20 <- 176036978
Chelsea.MA$BudgetDebtServiceFY20 <- 17212645
Chelsea.MA$BudgetGeneralGovernmentFY20 <- 17622886
Chelsea.MA$BudgetHealthWelfareFY20 <- 3928432
Chelsea.MA$BudgetCultureRecreationFY20 <- 6519400
Chelsea.MA$BudgetNonDepartmentalBenefitsFY20 <- 44620735
Chelsea.MA$BudgetPublicSafetyFY20 <- 46257867
Chelsea.MA$BudgetHighwayStreetsFY20 <- 20328488
Chelsea.MA$BudgetEconomicDevelopmentFY20 <- 151768 
```

* The total budget for Manchester city in New Hampshire for fiscal year 2020 is 332,679,199 Dollar, which contains the following items:
Education with $176,036,978, Debt service with 17,212,645 Dollar, general government with 17,622,886 Dollar, health and welfare with 3,928,432 Dollar, culture and recreation with 6,519,400 Dollar, non-departmental benefits with 44,620,735 Dollar, public safety with 46,257,867 Dollar, highway and streets with 20,328,488 Dollar, and economic development with 151,768 Dollar.(https://www.manchesternh.gov/Departments/Finance/Budget-Info)


\


## Infrastructure
\

### Presence of Nearby Ports, Airports, Major Rail Facilities, or Intermodal Freight Facilities
\

* Manchester has an Airport, which is called Manchester-Boston Regional Airport (MHT) and it is located less than fifty miles north of Boston, Massachusetts and less than an hour's drive from the region's most popular ski areas, scenic beaches and peaceful lakefront resorts. Also, another Airport is located 49 miles southeast of Manchester, which is Boston Logan International Airport and it provides service to 76 destinations. 
Manchester city by using Boston and Maine Railroad can provide motor freight service to many cities within a 200-mile radius contain New York City. United Parcel Service, Airborne Express, and Federal Express deliver daily small package air freight service from the Manchester - Boston Regional Airport in Manchester to other points. 
Manchester is located in 45 minutes of Portsmouth, that is home to the Port of New Hampshire. The Portsmouth port is a federally designated Foreign Trade Zone. (https://www.yourmanchesternh.com/Greater-Manchester-Profile/Transportation)


\

### Public Transport Reliability and Scope 
\

* The bus service in Manchester is managed by Manchester Transit Authority, which provide connection between city and Nashua and Concord. Also, Manchester has MTA system, which contains a free shuttle that works from the Millyard area through Downtown. Moreover, Boston Express provided scheduled bus service to Boston's South Station and Logan International Airport from downtown Manchester. The other option for public transportation in the city is Peddle, which is the first pedicab in the Manchester. Peddle move in Manchesters downtown, the Millyard and Ballpark district. All cabs are all 100% carbon emission free and operated by professional pedicab operators licensed with the city of Manchester, NH. These three-passenger vehicles are equipped with safety belts, headlights, and flashing tail lights.(https://www.yourmanchesternh.com/Greater-Manchester-Profile/Transportation)

\

### Internet Access
\

* According to the following website, 2.6 percent of residents in Manchester (2,000 residents total) have one option for home residential broadband service, or in some cases, people dont have any option. The most common wired broadband technology types in Manchester are Cable (98.76 percent coverage) and Satellite (close to one hundred percent coverage). The most widespread internet option in this city is Viasat Internet with the fastest speed mentioned with 100Mbps. It can coverage about one hundred percent of Manchester residents. The other option is HughesNet, which is available for close to one hundred percent of residents in the city. The fastest speed for it, is offered up to 25 Mbps. Overall, anything over 10 Mbps will be sufficient to stream standard definition video over WiFi, but may become an issue for large households or high-bandwidth apps such as video conferencing, cloud apps, and multiplayer gaming. Manchester is the 11th most connected city in New Hampshire and its fastest zip code for May 2020 is 03102.(https://broadbandnow.com/New-Hampshire/Manchester)


\

## Food Insecurity
\

\

### Number of Grocery Stores
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$NumGrocery <- 73
```
* `r Chelsea.MA$City` has 73 Grocery Stores.(https://www.city-data.com/city/Manchester-New-Hampshire.html)

\

### SNAP Recipients 
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
##########################################################################################################################

                                                #----------------------#
                                                #    FOOD INSECURITY   #
                                                #----------------------#

####################################################  SNAP Recipients  ###################################################         

MA.Snap.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B22001_002", # Household received Food Stamps/SNAP in the past 12 months
														"B22001_001"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  	mutate(SnapRec = B22001_002/B22001_001) %>%
	select(City ,SnapRec) %>%
  left_join(Chelsea.MA, MA.Snap.ch, by="City")

Chelsea.MA <- cbind(MA.Snap.ch)

#######################################################################################################################################

```
* The percent of households, who received Food Stamps/SNAP in the past 12 months in `r Chelsea.MA$City` state is `r (round(Chelsea.MA$SnapRec,4))*100`%.\

\

## Housing
\

### Proportion of Renters to Owners
\

### Home Values
\
```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

                                                #----------------------#
                                                #       HOUSING        #
                                                #----------------------#

######################   Proportion of Renters to Owners, Home Values   ########################################

MA.Housing.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"), # Owner occupied
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME,
         MedianHValue = B25077_001,
	       AvgHValue = B25082_001/B25003_002) %>%
	mutate(RentersPer = B25009_010/B25009_001,
				 HomeOwnPer = B25009_002/B25009_001,
				 RentersToOwners = B25009_010/B25009_002) %>%
	select(City,RentersPer, HomeOwnPer, RentersToOwners, MedianHValue, AvgHValue) %>%
  left_join(Chelsea.MA, MA.Housing.ch, by="City")

Chelsea.MA <- cbind(MA.Housing.ch)

```
* The median house value in `r Chelsea.MA$City` is 217100 Dollar.\

* The average house value in `r Chelsea.MA$City` is 4453541100 Dollar.\

* The proportion of renters to owners in `r Chelsea.MA$City` is `r round(Chelsea.MA$RentersToOwners,3)`.\

* The percentage of renters in `r Chelsea.MA$City` is `r (round(Chelsea.MA$RentersPer,2))*100`%.\

* The percentage of owners in `r Chelsea.MA$City` is `r (round(Chelsea.MA$HomeOwnPer,2))*100`%.\
Followed is the map of Proportion of Renters to Owners, Median Home Values, and Average Home Values of the city.\

```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## MAP
ch.MA.housing <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"),
                     areas = area,
                     summary_level = "block group")

ch.housing.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B25009_001", # Total Occupied Housing Units
															 	"B25009_002", # Total Owner Occupied Housing Units
															 	"B25009_010", # Total Renter Occupied Housing Units
															 	"B25077_001", # Median Home Value
															 	"B25082_001", # Aggregate value
															 	"B25003_002"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(MedianHValue_BG = B25077_001E,
	       AvgHValue_BG = B25082_001E / B25003_002E) %>%
	mutate(RentersPer_BG = B25009_010E/B25009_001E,
				 HomeOwnPer_BG = B25009_002E/B25009_001E,
				 RentersToOwners_BG = B25009_010E/B25009_002E)

chelsea.housing <- merge(ch.housing.get, ch.MA.housing, by.x = 'NAME.y', by.y='NAME')


tm_shape(chelsea.housing) + tm_polygons("MedianHValue_BG" , palette="Blues", style = "quantile", title = "Median Home Value", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") + tm_layout(legend.position = c("left","bottom"))

```
\


```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
tm_shape(chelsea.housing) + tm_polygons("AvgHValue_BG" , palette="Greens", style = "quantile", title = "Average Home Value", popup.format = list(fun = make_dollar), legend.format = list(fun = make_dollar)) + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray")+tm_layout(legend.position = c("left","bottom"))
```


\


\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
tm_shape(chelsea.housing) + tm_polygons("RentersToOwners_BG" , palette="Reds", style = "quantile", title = "RentersToOwners") + tm_view(alpha = 0.85,basemaps = "Stamen.TonerLite") + tm_borders(col = "darkgray") + tm_layout(legend.position = c("left","bottom"))
```

\

### Property Tax Rates
\



```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
Chelsea.MA$PropertyTaxRate <- 24.32
```
* The 2019 tax rate is 24.32 Dollar per 1000.00 Dollar of assessed valuation in `r Chelsea.MA$City`.(https://www.manchesternh.gov/Departments/Finance/Tax-Rates)


\



\


### Duration of Occupancy
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#########################################      Duration of Occupancy    ####################################################
MA.Dur.Occ.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"),
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME,
         MedYrMovedIn = B25039_001, 
				 MedYrRentMovedIn = B25039_003,
				 MedYrOwnMovedIn = B25039_002) %>%
	select(City, MedYrMovedIn, MedYrRentMovedIn, MedYrOwnMovedIn) %>%
  left_join(Chelsea.MA, MA.Dur.Occ.ch, by="City")

Chelsea.MA <- cbind(MA.Dur.Occ.ch)
```
* The median year that a homeowner moved into their current domicile in `r Chelsea.MA$City` is `r Chelsea.MA$MedYrOwnMovedIn`.\
* The median year that a renter moved into their current domicile in `r Chelsea.MA$City` is `r Chelsea.MA$MedYrRentMovedIn`.\
Followed is the map of Duration of Occupancy of the city.\
```{r echo=FALSE, warning=FALSE, message=FALSE, comment="", results='hide'}
## MAP
ch.MA.dur <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"),
                     areas = area,
                     summary_level = "block group")

ch.dur.get <- tidycensus::get_acs(geography = "block group",
													 survey="acs5",
													 state=j,
													 county = c,
													 year = endyr,
													 output = "wide",
													 variables = c("B25039_001", # Median Year Householder Moved Into Unit by Tenure
															 	"B25039_002", # Median Year Householder Moved Into Unit by Tenure (Owner)
															 	"B25039_003"), 
													 keep_geo_vars = T, geometry = TRUE) %>%
rename(MedYrMovedIn_BG = B25039_001E, # I'm not sure if I should substract this value from 2018
				 MedYrRentMovedIn_BG = B25039_003E,
				 MedYrOwnMovedIn_BG = B25039_002E)

chelsea.dur <- merge(ch.dur.get, ch.MA.dur, by.x = 'NAME.y', by.y='NAME')



tm_shape(chelsea.dur) + tm_polygons(c("MedYrMovedIn_BG","MedYrRentMovedIn_BG","MedYrOwnMovedIn_BG"), style="jenks", palette=list("Greens","seq","Blues"), border.col = "darkgray", title=c("MedYrMovedIn","MedYrRentMovedIn","MedYrOwnMovedIn")) + tm_view(alpha = 0.85, basemaps = "Stamen.TonerLite") + tm_layout(legend.position = c("left","bottom"))
```


\

### Cost Burdened Occupants


\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}

##############################################   Cost Burdened Occupants   ##################################
MA.CostBurdened.ch <- read_acs5year(year = endyr,
                     states = j,
                     table_contents = c("B25095_006", # Household income by selected monthly owner Costs as a percentage of household income
														              # Less than $10,000 (30 to 34.9 percent)
														              "B25095_007", # Less than $10,000 (35 to 39.9 percent)
														              "B25095_008", # Less than $10,000 (40 to 49.9 percent)
														              "B25095_009", # Less than $10,000 (50 percent or more)
														              "B25095_015", # $10,000 to $19,999 (30 to 34.9 percent)
														              "B25095_016", # $10,000 to $19,999 (35 to 39.9 percent)
														              "B25095_017", # $10,000 to $19,999 (40 to 49.9 percent)
														              "B25095_018", # $10,000 to $19,999 (50 percent or more)
														              "B25095_024", # $20,000 to $34,999 (30 to 34.9 percent)
														              "B25095_025", # $20,000 to $34,999 (35 to 39.9 percent)
														              "B25095_026", # $20,000 to $34,999 (40 to 49.9 percent)
														              "B25095_027", # $20,000 to $34,999 (50 percent or more)
														              "B25095_033", # $35,000 to $49,999 (30 to 34.9 percent)
														              "B25095_034", # $35,000 to $49,999 (35 to 39.9 percent)
														              "B25095_035", # $35,000 to $49,999 (40 to 49.9 percent)
														              "B25095_036", # $35,000 to $49,999 (50 percent or more)
														              "B25095_042", # $50,000 to $74,999 (30 to 34.9 percent)
														              "B25095_043", # $50,000 to $74,999 (35 to 39.9 percent)
														              "B25095_044", # $50,000 to $74,999 (40 to 49.9 percent)
														              "B25095_045", # $50,000 to $74,999 (50 percent or more)
														              "B25095_051", # $75,000 to $99,999 (30 to 34.9 percent)
														              "B25095_052", # $75,000 to $99,999 (35 to 39.9 percent)
														              "B25095_053", # $75,000 to $99,999 (40 to 49.9 percent)
														              "B25095_054", # $75,000 to $99,999 (50 percent or more)
														              "B25095_060", # $100,000 to $149,999 (30 to 34.9 percent)
														              "B25095_061", # $100,000 to $149,999 (35 to 39.9 percent)
														              "B25095_062", # $100,000 to $149,999 (40 to 49.9 percent)
														              "B25095_063", # $100,000 to $149,999 (50 percent or more)
														              "B25095_069", # $150,000 or more (30 to 34.9 percent)
														              "B25095_070", # $150,000 or more (35 to 39.9 percent)
														              "B25095_071", # $150,000 or more (40 to 49.9 percent)
														              "B25095_072", # $150,000 or more (50 percent or more)
														              "B25095_001",
														              "B25095_001"), # Total
                     areas = area,
                     summary_level = "place") %>%
  rename(City = NAME) %>%
  mutate(CostBurdened = B25095_006+B25095_007+B25095_008+B25095_009+B25095_015+B25095_016+B25095_017+B25095_018+
	       B25095_024+B25095_025+B25095_026+B25095_027+B25095_033+B25095_034+B25095_035+B25095_036+B25095_042+B25095_043+B25095_044+B25095_045+B25095_051+B25095_052+B25095_053+B25095_054+B25095_060+B25095_061+B25095_062+B25095_063+B25095_069+B25095_070+B25095_071+B25095_072,
         CostBurdenedPer = CostBurdened/B25095_001) %>%
	select(City ,CostBurdened,CostBurdenedPer) %>%
  left_join(Chelsea.MA, MA.CostBurdened.ch, by="City")

Chelsea.MA <- cbind(MA.CostBurdened.ch)

```
* The number of households, who spend 30 percent or more on housing costs in `r Chelsea.MA$City` is `r Chelsea.MA$CostBurdened` which is `r (round(Chelsea.MA$CostBurdenedPer,3))*100`% of total number of households, who spend money on housing costs.\



\

### Homelessness
\

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide', comment=""}
#Chelsea.MA$Homelessness <- 266
```


* The number of people homeless in 2016 in county of `r Chelsea.MA$City` is 266 individuals. (https://endhomelessness.org/)


\

### Local/State Policies + Assistance on Rent Deferment
\

* In order to provide financial assistance for housing activities in Manchester, Federal funds from the United States Department of Housing and Urban Development is considered. The Federal funds contain the following items, which are the Community Development Block Grant Program, the HOME Program and to a lesser degree Emergency Shelter Grant monies. These funds will be used to activities, such as affordable housing or shelter to low income people. Beside using these Federal funds, the city also includes Affordable Housing Trust fund which is available for housing initiatives.(https://www.manchesternh.gov/Departments/Planning-and-Comm-Dev/Community-Improvement-Program/Housing-Resources)


```{r}
Manchester <- Chelsea.MA
Manchester
```






